<!DOCTYPE html><html lang=en><meta charset=utf-8><title>Broadcom Smart</title><meta content="width=device-width,initial-scale=1"name=viewport><meta content="ZiLiang Han"name=author><link href=img/icon.png rel="shortcut icon"><link href=css/bootstrap-simplex.css rel=stylesheet id=bs-css><link href=css/smart.css rel=stylesheet><link href=bower_components/chosen/chosen.min.css rel=stylesheet><link href=bower_components/colorbox/example3/colorbox.css rel=stylesheet><link href=bower_components/responsive-tables/responsive-tables.css rel=stylesheet><link href=bower_components/bootstrap-tour/build/css/bootstrap-tour.min.css rel=stylesheet><link href=css/jquery.noty.css rel=stylesheet><link href=css/noty_theme_default.css rel=stylesheet><link href=css/elfinder.min.css rel=stylesheet><link href=css/elfinder.theme.css rel=stylesheet><link href=css/jquery.iphone.toggle.css rel=stylesheet><link href=css/uploadify.css rel=stylesheet><link href=css/animate.min.css rel=stylesheet><script src=bower_components/jquery/jquery.js></script><script src=bower_components/bootstrap/dist/js/bootstrap.js></script><script src=js/jquery.dataTables.min.js></script><script src=bower_components/chosen/chosen.jquery.js></script><script src=js/jquery.iphone.toggle.js></script><script src=js/jquery.autogrow-textarea.js></script><script src=js/jquery.uploadify-3.1.min.js></script><script src=js/jquery.cookie.js></script><script src=js/jquery.history.js></script><script src=js/go-debug.js></script><script src=brcm_js/smart.js></script><script src=brcm_js/utils.js></script><script src=brcm_js/protocol.js></script><script src=brcm_js/websocket.js></script><script src=brcm_js/targets.js></script><style>body{font-family:'Microsoft YaHei',Helvetica,sans-serif}.left-parent{background-color:transparent;color:#000;font-size:20px}.left-child{color:#000;font-size:16px}</style><style>#infoBoxHolder{z-index:300;position:absolute;left:5px}#infoBox{border:1px solid #999;padding:8px;background-color:#f5f5f5;opacity:.9;position:relative;width:120px;font-family:arial,helvetica,sans-serif;font-weight:700;font-size:11px}#infoBox:after{visibility:hidden;display:block;font-size:0;content:" ";clear:both;height:0}div.infoTitle{width:20px;font-weight:400;color:#787878;float:left;margin-left:4px}div.infoValues{width:30px;text-align:right;float:right}label:focus,label:hover{background:#cedff2}</style><script>function init(){var e=go.GraphObject.make;myDiagram=e(go.Diagram,"runnerComponentsLayoutDiv",{initialContentAlignment:go.Spot.Center,allowDrop:!0,LinkDrawn:n,LinkRelinked:n,"animationManager.duration":400,"undoManager.isEnabled":!0,mouseOver:function(e){void 0===e&&(e=myDiagram.lastInput);var t=e.documentPoint,o=null,n=999999999;myDiagram.findObjectsNear(t,40,null,function(e){return e instanceof go.Node}).each(function(e){var a=t.distanceSquaredPoint(e.getDocumentPoint(go.Spot.Center));a<n&&(n=a,o=e)}),a=e,i=o,null!==i?function(e,t){var o=Math.round(e.x),n=Math.round(e.y),a="<div id='infoBox'><div class='infoTitle'>"+t.category+":  </div><div class='infoValues'>"+t.text+"</div><br><div class='infoTitle'>status: </div><div class='infoValues'>On</div><br><div class='infoTitle'>rx: </div><div class='infoValues'>"+o+"</div><br><div class='infoTitle'>tx: </div><div class='infoValues'>"+n+"</div></div>",i=document.getElementById("infoBoxHolder");i.innerHTML=a,i.style.left=o+125+"px",i.style.top=n+10+"px"}(a.viewPoint,i.data):document.getElementById("infoBoxHolder").innerHTML="";var a,i}}),myDiagram.addDiagramListener("Modified",function(e){var t=document.getElementById("SaveButton");t&&(t.disabled=!1);var o=document.title.indexOf("*");myDiagram.isModified?o<0&&(document.title+="*"):o>=0&&(document.title=document.title.substr(0,o))});function t(){return[new go.Binding("location","loc",go.Point.parse).makeTwoWay(go.Point.stringify),{locationSpot:go.Spot.Center,isShadowed:!0,shadowColor:"#888",mouseEnter:function(e,t){showPorts(t.part,!0)},mouseLeave:function(e,t){showPorts(t.part,!1)}}]}function o(t,o,n,a){return e(go.Shape,"Rectangle",{fill:"transparent",stroke:null,desiredSize:new go.Size(6,6),alignment:o,alignmentFocus:o,portId:t,fromSpot:o,toSpot:o,fromLinkable:n,toLinkable:a,cursor:"pointer"})}myDiagram.nodeTemplateMap.add("Policer",e(go.Node,"Spot",t(),e(go.Panel,"Auto",e(go.Shape,"Rectangle",{width:80,height:20,minSize:new go.Size(60,20),fill:"#C97900",stroke:"#C97900"}),e(go.TextBlock,"policer",{font:"bold 11pt Helvetica, Arial, sans-serif",stroke:"#FFFFFF",editable:!0,alignment:go.Spot.Center},new go.Binding("text").makeTwoWay())),o("L",go.Spot.Left,!1,!0),o("R",go.Spot.Right,!0,!1))),myDiagram.nodeTemplateMap.add("Queue",e(go.Node,"Spot",t(),e(go.Panel,"Auto",e(go.Shape,"Rectangle",{width:80,height:20,minSize:new go.Size(60,20),fill:"#79C900",stroke:"#79C900"}),e(go.TextBlock,"queue",{font:"bold 11pt Helvetica, Arial, sans-serif",stroke:"#FFFFFF",editable:!0,alignment:go.Spot.Center},new go.Binding("text").makeTwoWay())),o("L",go.Spot.Left,!1,!0),o("R",go.Spot.Right,!0,!1))),myDiagram.nodeTemplateMap.add("EgressTM",e(go.Node,"Spot",t(),e(go.Panel,"Auto",e(go.Shape,"Rectangle",{width:80,height:40,minSize:new go.Size(40,40),fill:"#000000",stroke:"#000000"}),e(go.TextBlock,"scheduler",{font:"bold 11pt Helvetica, Arial, sans-serif",editable:!0,stroke:"whitesmoke",textAlign:"center"},new go.Binding("text").makeTwoWay())),o("L",go.Spot.Left,!1,!0),o("R",go.Spot.Right,!0,!1))),myDiagram.nodeTemplateMap.add("RateLimiter",e(go.Node,"Spot",t(),e(go.Panel,"Auto",e(go.Shape,"Trapezoid",{width:100,height:80,minSize:new go.Size(40,40),fill:"#DC3C00",stroke:"#DC3C00",angle:90}),e(go.TextBlock,"ratelimiter",{font:"bold 11pt Helvetica, Arial, sans-serif",stroke:"whitesmoke",editable:!0,textAlign:"center",angle:90},new go.Binding("text").makeTwoWay())),o("L",go.Spot.Left,!1,!0),o("R",go.Spot.Right,!0,!1))),myDiagram.linkTemplate=e(go.Link,{routing:go.Link.AvoidsNodes,curve:go.Link.JumpOver,corner:5,toShortLength:4,relinkableFrom:!0,relinkableTo:!0,reshapable:!0,resegmentable:!0,mouseEnter:function(e,t){t.findObject("HIGHLIGHT").stroke="rgba(30,144,255,0.2)"},mouseLeave:function(e,t){t.findObject("HIGHLIGHT").stroke="transparent"}},new go.Binding("points").makeTwoWay(),e(go.Shape,{isPanelMain:!0,strokeWidth:8,stroke:"transparent",name:"HIGHLIGHT"}),e(go.Shape,{isPanelMain:!0,stroke:"gray",strokeWidth:2}),e(go.Shape,{toArrow:"standard",stroke:null,fill:"gray"}),e(go.Panel,"Auto",{visible:!1,name:"LABEL",segmentIndex:2,segmentFraction:.5},new go.Binding("visible","visible").makeTwoWay(),e(go.Shape,"RoundedRectangle",{fill:"#F8F8F8",stroke:null}),e(go.TextBlock,"Yes",{textAlign:"center",font:"10pt helvetica, arial, sans-serif",stroke:"#333333",editable:!0},new go.Binding("text").makeTwoWay())));function n(e){var t=e.subject.findObject("LABEL");null!==t&&(t.visible="Diamond"===e.subject.fromNode.data.figure)}myDiagram.toolManager.linkingTool.temporaryLink.routing=go.Link.Orthogonal,myDiagram.toolManager.relinkingTool.temporaryLink.routing=go.Link.Orthogonal,runner_load(),myPalette=e(go.Palette,"runnerComponentsDiv",{"animationManager.duration":400,nodeTemplateMap:myDiagram.nodeTemplateMap,model:new go.GraphLinksModel([{category:"EgressTM",text:"egress_tm"},{category:"RateLimiter",text:"ratelimiter"},{category:"Queue",text:"queue"},{category:"Policer",text:"policer"}])}),parent.setIframeHeight(480)}function showPorts(e,t){var o=e.diagram;o&&!o.isReadOnly&&o.allowLink&&e.ports.each(function(e){e.stroke=t?"white":null})}function runner_applyCallback(e,t){0==e||parent.showModal(t)}function runner_apply(){var e='{"wan":"'+document.getElementById("runnerWanType").value+'","mode":"'+document.getElementById("runnerSchedulerMode").value+'","defaultQ":"'+document.getElementById("runnerDefaultQueue").value+'"}';Protocol.sendPacket(TARGET_RUNNER,CMD_RUNNER_APPLY,e.length,SPT_PROTOCOL_PLDTYPE_TXT,e,runner_applyCallback)}function runner_saveCallback(e,t){0==e||parent.showModal(t)}function runner_save(){var e=myDiagram.model.toJson();document.getElementById("runnerComponentsLayout").value=e,Protocol.sendPacket(TARGET_RUNNER,CMD_RUNNER_SAVE,e.length,SPT_PROTOCOL_PLDTYPE_TXT,e,runner_saveCallback)}function runner_loadCallback(e,t,o){0==e?(myDiagram.model=go.Model.fromJson(o),document.getElementById("runnerComponentsLayout").value=o):parent.showModal(t)}function runner_load(){var e=new Uint8Array(1);e[0]=3,Protocol.sendPacket(TARGET_RUNNER,CMD_RUNNER_LOAD,1,SPT_PROTOCOL_PLDTYPE_BIN,e,runner_loadCallback)}function resizeIframe(e){e.style.height=e.contentWindow.document.body.scrollHeight+"px"}</script><body onload=init()><div id=runner_components><div style=width:100%;white-space:nowrap><span style=display:inline-block;vertical-align:top;padding:5px;width:120px><div id=runnerComponentsDiv style="border:solid 1px gray;height:500px"></div></span><span style=display:inline-block;padding:5px;width:80%><div id=runnerComponentsLayoutDiv style="border:solid 1px gray;height:500px"></div></span><div id=infoBoxHolder></div></div><div><span style=display:inline-block;vertical-align:top;padding:5px;width:200px><h4>Template</h4><hr><div><span style=display:inline-block;vertical-align:top;width:80px>WAN Type: </span><span style=display:inline-block;vertical-align:top><div><select id=runnerWanType style=width:80px><option value=epon>EPON<option value=gpon>GPON<option value=dsl>DSL</select></div></span></div><div><span style=display:inline-block;vertical-align:top;width:80px>Scheduler:</span> <span style=display:inline-block;vertical-align:top><div><select id=runnerSchedulerMode style=width:80px><option value=sp>SP<option value=wrr>WRR<option value=sp-wrr>SP/WRR</select></div></span></div><div><span style=display:inline-block;vertical-align:top;width:80px>Queue:</span> <span style=display:inline-block;vertical-align:top><div><select id=runnerDefaultQueue style=width:80px><option value=default>Default<option value=none>None</select></div></span></div><button onclick=runner_apply()>Apply</button> </span><span style=display:inline-block;vertical-align:top;padding:5px;width:720px><button onclick=runner_load()>Load</button> <button onclick=runner_save() id=SaveButton>Save</button><br><textarea id=runnerComponentsLayout style=width:100%;height:300px>
    { "class": "go.GraphLinksModel",
      "linkFromPortIdProperty": "fromPort",
      "linkToPortIdProperty": "toPort",
      "nodeDataArray": [ 
        {"category":"RateLimiter", "text":"RL0", "key":-6, "loc":"600 100"},
        {"category":"EgressTM", "text":"scheduler0", "key":-16, "loc":"400 100"},
        {"category":"Queue", "text":"queue_0", "key":-4, "loc":"200 100"},
        {"category":"Queue", "text":"queue_1", "key":-17, "loc":"200 130"},
        {"category":"Queue", "text":"queue_2", "key":-18, "loc":"200 160"},
        {"category":"Queue", "text":"queue_3", "key":-7, "loc":"200 190"},
        {"category":"Queue", "text":"queue_13", "key":-8, "loc":"200 220"},
        {"category":"Queue", "text":"queue_12", "key":-9, "loc":"200 250"},
        {"category":"Queue", "text":"queue_11", "key":-10, "loc":"200 280"},
        {"category":"Queue", "text":"queue_10", "key":-11, "loc":"200 310"},
        {"category":"EgressTM", "text":"scheduler1", "key":-12, "loc":"400 220"}
      ],
      "linkDataArray": [ 
        {"from":-16, "to":-6, "fromPort":"so0", "toPort":"ri0"},
        {"from":-4, "to":-16, "fromPort":"qo0", "toPort":"si0"},
        {"from":-17, "to":-16, "fromPort":"qo0", "toPort":"si1"},
        {"from":-18, "to":-16, "fromPort":"qo0", "toPort":"si2"},
        {"from":-7, "to":-16, "fromPort":"qo0", "toPort":"si3"},
        {"from":-8, "to":-12, "fromPort":"qo0", "toPort":"si3"},
        {"from":-9, "to":-12, "fromPort":"qo0", "toPort":"si2"},
        {"from":-10, "to":-12, "fromPort":"qo0", "toPort":"si1"},
        {"from":-11, "to":-12, "fromPort":"qo0", "toPort":"si0"},
        {"from":-12, "to":-6, "fromPort":"so0", "toPort":"ri1"}
      ]
    }
  </textarea></span></div></div>