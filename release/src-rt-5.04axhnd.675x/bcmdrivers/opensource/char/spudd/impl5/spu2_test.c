/*
<:copyright-BRCM:2020:DUAL/GPL:standard

   Copyright (c) 2020 Broadcom
   All Rights Reserved

Unless you and Broadcom execute a separate written software license
agreement governing use of this software, this software is licensed
to you under the terms of the GNU General Public License version 2
(the "GPL"), available at http://www.broadcom.com/licenses/GPLv2.php,
with the following added to such license:

   As a special exception, the copyright holders of this software give
   you permission to link this software with independent modules, and
   to copy and distribute the resulting executable under terms of your
   choice, provided that you also meet, for each linked independent
   module, the terms and conditions of the license of that module.
   An independent module is a module which is not derived from this
   software.  The special exception does not apply to any modifications
   of the software.

Not withstanding the above, under no circumstances may you combine
this software in any way with any other Broadcom software provided
under a license other than the GPL, without Broadcom's express prior
written consent.

:>
*/

#include <linux/platform_device.h>
#include "util.h"
#include "cipher.h"
#include "spu.h"
#include "spum.h"
#include "spu2.h"
#include <linux/nbuff.h>
#include <linux/dmapool.h>


#if defined(SPU_TEST_RAW_PERF)

static char test0_name[] = "AES128 encrypt test";

static uint8_t test0_enc_key[] = {
	0xe3, 0x2c, 0xfe, 0xad, 0x59, 0xff, 0xf9, 0x48, 0x45, 0x9b, 0xf5, 0xc7, 0x24, 0xbd, 0xb8, 0x63,
	0x8d, 0x39, 0xe3, 0xfd, 0xc7, 0xea, 0x1b, 0x59, 0xe5, 0x61, 0xb1, 0x75, 0x2c, 0x81, 0x4d, 0x43,
};

static uint8_t test0_iv[] = {
	0xa7, 0x4c, 0x5f, 0x22, 0xab, 0xf9, 0x0d, 0xcc, 0x26, 0xbf, 0x00, 0xfe, 0x46, 0xf2, 0xd4, 0xf6,
};

static char test0_src[] = {
	// beginning of payload
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1e,
	0x45, 0x00, 0x05, 0x8c, 0x2a, 0xfb, 0x20, 0x00, 0x3f, 0x11, 0x9e, 0x4d, 0xc0, 0xa8, 0x01, 0x64,
	0xc0, 0xa8, 0x0a, 0x64, 0xba, 0xea, 0x30, 0x39, 0x05, 0x8a, 0x95, 0xba, 0x5c, 0xfe, 0x9b, 0x8d,
	0x00, 0x0b, 0x21, 0xe6, 0x00, 0x00, 0x00, 0x0b, 0xc1, 0x4d, 0x3d, 0x9d, 0xed, 0x76, 0x34, 0xe8,
	0xb7, 0x6e, 0xfe, 0x8d, 0x29, 0x63, 0x61, 0xc0, 0x5e, 0x0b, 0x09, 0x13, 0x7e, 0x78, 0xcb, 0x18,
	0x12, 0xb0, 0x9e, 0x1c, 0x33, 0xb3, 0x75, 0xf5, 0x00, 0xb3, 0x92, 0xed, 0x29, 0xc7, 0xd5, 0xe0,
	0x35, 0xd3, 0x6d, 0x5e, 0x36, 0xcf, 0x1e, 0x95, 0xda, 0x27, 0xa8, 0x58, 0x9f, 0x74, 0x70, 0xb1,
	0x24, 0x0e, 0xcd, 0x57, 0xc1, 0x42, 0x4c, 0xc2, 0xf5, 0xdf, 0xaf, 0x1e, 0xa6, 0x85, 0xfe, 0xdb,
	0x58, 0x6c, 0x39, 0x8f, 0x3b, 0x57, 0x24, 0x15, 0x7e, 0xcc, 0x6d, 0x1d, 0x40, 0xdd, 0xce, 0x64,
	0xeb, 0x9b, 0xbc, 0xac, 0xdd, 0x08, 0x6e, 0xd3, 0xe7, 0x1e, 0xf1, 0x8d, 0xa3, 0xf0, 0x68, 0xfb,
	0x5c, 0xa1, 0x8a, 0x97, 0xf8, 0xae, 0xac, 0x76, 0x7b, 0x19, 0x93, 0xbb, 0xf6, 0x61, 0x20, 0xe1,
	0xfc, 0xdc, 0x8d, 0xda, 0xe4, 0xfc, 0xad, 0xcc, 0x1a, 0x9e, 0x59, 0xbd, 0x8e, 0xc2, 0xb8, 0xea,
	0x63, 0x43, 0x81, 0x5c, 0xf1, 0x2d, 0xd2, 0x6c, 0x46, 0x66, 0x28, 0x3c, 0xc7, 0x48, 0x1d, 0xc4,
	0x24, 0xab, 0x9e, 0x08, 0xa7, 0x4b, 0xd4, 0xc1, 0xe9, 0x2e, 0x7e, 0x78, 0xf0, 0x36, 0x62, 0x53,
	0x79, 0xe4, 0xaf, 0x6b, 0x11, 0x82, 0xd7, 0x58, 0xe8, 0xff, 0x94, 0xaf, 0x47, 0xb2, 0x73, 0x6b,
	0x5d, 0x11, 0x74, 0x04, 0x5c, 0x48, 0xc5, 0x46, 0x76, 0x43, 0xbe, 0x66, 0x79, 0x20, 0xba, 0xf3,
	0x04, 0x69, 0x5e, 0x16, 0xeb, 0x35, 0x6e, 0xd3, 0x35, 0x02, 0x83, 0x7c, 0xb4, 0xf6, 0xe8, 0x11,
	0x08, 0x5c, 0x15, 0x64, 0xa4, 0xda, 0xaa, 0x1b, 0x1d, 0x68, 0x81, 0x97, 0x89, 0x3b, 0x8a, 0x8d,
	0xa5, 0xe8, 0xa3, 0x90, 0x1d, 0x11, 0x64, 0x52, 0x14, 0xe7, 0xcf, 0xc8, 0xdd, 0xb7, 0xda, 0xe5,
	0x13, 0xef, 0x4a, 0xb7, 0xca, 0xf4, 0xd2, 0xe7, 0x5d, 0x54, 0x7e, 0xe6, 0x8f, 0x08, 0x73, 0x34,
	0xf0, 0x17, 0xc5, 0x0e, 0x28, 0x29, 0x60, 0x3c, 0x10, 0x2f, 0x05, 0xed, 0xe6, 0xdf, 0xd3, 0xf9,
	0xce, 0x1d, 0xb1, 0x98, 0x11, 0x83, 0x80, 0x6e, 0xd7, 0xfe, 0x54, 0x67, 0x07, 0xc8, 0x9b, 0xf7,
	0xdf, 0x60, 0x05, 0x07, 0x89, 0x66, 0x44, 0x99, 0x95, 0x49, 0x87, 0x7c, 0x28, 0x5a, 0x75, 0xf6,
	0x77, 0x26, 0x8f, 0x88, 0xaa, 0x0f, 0xf7, 0x81, 0x0d, 0x4b, 0xe8, 0x14, 0x13, 0x84, 0x0c, 0xf2,
	0xe4, 0x11, 0xfa, 0x6e, 0x77, 0x3e, 0x07, 0x0d, 0x87, 0x8e, 0x89, 0xaf, 0xe8, 0xfe, 0xa5, 0x5f,
	0x25, 0x34, 0xe8, 0xcf, 0x43, 0xdf, 0x50, 0x51, 0x2a, 0x39, 0x65, 0x3e, 0xbd, 0x71, 0x30, 0xa1,
	0x83, 0x2a, 0x0f, 0xfa, 0x68, 0x17, 0x07, 0xef, 0xa5, 0x90, 0x9e, 0x8e, 0x8f, 0x44, 0xed, 0xb4,
	0x78, 0xd5, 0x83, 0xbc, 0xb4, 0xd3, 0x0d, 0xdf, 0x0c, 0x72, 0x1d, 0xc9, 0xe4, 0x4d, 0x6b, 0x67,
	0x78, 0x7a, 0x61, 0xe0, 0x91, 0x69, 0xd0, 0x37, 0xf9, 0x6e, 0xc5, 0x88, 0xb2, 0xb2, 0x3c, 0x2b,
	0x88, 0xbf, 0xe7, 0x3c, 0x93, 0xf4, 0x1b, 0x9f, 0x66, 0x38, 0x69, 0x4a, 0x86, 0xd4, 0xb1, 0xfe,
	0x4e, 0x13, 0xde, 0xe0, 0x7c, 0xae, 0x17, 0x75, 0x1d, 0xdc, 0xfe, 0xcf, 0x8e, 0x3a, 0xfa, 0x16,
	0xfa, 0xe1, 0x53, 0x8d, 0xd5, 0x6e, 0x2c, 0x3c, 0xa7, 0x95, 0x86, 0x2d, 0x69, 0x38, 0x2b, 0xb8,
	0x4b, 0x09, 0x98, 0xc7, 0xb8, 0xaf, 0x3c, 0xd5, 0x8b, 0x3a, 0xa4, 0x19, 0x75, 0x9f, 0x30, 0x6f,
	0x80, 0x83, 0xfc, 0x56, 0xf1, 0x28, 0x92, 0x98, 0xbe, 0x18, 0xc5, 0x27, 0x50, 0xf0, 0xdf, 0x9b,
	0xfa, 0x77, 0x62, 0xb2, 0x26, 0x9f, 0x87, 0xb1, 0xd9, 0x2b, 0xcb, 0x4e, 0xca, 0xfb, 0xbd, 0x4b,
	0x7e, 0xb9, 0xa1, 0x6f, 0xe2, 0x33, 0x08, 0xa0, 0x4b, 0xcd, 0xc7, 0x9c, 0xbe, 0xa7, 0x37, 0xb8,
	0x1e, 0x9a, 0x6a, 0x45, 0x39, 0xf1, 0xf6, 0x12, 0x1c, 0xc1, 0x61, 0xe7, 0xbc, 0x1e, 0x32, 0x3a,
	0xd8, 0xd3, 0xaa, 0xba, 0x06, 0xb2, 0x5a, 0x51, 0x7f, 0x21, 0xed, 0x3d, 0xc8, 0x25, 0xf5, 0xe7,
	0xbf, 0x5f, 0x2c, 0xf8, 0x50, 0x22, 0x0a, 0x6d, 0xe4, 0x6b, 0x54, 0xa0, 0x8a, 0x86, 0xdb, 0x62,
	0x59, 0x85, 0x1c, 0x5f, 0x37, 0x76, 0xb0, 0xb6, 0x97, 0x9e, 0xf4, 0x60, 0xc3, 0xe9, 0x47, 0x82,
	0x49, 0x73, 0x7a, 0x99, 0x95, 0x84, 0x06, 0x79, 0xf0, 0x5a, 0x1a, 0x7a, 0xe0, 0xf5, 0xdc, 0x39,
	0x7a, 0xf8, 0x98, 0xb1, 0x6e, 0x49, 0x67, 0x05, 0xe7, 0x5b, 0x65, 0xaa, 0x45, 0xac, 0x2c, 0x8e,
	0x1f, 0xa6, 0x27, 0xb5, 0x2a, 0x2e, 0x2e, 0x1a, 0x88, 0x48, 0x94, 0x69, 0x3d, 0x70, 0xa2, 0xb7,
	0x68, 0x3b, 0x68, 0xd6, 0x84, 0xd0, 0xdc, 0x6b, 0x2b, 0x41, 0x15, 0x70, 0xee, 0x41, 0xfe, 0x0d,
	0xe7, 0x26, 0xc2, 0x11, 0x54, 0xf1, 0x2c, 0xdc, 0x39, 0xc0, 0x45, 0x77, 0x31, 0xe8, 0x2e, 0x99,
	0x23, 0x97, 0x70, 0xa7, 0x67, 0x4c, 0x12, 0x92, 0x8d, 0x27, 0x03, 0x7b, 0x68, 0x01, 0x89, 0x4f,
	0x27, 0x4b, 0x60, 0x7b, 0x3c, 0x8c, 0x58, 0x76, 0x4d, 0x9d, 0xed, 0x7e, 0x85, 0x1b, 0x17, 0xa8,
	0xb2, 0x87, 0x4f, 0x19, 0xd3, 0x61, 0xac, 0x61, 0x88, 0xaf, 0xdc, 0xf0, 0xb0, 0x65, 0x3f, 0xd8,
	0xb1, 0xa0, 0x53, 0xed, 0x2c, 0xab, 0x63, 0x79, 0x49, 0x50, 0xf7, 0xce, 0x6c, 0x0f, 0x77, 0x1e,
	0x96, 0xc6, 0x38, 0x6a, 0x28, 0xe4, 0xcb, 0xb0, 0x93, 0xa7, 0xa1, 0x43, 0x0d, 0xe0, 0x1b, 0xbe,
	0x80, 0x6f, 0xab, 0xad, 0x1a, 0x0f, 0x26, 0x63, 0x5f, 0x1e, 0x32, 0xcb, 0x2d, 0xa9, 0xea, 0xc3,
	0x6f, 0x22, 0x2d, 0x97, 0x06, 0xf8, 0x48, 0x99, 0xa0, 0xe9, 0xdc, 0xad, 0xc9, 0xf8, 0x6b, 0x4a,
	0x67, 0x16, 0xf7, 0x81, 0x25, 0x1d, 0xe5, 0x85, 0x3b, 0x17, 0x50, 0x68, 0xc0, 0x3a, 0x2c, 0x2f,
	0x5c, 0x59, 0xc7, 0x62, 0x52, 0x0f, 0xfb, 0xf2, 0xf8, 0xd8, 0x9f, 0xc1, 0xd0, 0x0a, 0x0b, 0x37,
	0x20, 0x02, 0xb8, 0x46, 0x20, 0x9d, 0xcb, 0x5b, 0xb4, 0x1b, 0xc4, 0x74, 0x56, 0xf0, 0xa4, 0xb2,
	0x49, 0x6b, 0x15, 0x9b, 0x7a, 0x10, 0x8d, 0x72, 0xe8, 0x2c, 0x33, 0xb8, 0x36, 0x3f, 0xef, 0x57,
	0x41, 0xa8, 0x9d, 0x61, 0x45, 0x68, 0xbd, 0xfa, 0x83, 0x81, 0x6e, 0xd9, 0x71, 0x12, 0x8c, 0xba,
	0x7d, 0xa1, 0x56, 0xf7, 0xb1, 0xe3, 0x69, 0x9a, 0x10, 0x9d, 0x52, 0x46, 0xdc, 0x42, 0x9d, 0x1d,
	0xea, 0x3a, 0x7f, 0x2f, 0xa2, 0x3c, 0x29, 0x26, 0xbd, 0x98, 0xff, 0x2e, 0xaa, 0x8b, 0xe8, 0x28,
	0x2c, 0x3e, 0x1f, 0xde, 0x22, 0x89, 0x78, 0x32, 0x26, 0xca, 0x78, 0x02, 0x0c, 0x16, 0x1f, 0xf6,
	0x50, 0x9e, 0x26, 0xf3, 0xda, 0x4f, 0x19, 0x97, 0xe7, 0x18, 0xc5, 0x92, 0xa4, 0xae, 0xba, 0xd0,
	0xec, 0xd9, 0xae, 0x0e, 0x62, 0x26, 0x40, 0x88, 0xf1, 0xb9, 0x8a, 0xfd, 0xcf, 0xaa, 0xf4, 0x1f,
	0x48, 0x1a, 0x12, 0x23, 0x69, 0x2b, 0xba, 0x51, 0x44, 0x80, 0xe3, 0xe8, 0x2e, 0x9d, 0xb8, 0x1a,
	0x76, 0x67, 0x29, 0xd9, 0x8d, 0x69, 0x61, 0x7e, 0x22, 0xec, 0x7c, 0xf1, 0x96, 0x70, 0x11, 0xde,
	0x8a, 0x23, 0x01, 0xf3, 0x4f, 0xbc, 0x44, 0x93, 0x3c, 0x27, 0x7b, 0x6a, 0xc4, 0x33, 0x84, 0x3b,
	0x9a, 0xad, 0x14, 0x28, 0x17, 0x75, 0xa6, 0x39, 0x61, 0x22, 0x2b, 0xf7, 0x92, 0x3c, 0xd6, 0x1c,
	0x5f, 0xd7, 0x10, 0xae, 0x93, 0x54, 0x41, 0xcf, 0x7c, 0xbc, 0x39, 0x40, 0xf0, 0xbe, 0x7b, 0x8a,
	0x6b, 0x8f, 0xb2, 0x82, 0x05, 0x59, 0xbc, 0x66, 0x7b, 0xe7, 0x5e, 0x0e, 0x23, 0x34, 0x2a, 0x82,
	0x0b, 0x3a, 0x31, 0x9f, 0x8f, 0x72, 0x6e, 0x0b, 0x2f, 0xa8, 0x4b, 0x1f, 0x66, 0xc7, 0xa9, 0xd1,
	0x56, 0x5c, 0x54, 0x5b, 0xb5, 0x10, 0xc2, 0x30, 0xf7, 0x20, 0x3e, 0x1a, 0x54, 0x69, 0x9c, 0x5f,
	0xa3, 0xcd, 0xfe, 0x32, 0x40, 0x6d, 0x3d, 0x6f, 0x15, 0x89, 0x8e, 0x7b, 0x50, 0x37, 0x4c, 0xa6,
	0x93, 0xa0, 0x02, 0x48, 0xb0, 0xc4, 0x79, 0xa7, 0xe4, 0xb7, 0xc1, 0x38, 0x20, 0x5e, 0x97, 0xc4,
	0x2b, 0x96, 0xf6, 0x6b, 0x03, 0x34, 0xda, 0x18, 0xbd, 0x68, 0x93, 0x0d, 0xa0, 0xdf, 0xb3, 0x33,
	0x80, 0xb5, 0x7c, 0x30, 0x79, 0xf5, 0xd8, 0x5d, 0xac, 0x99, 0x95, 0xcd, 0xf7, 0x2d, 0x91, 0x23,
	0xc3, 0x87, 0x8e, 0xc6, 0xbb, 0x69, 0xde, 0x78, 0xd1, 0x71, 0x85, 0x71, 0x50, 0x39, 0xa5, 0xd0,
	0xee, 0x21, 0x01, 0x68, 0x16, 0xd9, 0xc5, 0xc2, 0x72, 0x5b, 0x8f, 0x6a, 0x88, 0x20, 0x8d, 0x4b,
	0xa8, 0x1b, 0x11, 0x63, 0x84, 0xef, 0xdc, 0x56, 0x60, 0x61, 0xc7, 0xb0, 0x9a, 0x6c, 0x81, 0x89,
	0x8d, 0x82, 0xf1, 0xa3, 0x5b, 0xb6, 0x66, 0xcd, 0x11, 0xf5, 0x37, 0x99, 0x16, 0xc4, 0xe4, 0xbe,
	0xe0, 0xf5, 0x21, 0x64, 0xe4, 0xfd, 0xba, 0x44, 0x5f, 0x82, 0xf5, 0xf9, 0xee, 0x76, 0x82, 0x7c,
	0xf8, 0x73, 0x1f, 0x53, 0x2a, 0x85, 0x20, 0x3b, 0x7b, 0x58, 0xd5, 0x91, 0x1c, 0xb9, 0x4f, 0xfc,
	0xaf, 0x70, 0x61, 0x93, 0x6e, 0x1b, 0xd8, 0xcd, 0x9d, 0xcd, 0xc6, 0x8c, 0x43, 0x49, 0x08, 0x3b,
	0xbc, 0x27, 0x8e, 0xe6, 0xad, 0xae, 0x22, 0x28, 0x06, 0xf7, 0xb9, 0x23, 0xb0, 0x08, 0x1f, 0x5f,
	0x78, 0x80, 0xf3, 0xe6, 0x9c, 0xcb, 0xb3, 0x39, 0x98, 0x7a, 0xc5, 0xdb, 0xc3, 0xcd, 0x16, 0x7f,
	0xf5, 0xa4, 0x66, 0xa2, 0x52, 0x88, 0xca, 0x59, 0x7f, 0x83, 0x7c, 0x2f, 0x8b, 0x9b, 0x8f, 0x03,
	0x1c, 0x82, 0xea, 0xb8, 0x4d, 0x9d, 0xf1, 0xe5, 0x17, 0xb7, 0xc0, 0xda, 0x84, 0xd6, 0x5a, 0x79,
	0x7a, 0xc0, 0x1b, 0xcc, 0x48, 0xe5, 0x25, 0xc7, 0x68, 0xa1, 0xf6, 0xf3, 0x3d, 0x85, 0xf7, 0x59,
	0x07, 0xe1, 0x11, 0x54, 0x7e, 0x02, 0x39, 0x96, 0xb9, 0xf9, 0x70, 0x3e, 0xcf, 0xca, 0xb7, 0x49,
	0x8a, 0xd3, 0x16, 0xd2, 0xb8, 0x3b, 0x99, 0x21, 0xdd, 0x90, 0x14, 0x1a, 0x15, 0x0b, 0x73, 0x1d,
	0xec, 0x84, 0x71, 0x6b, 0x86, 0xab, 0x01, 0x40, 0xa4, 0x71, 0x7e, 0x74, 0x3c, 0x35, 0xbd, 0xc6,
	0x08, 0xd3, 0x99, 0xc1, 0x0f, 0x32, 0xe2, 0xec, 0xc2, 0xf6, 0x06, 0xd8, 0x01, 0x02, 0x02, 0x04,
};

static uint8_t test0_result [] = {
	0x23, 0x1c, 0x0e, 0x5a, 0x57, 0x10, 0x21, 0xbe, 0x34, 0x86, 0xac, 0xa6, 0xd9, 0x4f, 0x97, 0xe9,
	0xf0, 0x92, 0x4e, 0x47, 0xdc, 0x75, 0xc4, 0xbc, 0x1a, 0x43, 0xb0, 0x70, 0xf2, 0x16, 0x57, 0xd1,
	0x30, 0xc0, 0x05, 0xe8, 0x1c, 0x45, 0xa4, 0x87, 0xb9, 0xcf, 0xf1, 0xf6, 0xf7, 0x54, 0x88, 0xcf,
	0x91, 0x52, 0x37, 0xf8, 0xd0, 0xb4, 0x0f, 0x49, 0xe1, 0x9c, 0x61, 0x9a, 0x20, 0x79, 0x0e, 0xa9,
	0x63, 0x0a, 0x80, 0x74, 0xff, 0xb8, 0x21, 0x9b, 0x50, 0x7c, 0x28, 0xb5, 0x1c, 0xa3, 0x96, 0xbe,
	0x7b, 0x1a, 0x10, 0xdf, 0xa2, 0x5e, 0x98, 0x8a, 0x2c, 0xca, 0x32, 0x64, 0x3c, 0x90, 0x39, 0xea,
	0x44, 0x3c, 0xbb, 0x97, 0x39, 0x88, 0x57, 0xb1, 0x56, 0x60, 0x5a, 0x37, 0x11, 0x46, 0x03, 0x5b,
	0x9a, 0xc5, 0x81, 0x31, 0xb9, 0xd4, 0x70, 0x76, 0xe2, 0x53, 0xc0, 0xc8, 0xef, 0x8b, 0xc6, 0x5c,
	0x65, 0x0c, 0x45, 0x7a, 0xe2, 0x63, 0xbd, 0x8b, 0x81, 0xb9, 0xd8, 0x5c, 0x2d, 0xeb, 0x17, 0x82,
	0x23, 0xff, 0x79, 0x5b, 0xc5, 0xf2, 0x36, 0xa2, 0x7b, 0x8e, 0x06, 0x51, 0x85, 0xcb, 0x8c, 0xda,
	0x80, 0xf7, 0xb4, 0x73, 0x21, 0x67, 0xc6, 0xad, 0xfd, 0xbf, 0x74, 0x54, 0x67, 0x6f, 0xbb, 0x44,
	0x8b, 0xe2, 0xf8, 0xe9, 0x1e, 0xb8, 0xd4, 0xa0, 0xd2, 0xf9, 0xbb, 0x10, 0xc5, 0x56, 0x7e, 0x81,
	0x7e, 0x27, 0xe1, 0xd6, 0x50, 0x14, 0xef, 0xb2, 0x8c, 0xcd, 0x73, 0x02, 0x0d, 0xc6, 0x5d, 0x36,
	0x2b, 0x18, 0xce, 0x91, 0x65, 0x61, 0x1b, 0x87, 0x1c, 0x5b, 0x97, 0x12, 0xc5, 0x3e, 0x4f, 0xdb,
	0x9c, 0xb1, 0x90, 0xa6, 0x66, 0x9c, 0xf6, 0x75, 0x84, 0x94, 0x18, 0x94, 0xf0, 0x29, 0x92, 0xbe,
	0x83, 0x15, 0xe8, 0xd0, 0x45, 0xfb, 0x46, 0xe6, 0x66, 0x83, 0x1f, 0x97, 0x4f, 0x14, 0x8b, 0x61,
	0x2e, 0xd4, 0x79, 0x38, 0x84, 0x05, 0x35, 0xfe, 0xf1, 0xdb, 0xde, 0xb8, 0x02, 0x68, 0x41, 0xb7,
	0xb3, 0x69, 0xf3, 0xd7, 0x0f, 0x59, 0x3d, 0x6a, 0xce, 0xec, 0x4b, 0x0f, 0xc0, 0xa8, 0x45, 0x72,
	0x4b, 0x10, 0xdb, 0xf6, 0x97, 0x9e, 0x39, 0x8b, 0xa6, 0xdd, 0xce, 0x05, 0xa5, 0x2b, 0x37, 0x51,
	0xc3, 0x73, 0xab, 0xf3, 0x8f, 0xff, 0x81, 0x32, 0x20, 0xc0, 0x29, 0xc1, 0x13, 0xe8, 0x9b, 0xe5,
	0x4f, 0x3e, 0x5c, 0x13, 0xa1, 0x3c, 0xd1, 0x21, 0x18, 0xcb, 0xb8, 0xf5, 0xd3, 0x54, 0x91, 0x23,
	0x45, 0x28, 0xff, 0x6d, 0x69, 0x27, 0x2d, 0xd0, 0x21, 0x8a, 0xdb, 0x17, 0xa5, 0x0b, 0x91, 0x72,
	0x12, 0x31, 0xec, 0xd6, 0x3a, 0x6f, 0xe7, 0x6c, 0x1d, 0x34, 0x00, 0x61, 0x23, 0x27, 0x83, 0x98,
	0x4e, 0xf5, 0xdd, 0x65, 0x27, 0x64, 0xc6, 0x46, 0xa0, 0x48, 0xf5, 0xcd, 0x90, 0x1f, 0x4c, 0x7c,
	0x47, 0x8d, 0xc2, 0x8e, 0xd5, 0x7c, 0x8d, 0xd3, 0xaa, 0xcb, 0x7d, 0xa6, 0x63, 0x33, 0xa0, 0x57,
	0x28, 0xc8, 0x04, 0x27, 0x72, 0xcb, 0x66, 0x1e, 0x36, 0x5f, 0xc7, 0x35, 0xaf, 0x77, 0xe1, 0x0c,
	0x1c, 0xaf, 0xf5, 0x19, 0x05, 0xe5, 0x39, 0x33, 0x4a, 0x02, 0x31, 0x2c, 0x11, 0xa6, 0xf8, 0x98,
	0x14, 0x0a, 0xd3, 0x96, 0xe6, 0x2f, 0x5b, 0x02, 0x9b, 0xdc, 0x33, 0x30, 0xb6, 0x7f, 0x14, 0x22,
	0xd5, 0x50, 0x80, 0x54, 0x13, 0x32, 0xd1, 0x60, 0x33, 0x95, 0x38, 0x47, 0x0e, 0x33, 0x2b, 0xfa,
	0xcb, 0xb5, 0x97, 0x6c, 0xcd, 0x73, 0x3c, 0xf9, 0x97, 0x78, 0xee, 0x56, 0xf0, 0xbe, 0x12, 0x93,
	0xb6, 0xcc, 0x4c, 0x2b, 0xf0, 0x5e, 0x65, 0x7f, 0x71, 0x0c, 0x0c, 0xd2, 0x01, 0x83, 0xbf, 0xbc,
	0xf8, 0x71, 0xce, 0xa2, 0xe3, 0x19, 0x10, 0x95, 0x2c, 0xa9, 0x57, 0x28, 0xc0, 0x8c, 0xde, 0x65,
	0x20, 0x8f, 0xd9, 0x4c, 0x7f, 0xb4, 0x3e, 0x0e, 0x9c, 0x03, 0x59, 0xa2, 0x5b, 0xdf, 0xa6, 0x0e,
	0x3f, 0xac, 0xc0, 0xea, 0xcc, 0x9c, 0xb1, 0xda, 0xa7, 0x7c, 0x53, 0xad, 0xc4, 0xb4, 0xec, 0xc5,
	0xc0, 0xd1, 0x47, 0x3c, 0x09, 0xf1, 0x7d, 0xd6, 0x21, 0xa4, 0x26, 0xb9, 0xd3, 0x8c, 0x39, 0x27,
	0xc8, 0xcf, 0xa3, 0xa5, 0x70, 0x43, 0x12, 0xaf, 0x51, 0x46, 0xae, 0x3d, 0x19, 0x0f, 0x1a, 0x8e,
	0x30, 0x1d, 0x74, 0x5c, 0xb5, 0x3f, 0x00, 0x4b, 0xb4, 0xb1, 0x0e, 0x5c, 0x6e, 0x1f, 0x12, 0x22,
	0x9e, 0x99, 0x28, 0x5d, 0x4b, 0x14, 0xf0, 0xe6, 0xa1, 0xcc, 0xfd, 0x58, 0x6c, 0x0b, 0x52, 0x2e,
	0xe4, 0x84, 0xc8, 0xe4, 0x4f, 0xa8, 0x57, 0xe4, 0x31, 0x62, 0x7a, 0xa4, 0x0a, 0x49, 0xf4, 0xc3,
	0x39, 0xa8, 0xd3, 0x8f, 0x13, 0x3b, 0xdd, 0x4a, 0x8b, 0xcf, 0x68, 0x18, 0x0f, 0x57, 0x6b, 0x5e,
	0xa4, 0x86, 0x40, 0xd5, 0xd6, 0x0b, 0x9c, 0x1b, 0xf3, 0x17, 0xd7, 0xf2, 0x16, 0xc5, 0x3f, 0x5c,
	0x25, 0xa0, 0x88, 0x1f, 0xac, 0x76, 0x22, 0x6b, 0xd2, 0x20, 0xf7, 0xf7, 0xb2, 0x37, 0x6f, 0x0a,
	0x5a, 0x2f, 0xe2, 0xf9, 0x4a, 0x7c, 0x41, 0x31, 0xf3, 0xe2, 0x78, 0x7b, 0x9b, 0x32, 0x89, 0x74,
	0x93, 0x61, 0x45, 0x75, 0xc6, 0x24, 0x4d, 0x60, 0x43, 0x47, 0x06, 0xb4, 0x11, 0xbf, 0x96, 0x75,
	0x6a, 0x21, 0x03, 0xed, 0xc7, 0x44, 0xa8, 0xb2, 0xf1, 0xc7, 0x8e, 0x38, 0xe9, 0x36, 0x1d, 0x02,
	0xf2, 0x57, 0xbb, 0xc3, 0xba, 0xfa, 0x37, 0xb3, 0x17, 0x82, 0x43, 0xd2, 0x38, 0xf8, 0xd3, 0x93,
	0x32, 0x32, 0x6c, 0x58, 0x2f, 0x77, 0x91, 0xca, 0x32, 0xf1, 0x88, 0xff, 0x28, 0x55, 0xd8, 0xf2,
	0x32, 0xdd, 0x03, 0xde, 0xb5, 0x63, 0x48, 0x5a, 0x9a, 0x32, 0xb2, 0x41, 0xec, 0x64, 0x13, 0x6d,
	0xab, 0x2c, 0xd5, 0xb7, 0x5f, 0xe9, 0x8d, 0xe9, 0x9a, 0xc6, 0xc7, 0xfe, 0x05, 0x9b, 0x4e, 0x6a,
	0x6f, 0xa5, 0x0e, 0x45, 0x3b, 0x71, 0x97, 0xba, 0x55, 0xc6, 0x1f, 0xee, 0x15, 0x65, 0x7f, 0xfb,
	0x4f, 0x0c, 0x5c, 0x95, 0xa7, 0x1a, 0x31, 0x3e, 0x98, 0x31, 0xf2, 0x90, 0xfb, 0xe0, 0x5d, 0x71,
	0x9d, 0x59, 0xf6, 0x56, 0xf1, 0x3f, 0x6b, 0xcc, 0x55, 0x7f, 0x63, 0xe2, 0x75, 0x3d, 0x2d, 0x52,
	0x03, 0x05, 0xd2, 0x88, 0xcf, 0x9e, 0x81, 0xad, 0x64, 0xb1, 0xa3, 0x3e, 0x57, 0x0b, 0x17, 0x1a,
	0x9c, 0xf8, 0x16, 0xe9, 0xe0, 0xe6, 0x79, 0x88, 0xc3, 0x2e, 0x90, 0x17, 0x26, 0x30, 0x3c, 0x0f,
	0x9d, 0xc6, 0x85, 0x75, 0xa8, 0x0a, 0x30, 0xca, 0x91, 0x7c, 0x86, 0x3d, 0x83, 0x5a, 0x40, 0xaf,
	0x90, 0xf1, 0xf7, 0x5f, 0x96, 0x50, 0xa3, 0xbd, 0xca, 0xe9, 0xca, 0x04, 0xd3, 0x42, 0xed, 0x94,
	0xf5, 0x90, 0x44, 0xa4, 0xf8, 0x6f, 0x86, 0xb5, 0xd5, 0x00, 0xa4, 0x41, 0x28, 0xcd, 0xd5, 0x3f,
	0xe2, 0xf5, 0xb8, 0x2f, 0x39, 0x03, 0x51, 0x7e, 0xdf, 0x64, 0xa9, 0x40, 0x5e, 0x7e, 0x4b, 0x88,
	0x17, 0x02, 0x96, 0xc7, 0x2a, 0xbb, 0xca, 0xa3, 0x1f, 0x53, 0x8a, 0x7a, 0xe9, 0x18, 0xe2, 0xf7,
	0x1e, 0x3d, 0x1c, 0x42, 0xeb, 0x21, 0x17, 0xf8, 0x7d, 0x4d, 0xad, 0xd9, 0x8c, 0x22, 0xb4, 0x6a,
	0x67, 0xa2, 0x36, 0x00, 0x28, 0x4f, 0x77, 0x24, 0xce, 0x5e, 0x52, 0x60, 0x58, 0x62, 0x1c, 0xf8,
	0xb1, 0x88, 0x82, 0x1a, 0xc9, 0x88, 0x72, 0x14, 0xe9, 0xb9, 0x34, 0xb5, 0xf9, 0xfa, 0x39, 0x8c,
	0xb3, 0x89, 0x14, 0x52, 0x1b, 0x83, 0xbc, 0xc6, 0xa6, 0xc8, 0xc6, 0x7a, 0xc1, 0x44, 0xac, 0x77,
	0xf1, 0xb3, 0x31, 0xd5, 0xe1, 0x36, 0x45, 0xaa, 0xd7, 0x76, 0x6a, 0xfa, 0x65, 0xa7, 0x65, 0xf2,
	0xbe, 0x0e, 0x87, 0x1a, 0x91, 0x41, 0xe3, 0xd0, 0x2e, 0x61, 0x1e, 0x70, 0xfa, 0x75, 0xe6, 0x5a,
	0xa5, 0xc3, 0x7e, 0x8c, 0xa8, 0x07, 0x47, 0x1a, 0x67, 0x43, 0xc4, 0x87, 0x14, 0xd3, 0x45, 0x2c,
	0x25, 0x7b, 0xf5, 0xe3, 0xc9, 0x30, 0x84, 0x8f, 0xcf, 0x86, 0xef, 0xb3, 0xfa, 0x8c, 0xbc, 0xc8,
	0xe8, 0x03, 0xac, 0x25, 0x6e, 0x27, 0x2b, 0x03, 0xa7, 0xcf, 0xf0, 0x96, 0x3b, 0x42, 0xfe, 0x7e,
	0xe6, 0x19, 0x68, 0x73, 0x7e, 0x86, 0xea, 0xe0, 0xb6, 0x73, 0x43, 0x7f, 0xd4, 0x99, 0x61, 0x8a,
	0xef, 0xb3, 0x79, 0x4a, 0x3b, 0x1b, 0x7c, 0x7c, 0x4b, 0xd8, 0x59, 0x6b, 0x0c, 0x7e, 0xfe, 0xc6,
	0x7e, 0x46, 0xcf, 0xa1, 0x02, 0x4e, 0x2b, 0xde, 0xe4, 0x55, 0x70, 0x8f, 0x78, 0x5d, 0x1e, 0x85,
	0x20, 0x57, 0xa2, 0x8a, 0xff, 0x5f, 0x64, 0xef, 0xfb, 0xd0, 0x0c, 0xf7, 0x6b, 0x4c, 0xa3, 0x9a,
	0xfd, 0x55, 0x7a, 0xf8, 0x75, 0x9f, 0x51, 0x6a, 0x43, 0x19, 0xc2, 0xe1, 0x09, 0x4e, 0xce, 0x69,
	0xaa, 0x78, 0xcd, 0x54, 0xc9, 0x72, 0x54, 0xf7, 0xc6, 0xf0, 0x3e, 0x1b, 0x13, 0x22, 0x2e, 0x88,
	0x8d, 0x93, 0x7c, 0xbe, 0xe9, 0x09, 0x41, 0xc3, 0x62, 0x1c, 0xf6, 0xec, 0xe1, 0x2b, 0xeb, 0x90,
	0x34, 0x67, 0x5f, 0x58, 0xf1, 0x1c, 0x9c, 0xbc, 0x12, 0xc4, 0x09, 0xa6, 0x1a, 0x49, 0xc8, 0x0d,
	0x47, 0xea, 0x86, 0x7a, 0xb1, 0x02, 0xb9, 0x84, 0xd5, 0x6e, 0x28, 0x7c, 0x29, 0x4d, 0x3f, 0xf5,
	0xe2, 0x7f, 0x87, 0x40, 0x54, 0x66, 0x32, 0x14, 0x32, 0x7a, 0x54, 0x9d, 0x81, 0x46, 0x1d, 0x78,
	0x2e, 0x15, 0x27, 0xaa, 0xbb, 0xb7, 0xf6, 0xa8, 0x20, 0x5f, 0x54, 0x65, 0xc3, 0x91, 0x00, 0xe2,
	0x97, 0x05, 0x13, 0xaf, 0xdb, 0x5f, 0x33, 0x1b, 0x44, 0xfe, 0xde, 0xb6, 0x8a, 0x83, 0x46, 0x0d,
	0x11, 0x85, 0xbc, 0x1c, 0x81, 0x3e, 0x5b, 0xee, 0x68, 0x75, 0xa9, 0xa0, 0x37, 0xe0, 0x7d, 0x0d,
	0x7e, 0x48, 0xdc, 0xa4, 0x4e, 0x83, 0xfb, 0xc1, 0x57, 0x4f, 0x89, 0xcc, 0x95, 0x8b, 0x79, 0x98,
	0x4c, 0x8a, 0xa4, 0x39, 0x4a, 0xa8, 0xa5, 0x57, 0x1d, 0xee, 0x95, 0x5a, 0x49, 0xcb, 0xc2, 0x8d,
	0x84, 0x73, 0x8c, 0x38, 0xb4, 0xbf, 0x73, 0x7a, 0xe8, 0x42, 0x04, 0xa1, 0x40, 0x47, 0xfc, 0xae,
	0xdb, 0x67, 0x6b, 0x73, 0xed, 0x89, 0x6c, 0xfe, 0x04, 0xfc, 0xf4, 0x15, 0x1b, 0x69, 0x24, 0xec,
	0x4e, 0x44, 0x89, 0xd0, 0x74, 0xdc, 0x99, 0x38, 0x8c, 0x94, 0xb5, 0xc1, 0x21, 0x61, 0x8f, 0x81,
	0x60, 0xd8, 0x7e, 0xc8, 0x43, 0x76, 0x00, 0x4c, 0x73, 0xbd, 0x87, 0x12, 0x3d, 0xc9, 0x49, 0xf1,
	0x92, 0x2c, 0x0c, 0x1e, 0x93, 0x93, 0xbe, 0x97, 0xb1, 0xd8, 0xca, 0xf3, 0xeb, 0xe3, 0x93, 0x9c,
	0x65, 0xf4, 0x69, 0x67, 0xde, 0xfb, 0xde, 0xb0, 0x61, 0xf2, 0x36, 0x27, 0xa0, 0xba, 0x80, 0x3c,
	0xbc, 0x5a, 0x3d, 0xa8, 0x07, 0x98, 0x93, 0x2d, 0x4f, 0xa8, 0x92, 0x46, 0xe7, 0xe6, 0x87, 0x48,
};

#define TEST0_ENCKEY_LEN  16
#define TEST0_IV_LEN      16
#define TEST0_HASHKEY_LEN 0
#define TEST0_PAYLOAD_LEN 1440
#define TEST0_DIGEST_SIZE 0

static char test1_name[] = "HMAC-SHA1-AES128 encrypt test";

static uint8_t test1_enc_key[] = {
	0xae, 0xc2, 0x8b, 0x17, 0x61, 0x87, 0x43, 0xe4,
	0x01, 0x7e, 0x3e, 0xc9, 0x00, 0x84, 0xcb, 0xa4,
};

static uint8_t test1_iv[] = {
	0x33, 0x92, 0x1b, 0xcd, 0xec, 0x3c, 0x73, 0x92,
	0xe5, 0x25, 0xa6, 0x81, 0x71, 0xd4, 0xdc, 0x47,
};

static uint8_t test1_hash_key[] = {
	0x1b, 0x4e, 0xe9, 0xa6, 0x7a, 0x21, 0x13, 0x05,
	0x7a, 0x56, 0x8f, 0x6e, 0x6a, 0x83, 0x0e, 0x70,
	0x7e, 0x73, 0x77, 0x3b,
};

static char test1_assoc [] = {
	0xc4, 0x43, 0x87, 0xe9, 0x00, 0x00, 0x00, 0x0d,
};

static char test1_src[] = {
	// hash IV
	0x33, 0x92, 0x1b, 0xcd, 0xec, 0x3c, 0x73, 0x92, 0xe5, 0x25, 0xa6, 0x81, 0x71, 0xd4, 0xdc, 0x47,
	// beginning of payload
	0x45, 0x00, 0x05, 0x9e, 0x7e, 0xc1, 0x40, 0x00, 0x3f, 0x11, 0x2a, 0x75, 0xc0, 0xa8, 0x01, 0x64,
	0xc0, 0xa8, 0x0a, 0x64, 0xae, 0x64, 0x30, 0x39, 0x05, 0x8a, 0x52, 0xdd, 0x5d, 0x00, 0x13, 0xb4,
	0x00, 0x0e, 0x75, 0x1b, 0x00, 0x00, 0x00, 0x01, 0x13, 0xe8, 0x4b, 0x54, 0x1c, 0x45, 0x72, 0x6d,
	0xa8, 0xf9, 0x73, 0x26, 0xbc, 0x82, 0xa2, 0x1a, 0xb7, 0xb8, 0xc0, 0xe2, 0x3e, 0xa3, 0xeb, 0x00,
	0x47, 0xe3, 0xd1, 0xfa, 0xc4, 0xc8, 0xa2, 0xd8, 0xb1, 0xed, 0x2c, 0xcd, 0x33, 0x9e, 0x3a, 0xdb,
	0x98, 0xad, 0x01, 0x54, 0x30, 0xa3, 0x6e, 0xe7, 0x5c, 0x2e, 0xc9, 0x9a, 0xd1, 0xb4, 0x9a, 0x18,
	0x98, 0x6c, 0x13, 0x5c, 0x34, 0xb5, 0x34, 0xe5, 0xa3, 0x61, 0xb2, 0xd6, 0xff, 0xed, 0xb1, 0x97,
	0x9a, 0xb3, 0xec, 0xca, 0x56, 0x5a, 0xb1, 0xb2, 0x89, 0x7b, 0x4d, 0x5a, 0x2f, 0xe7, 0x73, 0xc7,
	0x53, 0x86, 0x24, 0x88, 0x3b, 0x58, 0x6d, 0xde, 0xb9, 0x20, 0xb4, 0xb9, 0x0d, 0x66, 0x50, 0xa7,
	0x19, 0x3c, 0x72, 0x6f, 0x97, 0x23, 0x22, 0x20, 0x9e, 0x6f, 0x7a, 0xce, 0x56, 0xed, 0x95, 0xaa,
	0x73, 0xb9, 0x32, 0xaf, 0x12, 0x9f, 0x8d, 0xcb, 0xbf, 0x42, 0x84, 0xcc, 0xa8, 0xd5, 0x74, 0xc1,
	0x11, 0xe6, 0x30, 0xa8, 0x09, 0x52, 0xc8, 0xa8, 0xc1, 0x43, 0x76, 0x18, 0x30, 0x0b, 0xc2, 0xa4,
	0xc5, 0xf4, 0x53, 0xd7, 0x93, 0xe0, 0xa2, 0x53, 0x22, 0x27, 0x1f, 0xca, 0xfc, 0x93, 0x8b, 0x0d,
	0x79, 0xbc, 0xb6, 0x83, 0x0e, 0x7e, 0x2b, 0xd0, 0xc1, 0xa1, 0xe8, 0xf2, 0xac, 0xaa, 0x96, 0x71,
	0x9e, 0xe9, 0x48, 0x31, 0xc9, 0xeb, 0x84, 0xec, 0x12, 0xa4, 0xb6, 0x0e, 0x37, 0x42, 0x1b, 0xb1,
	0xfe, 0xd1, 0x34, 0x0c, 0x50, 0x5f, 0xdc, 0x11, 0x00, 0xc4, 0x03, 0xac, 0x6e, 0x99, 0x1e, 0x0c,
	0x82, 0x66, 0x3e, 0x4c, 0x51, 0xc2, 0x38, 0x63, 0x66, 0xee, 0x71, 0x9e, 0x30, 0x8d, 0x4f, 0x2e,
	0x5e, 0x83, 0x3b, 0xae, 0xe2, 0x17, 0xc0, 0xe2, 0xdc, 0xc3, 0x8e, 0x4a, 0x5d, 0xac, 0x57, 0xdf,
	0x13, 0x95, 0x2b, 0x64, 0x57, 0x63, 0xc8, 0xbe, 0x52, 0x39, 0x5c, 0x82, 0xc6, 0xab, 0xb1, 0x25,
	0x2e, 0xec, 0xd3, 0x10, 0x03, 0x93, 0xf2, 0xdf, 0x57, 0x80, 0x2a, 0xb4, 0x2d, 0x81, 0x93, 0x40,
	0x16, 0xbf, 0xa4, 0x6d, 0x22, 0x6c, 0x2b, 0x74, 0xa6, 0x87, 0xf7, 0x6c, 0x32, 0xa8, 0x91, 0x60,
	0x94, 0x65, 0x70, 0x97, 0xf8, 0x62, 0x77, 0x4f, 0xe3, 0xa1, 0x03, 0x10, 0x22, 0x97, 0x50, 0x38,
	0x56, 0xf4, 0xa5, 0x78, 0x61, 0xd1, 0xed, 0x07, 0x58, 0xe4, 0x73, 0x8b, 0x8c, 0x05, 0xeb, 0x20,
	0x6a, 0x5c, 0xb7, 0x62, 0xbe, 0x2e, 0xb2, 0xa1, 0xcf, 0xb5, 0xb1, 0xf1, 0x4c, 0x01, 0x29, 0xa2,
	0xf6, 0xcf, 0x1b, 0x57, 0xa0, 0x08, 0x5e, 0xf8, 0xec, 0xd1, 0x83, 0x78, 0xd6, 0x6f, 0x98, 0x40,
	0xcb, 0x4f, 0xa3, 0x89, 0x7e, 0x55, 0x2b, 0x4d, 0x0a, 0xdc, 0x3f, 0x57, 0xde, 0x68, 0xf9, 0xd4,
	0x37, 0x14, 0x2b, 0xd7, 0x1c, 0x89, 0xd0, 0x08, 0x5a, 0x53, 0x80, 0x31, 0xc2, 0x18, 0x71, 0x8d,
	0x68, 0x14, 0x17, 0xe6, 0x69, 0x42, 0x33, 0x74, 0x1e, 0x72, 0xcb, 0xfc, 0xdb, 0xc4, 0xd0, 0x12,
	0xd9, 0xfb, 0xea, 0xf5, 0x84, 0xba, 0xfe, 0xdf, 0x0d, 0x7e, 0x10, 0xd0, 0x97, 0x81, 0x5d, 0xff,
	0x96, 0x74, 0xe5, 0xff, 0xb6, 0x18, 0x73, 0xd5, 0x8b, 0x3e, 0xd1, 0x66, 0x03, 0xa2, 0x78, 0xdc,
	0x9d, 0x62, 0xd1, 0x22, 0x1c, 0xcf, 0x01, 0x2a, 0x4e, 0x11, 0xfa, 0xe5, 0x92, 0x57, 0xe4, 0x28,
	0xcc, 0xc9, 0x28, 0x82, 0xe1, 0x9b, 0x57, 0x6c, 0xda, 0x29, 0xd2, 0xdd, 0xcb, 0x4b, 0xb9, 0x68,
	0xad, 0x8a, 0x8a, 0xca, 0x5a, 0x8b, 0xf4, 0xa8, 0x9c, 0xee, 0x8d, 0x2f, 0x45, 0x71, 0x57, 0x11,
	0x3a, 0x7f, 0x94, 0x1b, 0x1b, 0xeb, 0x88, 0xf5, 0x14, 0x5a, 0xd2, 0xdf, 0xa5, 0x8b, 0x48, 0x53,
	0x15, 0xd2, 0x1d, 0x6f, 0x5e, 0x11, 0x17, 0xfa, 0xff, 0xa4, 0x29, 0x44, 0x15, 0x81, 0x56, 0x4f,
	0x00, 0xea, 0x6b, 0x1b, 0xd5, 0xf3, 0x10, 0xea, 0x4d, 0xe2, 0xc9, 0xf3, 0x6d, 0x11, 0x46, 0x83,
	0xe4, 0x63, 0xf2, 0x42, 0x74, 0x0a, 0x3c, 0x73, 0xae, 0x66, 0xb7, 0xc4, 0xe7, 0x0d, 0x13, 0xe7,
	0xf7, 0x7e, 0x03, 0xcd, 0x71, 0x13, 0xb7, 0xbf, 0xf6, 0x80, 0xb2, 0x63, 0x92, 0xf8, 0xe6, 0x76,
	0x5b, 0xd9, 0xb8, 0xcf, 0xe3, 0xf4, 0x42, 0x91, 0x5a, 0xf9, 0x55, 0x41, 0x07, 0x69, 0x29, 0xfe,
	0xe7, 0x2c, 0xcb, 0x59, 0x3f, 0x82, 0x18, 0x35, 0x03, 0xca, 0x99, 0x95, 0xc2, 0x7f, 0x0b, 0x1d,
	0x58, 0xc3, 0xec, 0x3b, 0xb7, 0x2e, 0xcd, 0x12, 0x27, 0x22, 0x53, 0x2e, 0x8b, 0x7c, 0x2d, 0x73,
	0xa8, 0xf8, 0xcc, 0xe8, 0x7b, 0xe4, 0x1d, 0x7e, 0xae, 0xb6, 0x13, 0x70, 0x36, 0x1e, 0x8d, 0x8e,
	0xe1, 0x79, 0xca, 0x98, 0xa7, 0x97, 0xaa, 0xce, 0xb9, 0xfe, 0xfd, 0x45, 0x7a, 0x2a, 0xb8, 0x23,
	0x22, 0x84, 0x0b, 0x9d, 0x68, 0x28, 0x1b, 0x16, 0xdf, 0x2e, 0x86, 0x15, 0x4c, 0x13, 0xa3, 0x2d,
	0x8c, 0x6d, 0xc6, 0x33, 0x04, 0x70, 0x01, 0xbe, 0x6e, 0xfe, 0x03, 0xe9, 0x28, 0xbb, 0x0c, 0x4b,
	0x3f, 0x17, 0xe8, 0xa7, 0x3f, 0x04, 0xbd, 0x1e, 0x32, 0x43, 0x33, 0x7f, 0x56, 0xd7, 0xac, 0xe2,
	0x44, 0x72, 0x15, 0x49, 0xe3, 0x16, 0x07, 0x51, 0x15, 0x0a, 0x3a, 0x3d, 0xc5, 0x46, 0x88, 0x04,
	0x5d, 0x71, 0xab, 0x9d, 0x75, 0x68, 0xbb, 0xa7, 0xab, 0xef, 0x26, 0x01, 0xc6, 0xd3, 0xe3, 0x0a,
	0x45, 0xf8, 0x53, 0x28, 0x0e, 0x5a, 0x7a, 0x23, 0x64, 0xb4, 0x61, 0x29, 0xfb, 0xe9, 0x2d, 0x58,
	0x5a, 0xd8, 0xf5, 0xcf, 0x40, 0xb1, 0x77, 0xeb, 0xa0, 0x9d, 0xec, 0x66, 0x70, 0xcf, 0x70, 0xb6,
	0xc7, 0xc4, 0xde, 0xd6, 0x1e, 0x58, 0xf9, 0x83, 0x0d, 0x5a, 0xac, 0x08, 0x44, 0xda, 0x60, 0x9e,
	0xb2, 0x56, 0x6e, 0xf3, 0x07, 0xe5, 0xde, 0xa7, 0x82, 0xcb, 0x0d, 0xf3, 0x9a, 0x7d, 0xa9, 0x62,
	0x41, 0x87, 0x38, 0x60, 0xe0, 0x31, 0xe3, 0xed, 0x8c, 0x8f, 0xf5, 0xd0, 0x69, 0x55, 0x6e, 0x1c,
	0xab, 0xdc, 0x0f, 0xb2, 0xc1, 0xed, 0x59, 0x44, 0xb8, 0x66, 0x37, 0x53, 0xe4, 0xe0, 0xb5, 0x25,
	0x67, 0xed, 0x85, 0x47, 0x1e, 0x68, 0x34, 0xaa, 0xf8, 0x29, 0x7a, 0x61, 0x7f, 0xe9, 0x7d, 0x2a,
	0xc5, 0x8c, 0xdd, 0x87, 0x7a, 0x36, 0xcb, 0x32, 0x9d, 0x02, 0x85, 0x81, 0xe2, 0x3a, 0xa6, 0x49,
	0x27, 0x2c, 0x91, 0x46, 0x94, 0xc5, 0xf0, 0x8c, 0xef, 0x6b, 0xee, 0x6e, 0x54, 0x6b, 0x98, 0x19,
	0xf8, 0x75, 0xa0, 0x72, 0xac, 0x6b, 0xa4, 0x49, 0x6d, 0x2a, 0xca, 0x4f, 0x64, 0x70, 0x99, 0x8c,
	0x9c, 0x2a, 0xd2, 0x31, 0xef, 0xc2, 0xbd, 0xde, 0x2d, 0xab, 0x4c, 0x81, 0x17, 0xe5, 0x9b, 0x0f,
	0x5a, 0x3b, 0x81, 0x06, 0xa7, 0x25, 0x4f, 0x14, 0x4f, 0x19, 0x64, 0xb4, 0x8a, 0xfd, 0x40, 0x26,
	0x27, 0x12, 0x57, 0x16, 0xd4, 0x15, 0xf5, 0x02, 0xc0, 0x41, 0x83, 0xd7, 0x26, 0x1e, 0xe6, 0x81,
	0x5a, 0x67, 0x87, 0x01, 0x8d, 0xd7, 0x15, 0xdc, 0xf0, 0x79, 0x90, 0x7a, 0x76, 0xd0, 0xa1, 0x9d,
	0xe2, 0xf8, 0xb4, 0xb7, 0x0d, 0xa9, 0xb9, 0xce, 0xea, 0x3c, 0xa5, 0x11, 0x5b, 0x8c, 0x92, 0xb5,
	0xf3, 0x19, 0xb6, 0x80, 0xf0, 0xcb, 0x5d, 0xe1, 0x45, 0xed, 0x5b, 0xbb, 0xbe, 0xfc, 0x59, 0xa0,
	0xf5, 0x0d, 0x57, 0x02, 0xb6, 0x10, 0xd0, 0xa0, 0x4d, 0x76, 0xb1, 0xa8, 0x02, 0x43, 0x5d, 0xf5,
	0x5d, 0x13, 0x76, 0x4d, 0xde, 0xd3, 0x2e, 0x23, 0xc0, 0x8a, 0xdf, 0x7e, 0x86, 0x38, 0x1f, 0x7b,
	0x45, 0x76, 0x7e, 0xfb, 0x87, 0x4e, 0x9b, 0xd4, 0xc4, 0x4d, 0x7c, 0xc6, 0x90, 0xd9, 0xbc, 0xed,
	0xec, 0x32, 0x3b, 0xca, 0x05, 0x69, 0xee, 0xc5, 0xf3, 0xcd, 0x44, 0x7a, 0x05, 0x63, 0xf5, 0x4a,
	0xd9, 0x73, 0x45, 0x60, 0xc2, 0xe0, 0x34, 0x86, 0x2d, 0xb0, 0x4d, 0xbe, 0x89, 0x09, 0xab, 0x75,
	0x3b, 0xe6, 0x40, 0x40, 0x50, 0x2e, 0x05, 0x43, 0xfb, 0x49, 0xbd, 0x00, 0xac, 0xb3, 0x4a, 0x86,
	0x26, 0x8f, 0xe6, 0xe8, 0x6f, 0x1b, 0x6f, 0x9d, 0xcb, 0xbc, 0x5b, 0x55, 0xc5, 0x06, 0xca, 0x00,
	0xed, 0x0a, 0x40, 0x3d, 0x38, 0x45, 0x80, 0x33, 0x8f, 0x3e, 0x33, 0x3b, 0xf1, 0x7d, 0xc1, 0x17,
	0x0c, 0xa8, 0x00, 0x7c, 0xc3, 0x6f, 0x19, 0x8e, 0x2b, 0x74, 0xe3, 0xf0, 0x7a, 0xae, 0xf0, 0x67,
	0xb8, 0x30, 0xa4, 0xf1, 0x75, 0x25, 0x24, 0x04, 0x63, 0x58, 0x40, 0x54, 0xd5, 0x01, 0x6b, 0xe2,
	0xa9, 0x6b, 0x5e, 0x6c, 0xda, 0x77, 0xfb, 0x05, 0xeb, 0xde, 0xf5, 0x65, 0x8c, 0xe5, 0xcd, 0x45,
	0x15, 0x71, 0x36, 0x8b, 0x96, 0x5a, 0x8f, 0xf9, 0xb2, 0xcf, 0x4d, 0x88, 0xd1, 0xb9, 0x6a, 0x7a,
	0x24, 0xc8, 0xe7, 0xff, 0x3f, 0xe2, 0x04, 0x2a, 0xc0, 0xfa, 0x8f, 0x4d, 0xdf, 0x5c, 0x92, 0xf5,
	0xce, 0xc8, 0x80, 0x64, 0x22, 0x0f, 0x5e, 0xd5, 0xdf, 0xab, 0x5d, 0xb0, 0x64, 0xc7, 0x2a, 0x89,
	0x8f, 0x11, 0x88, 0xce, 0xf3, 0x8c, 0xf8, 0xb4, 0x86, 0x87, 0x01, 0x66, 0xe4, 0x93, 0x5b, 0xb2,
	0x5b, 0xdb, 0x16, 0x7d, 0xea, 0x74, 0x52, 0xc9, 0x20, 0xaf, 0x79, 0x84, 0x76, 0xa4, 0x0d, 0x05,
	0xb5, 0x95, 0xd3, 0xa9, 0x22, 0xcb, 0x5d, 0xa8, 0x53, 0x5e, 0x0e, 0x37, 0xf1, 0x69, 0xe9, 0x4c,
	0x44, 0xff, 0xc9, 0x2f, 0x74, 0x1c, 0xf8, 0x94, 0xcb, 0x72, 0x18, 0x42, 0x16, 0x26, 0x47, 0xcb,
	0xbb, 0x1b, 0x74, 0xdd, 0xe6, 0xd1, 0x86, 0x39, 0x2f, 0x94, 0x70, 0x20, 0xfe, 0x59, 0x6c, 0x42,
	0x59, 0x36, 0x71, 0xcd, 0x52, 0x6a, 0x61, 0x1d, 0xdc, 0x79, 0x5f, 0xf2, 0x9f, 0xa7, 0xbd, 0x5b,
	0xc2, 0x32, 0x38, 0xa8, 0x03, 0xbe, 0xe2, 0x33, 0x53, 0x52, 0x53, 0x51, 0xac, 0xc0, 0x93, 0x05,
	0xf6, 0x05, 0xd2, 0x48, 0x6f, 0x33, 0x65, 0x4b, 0xac, 0xc5, 0x3d, 0x4c, 0x6c, 0xfa, 0xa7, 0x2e,
	0x2c, 0xdf, 0xd6, 0x30, 0x9e, 0xb8, 0x63, 0xf1, 0x0b, 0xb6, 0x42, 0xb7, 0x76, 0xd5, 0xbc, 0x6c,
	0xda, 0x8e, 0xb4, 0x49, 0xc1, 0x1a, 0x94, 0x6d, 0xdf, 0xd1, 0xb9, 0x4b, 0xcc, 0x60, 0x79, 0xf8,
	0x40, 0x4f, 0x28, 0xde, 0x08, 0x8b, 0xcf, 0x13, 0x42, 0x11, 0xca, 0xb8, 0xe6, 0x86, 0x25, 0xc1,
	0x14, 0xd9, 0x0a, 0xd5, 0xf3, 0x9f, 0x42, 0xd2, 0x70, 0xfc, 0x1d, 0x3c, 0x5c, 0x96, 0x00, 0x04,
};

static uint8_t test1_result [] = {
	0xfd, 0x74, 0x2b, 0x0c, 0x65, 0xd4, 0xe3, 0xa0, 0x6f, 0x83, 0xd4, 0xad, 0xe7, 0x37, 0xe1, 0xe9,
	0x8a, 0x02, 0x8e, 0x00, 0x0b, 0x6f, 0x1c, 0xfd, 0x83, 0x7f, 0x5f, 0x4d, 0x18, 0x51, 0x36, 0xb6,
	0x27, 0x3c, 0x0a, 0x14, 0x8d, 0x3f, 0x2d, 0x75, 0x6f, 0xdb, 0xae, 0x49, 0xa2, 0x6a, 0x57, 0xa0,
	0x92, 0xf8, 0xf5, 0x46, 0x92, 0x01, 0xd1, 0x6c, 0x94, 0x66, 0x75, 0x0b, 0x06, 0xa5, 0x27, 0xa0,
	0x7b, 0x5b, 0xd5, 0x7f, 0x5d, 0xf5, 0x62, 0x15, 0x2f, 0x78, 0x15, 0xbb, 0x64, 0xfb, 0xca, 0xdf,
	0x49, 0xe5, 0xe5, 0xb6, 0xc2, 0x09, 0x2c, 0xcd, 0x94, 0x8e, 0xcb, 0xd7, 0x8f, 0x85, 0xcc, 0x71,
	0x92, 0x64, 0xcb, 0x22, 0x83, 0xef, 0x9c, 0x97, 0x29, 0x47, 0x2d, 0x0f, 0x29, 0xee, 0xd4, 0xcd,
	0x36, 0xd4, 0x94, 0x5e, 0x94, 0xf4, 0x17, 0xfa, 0x86, 0x65, 0xdb, 0x23, 0x88, 0xad, 0x60, 0x6d,
	0x5e, 0xe0, 0x80, 0xee, 0x90, 0xce, 0x02, 0x90, 0x17, 0x83, 0xe7, 0x23, 0x06, 0x15, 0x2f, 0x0b,
	0xe1, 0x30, 0xe5, 0xf0, 0x08, 0x80, 0x05, 0x0e, 0xce, 0x2e, 0x45, 0x11, 0x6d, 0xbd, 0xab, 0x68,
	0x8e, 0x9d, 0x47, 0x7e, 0x2b, 0x0c, 0xdb, 0xec, 0x2a, 0x03, 0xc2, 0x73, 0xf7, 0x44, 0x15, 0xe7,
	0x86, 0xce, 0x54, 0xf2, 0xc9, 0xa6, 0x28, 0xe0, 0x45, 0x6a, 0x4f, 0x09, 0x0d, 0x1a, 0xec, 0x8c,
	0x76, 0x91, 0x46, 0xf6, 0x43, 0x36, 0x9b, 0x88, 0xb6, 0xa5, 0x30, 0x0c, 0x4b, 0xc5, 0xf9, 0x28,
	0xf6, 0xa8, 0x42, 0xa6, 0x2b, 0x58, 0x09, 0x3a, 0xff, 0xd6, 0xe8, 0x2d, 0xf8, 0xa6, 0x25, 0x6d,
	0x08, 0x88, 0x95, 0x4b, 0x82, 0xd3, 0x11, 0xee, 0x25, 0x00, 0x77, 0xa4, 0xd1, 0x49, 0x8d, 0xf9,
	0x5e, 0x56, 0x8c, 0xe9, 0xcd, 0x59, 0xc8, 0x35, 0xef, 0x1a, 0x51, 0xd0, 0x6c, 0x95, 0x2d, 0x7c,
	0x6f, 0x47, 0x81, 0xda, 0x8a, 0xbb, 0x99, 0x11, 0xa3, 0xb9, 0x92, 0xdd, 0x65, 0x3d, 0xb2, 0x72,
	0xaf, 0xbb, 0xcd, 0x77, 0x2f, 0xd3, 0x13, 0x25, 0x78, 0xff, 0x4a, 0x67, 0x16, 0xd7, 0x1d, 0xcc,
	0x71, 0xd8, 0xb7, 0x84, 0xdd, 0x51, 0x10, 0x7b, 0x5e, 0x72, 0xff, 0xf2, 0x15, 0x51, 0xdf, 0xdb,
	0x78, 0x1f, 0xe1, 0xbd, 0xca, 0x60, 0xe0, 0xb5, 0x53, 0x75, 0xa0, 0x40, 0x87, 0xa0, 0x40, 0x7b,
	0xfa, 0x48, 0x6d, 0xde, 0xbc, 0xc5, 0x5e, 0x2a, 0xa3, 0xbc, 0x74, 0x69, 0x3c, 0xeb, 0x73, 0x61,
	0xc1, 0x99, 0x8f, 0x14, 0xf4, 0x63, 0x35, 0xfc, 0x96, 0xeb, 0xc0, 0x0c, 0x4d, 0xa9, 0x15, 0xcb,
	0xff, 0xa9, 0x75, 0x02, 0x4b, 0xf8, 0xcf, 0x4a, 0xcd, 0xff, 0xb0, 0x0d, 0x92, 0x99, 0x54, 0x79,
	0x79, 0x7c, 0xe5, 0x27, 0x08, 0x0c, 0xf6, 0x11, 0xcf, 0xbe, 0x66, 0xaa, 0x72, 0x96, 0x64, 0xfa,
	0xd5, 0x78, 0x76, 0xfd, 0x72, 0x1f, 0x98, 0x44, 0x15, 0x52, 0x3a, 0x56, 0x82, 0x45, 0x2c, 0x68,
	0x4f, 0xf3, 0x5d, 0x0b, 0xc0, 0xf3, 0x6d, 0x95, 0x65, 0x17, 0x1c, 0x25, 0x91, 0xaa, 0x06, 0x4a,
	0x90, 0xc0, 0x88, 0x51, 0x2d, 0x72, 0x06, 0x7c, 0xdc, 0x4e, 0x24, 0x4f, 0xc3, 0xf9, 0xb6, 0xde,
	0x0b, 0x4d, 0x36, 0x9e, 0x76, 0x0f, 0x31, 0x69, 0xc2, 0x6c, 0xdb, 0x92, 0x86, 0x41, 0xde, 0x8b,
	0x96, 0xc8, 0xbe, 0x13, 0x58, 0xc3, 0xee, 0x5f, 0xbc, 0x89, 0x17, 0x36, 0xb1, 0x8a, 0x35, 0x4c,
	0xfa, 0x2e, 0xb1, 0x4b, 0x45, 0xcf, 0x0d, 0x89, 0x85, 0x6d, 0x27, 0x28, 0x73, 0x38, 0xfb, 0x52,
	0x6e, 0x05, 0xb6, 0xa6, 0xc8, 0x7f, 0x1a, 0x86, 0xaa, 0xfb, 0x2a, 0x13, 0xac, 0x72, 0xde, 0x2c,
	0xae, 0xcd, 0x5b, 0x07, 0x70, 0x65, 0xcd, 0x7e, 0xfc, 0x61, 0xb1, 0xe9, 0x6b, 0xd3, 0x6b, 0xf7,
	0xc0, 0xb9, 0x26, 0x43, 0x61, 0xce, 0x1d, 0x48, 0x63, 0x51, 0x6e, 0x66, 0x88, 0xb6, 0xfe, 0x22,
	0xb0, 0x33, 0x7f, 0xa0, 0x9f, 0xf7, 0x67, 0x3d, 0x33, 0xd4, 0xc1, 0x6b, 0x85, 0x11, 0x7d, 0x92,
	0x28, 0x3a, 0x77, 0xf6, 0x53, 0x5c, 0x5d, 0x95, 0xe7, 0x4d, 0x52, 0x2f, 0xb7, 0x13, 0x9c, 0x40,
	0x79, 0xef, 0x79, 0x1c, 0x3d, 0xa4, 0x5d, 0x10, 0x67, 0xdb, 0x24, 0x86, 0xcd, 0x2c, 0xee, 0x84,
	0xbb, 0x37, 0xa1, 0xf8, 0xd0, 0xe4, 0x7b, 0x5e, 0xae, 0x21, 0x05, 0x9b, 0x59, 0x0d, 0x2e, 0xc6,
	0x51, 0xe5, 0xdf, 0x82, 0x79, 0x8f, 0x07, 0x2a, 0x1c, 0x94, 0x79, 0xc7, 0x63, 0x6b, 0xf1, 0x96,
	0xb5, 0x7b, 0xd0, 0x12, 0xd7, 0xd8, 0x85, 0x0e, 0x62, 0xaf, 0x0c, 0xee, 0x52, 0x7c, 0x03, 0xfd,
	0x4e, 0x6e, 0x9f, 0x9b, 0xd9, 0x0f, 0x2e, 0x21, 0x43, 0x7d, 0x33, 0x1d, 0x78, 0x91, 0x0e, 0x4b,
	0x80, 0x73, 0x81, 0xdb, 0x5c, 0xf5, 0x67, 0x28, 0xb6, 0x0e, 0xd5, 0x48, 0xa1, 0x01, 0xc2, 0x11,
	0x75, 0x91, 0x94, 0x76, 0x8b, 0x6e, 0x10, 0x22, 0x86, 0x0d, 0x55, 0xa5, 0x56, 0xba, 0x48, 0xfd,
	0x47, 0x5f, 0x59, 0xb1, 0xbd, 0x32, 0x21, 0x93, 0xde, 0xe7, 0x97, 0xb0, 0xd0, 0x64, 0x8b, 0xe5,
	0x30, 0x11, 0xfe, 0x89, 0x9d, 0xb5, 0x7a, 0x2a, 0x89, 0xf1, 0xce, 0xd2, 0xaf, 0x27, 0x26, 0x9b,
	0x8b, 0xe9, 0x78, 0x87, 0xfa, 0x2b, 0x94, 0x51, 0x74, 0x23, 0xec, 0x86, 0x86, 0xe8, 0x3e, 0xfa,
	0xf8, 0x2b, 0x1f, 0xb1, 0x69, 0x0e, 0x62, 0x0e, 0xc2, 0x1f, 0xb9, 0x03, 0x31, 0x39, 0x14, 0x84,
	0x5d, 0x4a, 0x18, 0xcd, 0xc9, 0x28, 0x11, 0xfa, 0xd0, 0xda, 0xbe, 0x1d, 0x66, 0x78, 0x04, 0x87,
	0x39, 0x89, 0xf0, 0x84, 0x14, 0x99, 0x68, 0xe9, 0xb0, 0x70, 0x16, 0xcb, 0x04, 0x3b, 0x0d, 0x23,
	0xc2, 0xea, 0xfc, 0x15, 0x9a, 0xba, 0x2b, 0x87, 0xb9, 0x79, 0xce, 0x16, 0xa6, 0x89, 0x79, 0x35,
	0x3c, 0xfc, 0x3e, 0xf8, 0x0a, 0x79, 0x05, 0x83, 0xa8, 0x72, 0xc2, 0xa7, 0x3f, 0xbf, 0x9a, 0x21,
	0xb5, 0xac, 0x9f, 0xed, 0xaa, 0x79, 0x20, 0x4e, 0xfb, 0xce, 0xf8, 0x1b, 0xf8, 0x95, 0xe5, 0x21,
	0x87, 0x14, 0xe9, 0xb4, 0x23, 0x4e, 0xaf, 0x11, 0x2d, 0x4b, 0x3e, 0xda, 0x2b, 0x49, 0xf3, 0xab,
	0x61, 0x05, 0x2b, 0xd2, 0xd4, 0xb2, 0xd2, 0x7c, 0x12, 0xd4, 0xfb, 0x1d, 0x8a, 0x09, 0x80, 0x4a,
	0x45, 0xf9, 0x59, 0x06, 0x75, 0x68, 0x17, 0xb0, 0xda, 0x8e, 0xec, 0x93, 0x84, 0xea, 0xe2, 0xcf,
	0xb8, 0x2d, 0x76, 0xf1, 0xfc, 0x8f, 0x4c, 0x9c, 0x48, 0xe5, 0xdd, 0x06, 0xdd, 0x5c, 0xf4, 0xed,
	0xec, 0xe1, 0x8f, 0x3b, 0x21, 0x28, 0x0c, 0x1f, 0x18, 0x60, 0xfd, 0xc4, 0xc8, 0x61, 0x4d, 0x4b,
	0x86, 0xf7, 0x7e, 0xcc, 0x91, 0x91, 0x99, 0xf0, 0x97, 0x3e, 0x64, 0xd4, 0xe6, 0x50, 0x4c, 0x80,
	0xc4, 0x7b, 0xc1, 0x4d, 0xd4, 0xfe, 0xb9, 0xad, 0x92, 0x22, 0x1e, 0x61, 0x31, 0xee, 0x11, 0x95,
	0x44, 0xe6, 0xb4, 0xd6, 0x44, 0x43, 0x86, 0x99, 0x9d, 0xcd, 0xc7, 0xcf, 0x76, 0x6a, 0xcb, 0x48,
	0xac, 0x17, 0x25, 0x24, 0x7c, 0xfb, 0x4c, 0xd3, 0x3a, 0xdb, 0x73, 0x74, 0xc4, 0x2f, 0x24, 0x82,
	0x5b, 0xf8, 0x46, 0x62, 0x31, 0xee, 0xb4, 0x18, 0x51, 0xe7, 0x43, 0x89, 0xb2, 0x91, 0x4b, 0x66,
	0x8a, 0x8a, 0xde, 0xfe, 0xc3, 0xe9, 0x39, 0x74, 0xf0, 0x72, 0xb9, 0x86, 0x3f, 0x95, 0x3e, 0x14,
	0x52, 0xc7, 0xd9, 0x14, 0x65, 0xe1, 0xf2, 0x84, 0x65, 0x12, 0x5b, 0x3b, 0x6c, 0x32, 0x91, 0x7c,
	0xac, 0x04, 0x99, 0x60, 0x42, 0x9a, 0x78, 0x73, 0xf9, 0xc5, 0x28, 0x3d, 0xfd, 0x6b, 0xfa, 0xeb,
	0xeb, 0x00, 0x33, 0x8d, 0x67, 0xa5, 0x87, 0x82, 0xec, 0xfb, 0x91, 0xac, 0x80, 0x3b, 0x05, 0x3f,
	0xba, 0x6c, 0x4d, 0xe8, 0x4e, 0xd6, 0x81, 0xf0, 0xe1, 0x58, 0x09, 0x51, 0x48, 0x80, 0xde, 0x5e,
	0xf8, 0xcc, 0x75, 0xff, 0x2d, 0xb9, 0x90, 0xed, 0xdf, 0xff, 0x8d, 0x23, 0x8f, 0x32, 0x85, 0x66,
	0x1d, 0x3f, 0x61, 0x4b, 0xa7, 0xf8, 0x0e, 0x2a, 0xaf, 0x9f, 0xa1, 0xb6, 0xef, 0x82, 0x46, 0xe2,
	0x19, 0x54, 0x65, 0x28, 0x4b, 0x6b, 0xeb, 0x6d, 0xc7, 0xe9, 0x35, 0xad, 0xbb, 0xff, 0x02, 0xf4,
	0x3e, 0xcf, 0x99, 0xe7, 0xcd, 0xf1, 0x10, 0x48, 0x7f, 0x78, 0x42, 0x45, 0x4c, 0x4b, 0x63, 0xd8,
	0xd0, 0x99, 0xe5, 0x45, 0x4d, 0xdc, 0xdb, 0xfa, 0x81, 0x26, 0xfe, 0x45, 0x25, 0xc1, 0x19, 0xbb,
	0xf1, 0x47, 0xe0, 0xb8, 0x5f, 0x7d, 0x75, 0x71, 0x6e, 0x1e, 0x08, 0x57, 0x5a, 0x0f, 0xe8, 0x11,
	0x24, 0x11, 0x2d, 0xb6, 0xbb, 0x98, 0x89, 0x39, 0xd1, 0x3a, 0x13, 0x26, 0xae, 0x49, 0xa2, 0x2b,
	0xbf, 0xd2, 0x74, 0x65, 0x3d, 0x7e, 0xf2, 0x74, 0xee, 0xf2, 0x3f, 0x12, 0x2f, 0xe0, 0xea, 0x07,
	0xca, 0x40, 0x10, 0xbb, 0x44, 0x9c, 0x6c, 0x6f, 0xb0, 0x97, 0xc9, 0x95, 0xc5, 0x6f, 0x42, 0x43,
	0x62, 0x80, 0x27, 0xdf, 0x05, 0xb1, 0xcc, 0xda, 0xd3, 0x92, 0x59, 0x5c, 0x6f, 0x11, 0x56, 0x68,
	0x0c, 0x8c, 0x27, 0x02, 0xa2, 0x78, 0x47, 0x82, 0x73, 0x4b, 0x47, 0x4c, 0x3d, 0xb1, 0xdb, 0x17,
	0x41, 0xd6, 0x7b, 0x5b, 0xfe, 0xf7, 0xc8, 0x86, 0xa9, 0x69, 0xa9, 0x9e, 0x62, 0x7e, 0x78, 0x4f,
	0x46, 0x39, 0x6e, 0x69, 0x58, 0x00, 0xd9, 0x30, 0x67, 0xb0, 0x10, 0x41, 0xbf, 0x5b, 0x9c, 0x33,
	0x02, 0x5b, 0x91, 0x1b, 0x13, 0x94, 0x65, 0x92, 0x6a, 0x70, 0xaf, 0x29, 0x04, 0x1b, 0x5c, 0x37,
	0x74, 0xdf, 0xab, 0x22, 0xd5, 0x4b, 0xf6, 0x18, 0x2f, 0x84, 0xf2, 0x33, 0xaa, 0xd3, 0x1d, 0x1a,
	0x32, 0x89, 0x46, 0x2c, 0xa7, 0x35, 0x9c, 0x01, 0x85, 0x5b, 0x4c, 0xc3, 0x6e, 0x4d, 0xe3, 0xc2,
	0x4b, 0x1c, 0x01, 0x29, 0xc0, 0xfa, 0x36, 0xde, 0x7d, 0x5f, 0xaa, 0x05, 0x72, 0xeb, 0xcb, 0x12,
	0x12, 0x15, 0x86, 0x97, 0x18, 0x74, 0x3f, 0x16, 0xdf, 0xef, 0x44, 0x1a, 0x90, 0x4f, 0xa7, 0xd9,
	0xef, 0x57, 0xea, 0x2c, 0xa2, 0x08, 0x1a, 0x7b, 0x90, 0x40, 0xa3, 0x3a, 0xa2, 0x2d, 0x16, 0xfc,
	0xa1, 0x18, 0x11, 0xc1, 0xfd, 0x11, 0x0b, 0xbe, 0xf5, 0x57, 0xb6, 0x5f, 0x90, 0xd0, 0x53, 0xe5,
	0xa4, 0xac, 0x88, 0xe9, 0x3d, 0x24, 0x71, 0x7b, 0xc4, 0x69, 0x30, 0x56, 0x10, 0x1a, 0x30, 0xdd,
	0x8e, 0x65, 0xdb, 0xb5, 0x42, 0x0c, 0xf0, 0x14, 0x46, 0x52, 0x66, 0xc1, 0xd1, 0x75, 0x01, 0x27,
	0x41, 0x8b, 0x1d, 0xde, 0x71, 0x17, 0x3f, 0xee, 0x2c, 0x00, 0x79, 0xca, 0x87, 0x57, 0xf3, 0x06,
	0x32, 0x22, 0x4b, 0x8e, 0xe3, 0x6e, 0x19, 0xca, 0x81, 0x6c, 0xa0, 0x48, 0x10, 0x83, 0x24, 0xdc,
	0x1c, 0x0e, 0xb5, 0x16, 0x4a, 0x26, 0x42, 0x73, 0x45, 0xd9, 0x8a, 0x7e,
};

#define TEST1_ENCKEY_LEN  16
#define TEST1_IV_LEN      16
#define TEST1_HASHKEY_LEN 20
#define TEST1_PAYLOAD_LEN 1440
#define TEST1_DIGEST_SIZE 12


static char test2_name[] = "HMAC-SHA512-AES128 encrypt test";

static uint8_t test2_enc_key[] = {
	0xe8, 0x6e, 0xb6, 0x9c, 0xff, 0xc4, 0x47, 0xd0,
	0xe4, 0x66, 0x30, 0x38, 0x0e, 0x85, 0xaf, 0xb7,
};

static uint8_t test2_iv[] = {
	0xbb, 0xe3, 0x54, 0x63, 0xf8, 0xcc, 0xd2, 0xf3,
	0xd2, 0x56, 0xad, 0x80, 0x88, 0x6a, 0xa9, 0x37,
};

static uint8_t test2_hash_key[] = {
	0xf1, 0x1c, 0xd4, 0x2a, 0xe7, 0x42, 0x08, 0x77, 0x3e, 0x70, 0x67, 0x8c, 0x94, 0x6d, 0x18, 0x85,
	0x54, 0x95, 0x4f, 0xe5, 0x21, 0xc1, 0xa2, 0xd4, 0xc5, 0x24, 0xb6, 0xe2, 0x4d, 0xc8, 0x93, 0xb1,
	0xc6, 0x88, 0x96, 0xe8, 0x97, 0xf9, 0x76, 0xb1, 0x37, 0x11, 0x5a, 0xc4, 0x2b, 0x08, 0x57, 0x65,
	0xcb, 0x7e, 0xb1, 0x75, 0x51, 0xb7, 0x02, 0x5a, 0x69, 0xbf, 0xfc, 0xa4, 0xfb, 0x5a, 0x97, 0xce,
};

static char test2_assoc [] = {
	0xcf, 0x98, 0x54, 0x39, 0x00, 0x00, 0x00, 0x30,
};

static char test2_src[] = {
	// hash IV
	0xbb, 0xe3, 0x54, 0x63, 0xf8, 0xcc, 0xd2, 0xf3, 0xd2, 0x56, 0xad, 0x80, 0x88, 0x6a, 0xa9, 0x37,

	// beginning of payload
	0x45, 0x00, 0x05, 0x8c, 0x8e, 0xf3, 0x20, 0x00, 0x3f, 0x11, 0x3a, 0x55, 0xc0, 0xa8, 0x01, 0x64,
	0xc0, 0xa8, 0x0a, 0x64, 0xe9, 0x84, 0x30, 0x39, 0x05, 0x8a, 0x61, 0x6a, 0x5d, 0x00, 0x14, 0xbf,
	0x00, 0x09, 0x6c, 0x7b, 0x00, 0x00, 0x00, 0x0b, 0xe3, 0x66, 0xc5, 0x41, 0x19, 0xde, 0xa2, 0x92,
	0x83, 0xa1, 0xb5, 0xe9, 0xa2, 0x48, 0x35, 0xaf, 0x7c, 0x16, 0x60, 0x49, 0x57, 0x99, 0x64, 0xa6,
	0x97, 0x1b, 0x2d, 0x04, 0xbc, 0x00, 0xba, 0xa0, 0x66, 0x7f, 0xe1, 0x7f, 0x5d, 0x83, 0x12, 0xe0,
	0x24, 0xc7, 0xc9, 0xc6, 0x10, 0xff, 0x75, 0x8c, 0x15, 0xd6, 0xd5, 0x6c, 0x6f, 0x39, 0x12, 0x07,
	0x54, 0x3f, 0x0b, 0x11, 0x3f, 0xc5, 0xb1, 0xa5, 0x44, 0x92, 0x25, 0xa1, 0x15, 0x37, 0x82, 0x39,
	0xfe, 0x4b, 0x00, 0x0e, 0x4a, 0x75, 0x9b, 0x5f, 0x4b, 0x70, 0xcc, 0xbb, 0xaa, 0xde, 0xc2, 0xfe,
	0x1e, 0xcd, 0x0f, 0x5d, 0x93, 0xc0, 0x03, 0xd7, 0x52, 0x28, 0x79, 0x67, 0x5f, 0xfb, 0xa1, 0x5d,
	0x46, 0xa1, 0x6c, 0x91, 0x16, 0x07, 0xf0, 0x62, 0x77, 0xbc, 0x1d, 0x21, 0x9b, 0xdf, 0x20, 0xb9,
	0xac, 0x2f, 0x16, 0x3f, 0xf0, 0x19, 0x17, 0x42, 0x41, 0x90, 0xaa, 0xa0, 0x8b, 0x4b, 0xfe, 0xd1,
	0xec, 0x6a, 0x62, 0x02, 0x71, 0x53, 0x64, 0xe8, 0x0f, 0x81, 0x0a, 0xaa, 0x60, 0x2a, 0x63, 0x0d,
	0x59, 0x7a, 0x4c, 0x49, 0x93, 0x63, 0x8c, 0xd5, 0xf3, 0x36, 0x75, 0x7e, 0x81, 0x73, 0x50, 0x6d,
	0xdd, 0xb2, 0x6f, 0x4e, 0x05, 0xd4, 0x37, 0x15, 0x55, 0x41, 0xbf, 0xb6, 0x6b, 0x23, 0xc3, 0xc4,
	0x9d, 0x0f, 0x0e, 0x30, 0x73, 0x9a, 0x05, 0x66, 0xd0, 0x7b, 0xe5, 0x51, 0xee, 0x35, 0xbe, 0xcc,
	0xe7, 0x2d, 0x1a, 0xed, 0x01, 0x51, 0x02, 0x57, 0x92, 0xc1, 0x0d, 0xfd, 0xe4, 0xd0, 0xc2, 0x81,
	0xdf, 0xd0, 0xb2, 0x52, 0x6a, 0xb7, 0xb9, 0x3a, 0x32, 0x9e, 0x8b, 0x21, 0xd3, 0x49, 0xed, 0xba,
	0x76, 0x07, 0xa7, 0x78, 0x59, 0xa9, 0xcf, 0xeb, 0x6b, 0xdc, 0xe9, 0x4f, 0xac, 0xab, 0xd1, 0x8b,
	0x7b, 0x83, 0xde, 0xe5, 0x3a, 0x97, 0x1f, 0x6d, 0x35, 0xaa, 0x8e, 0x08, 0xf3, 0x7b, 0xc2, 0x69,
	0x82, 0x6a, 0xe1, 0xdb, 0x13, 0xb0, 0xc7, 0x7e, 0x8c, 0xb0, 0xce, 0x38, 0x5b, 0x9f, 0xc4, 0xd6,
	0x22, 0xa2, 0xbb, 0x5c, 0x39, 0xda, 0xc9, 0x6e, 0x84, 0x57, 0x76, 0x77, 0xd2, 0x38, 0xe0, 0x55,
	0xa2, 0xc2, 0x30, 0xb6, 0x72, 0xf7, 0x34, 0xff, 0xa7, 0x02, 0x37, 0x02, 0xa1, 0xfb, 0xd8, 0xc3,
	0x9d, 0x93, 0x20, 0xd6, 0x6d, 0xe9, 0x44, 0xf1, 0x41, 0xba, 0x68, 0x13, 0xf3, 0x49, 0x68, 0x95,
	0x0b, 0x99, 0x4b, 0x7d, 0x90, 0x80, 0x7c, 0x38, 0x82, 0xb4, 0x3a, 0x24, 0xaf, 0x13, 0xe7, 0x4d,
	0xa6, 0x07, 0x23, 0x14, 0xf1, 0x68, 0x05, 0x32, 0x22, 0x6e, 0x45, 0x15, 0xb7, 0xae, 0xab, 0xc2,
	0x47, 0xf6, 0x3f, 0xd7, 0x76, 0xbc, 0x0f, 0xf9, 0x70, 0x4a, 0x1d, 0x1f, 0x5d, 0x04, 0x6c, 0x03,
	0x0c, 0x90, 0x17, 0xfd, 0xf8, 0x1d, 0x2f, 0x1a, 0x8b, 0x74, 0x30, 0x42, 0x22, 0xdb, 0x04, 0x69,
	0xd1, 0x43, 0x41, 0x48, 0xff, 0x50, 0x41, 0x6f, 0x9a, 0x5e, 0x8f, 0xf7, 0x62, 0xfb, 0xfb, 0x6e,
	0x8b, 0x12, 0x6b, 0x83, 0x2f, 0x9a, 0x9e, 0xba, 0x0f, 0xce, 0xfc, 0x31, 0xa9, 0x00, 0x9b, 0x7a,
	0x44, 0xdc, 0xc2, 0x43, 0x2c, 0x03, 0xb3, 0xc7, 0x61, 0x42, 0xbe, 0xc4, 0x3d, 0xb9, 0x32, 0xc9,
	0xcc, 0x9e, 0x4c, 0xfb, 0x38, 0xea, 0xb6, 0x47, 0xb8, 0xb2, 0x79, 0x61, 0xb3, 0x14, 0xdc, 0xf7,
	0xf0, 0x9e, 0x3a, 0x1c, 0xa2, 0xed, 0xe3, 0x03, 0x2f, 0xa2, 0xc7, 0x6d, 0x5b, 0xfa, 0x36, 0x27,
	0x98, 0x82, 0x23, 0xd0, 0x6d, 0xd9, 0x18, 0x25, 0x8b, 0x91, 0x87, 0x3e, 0xa5, 0x63, 0x35, 0x95,
	0x01, 0x70, 0xb1, 0xa3, 0x5d, 0x95, 0xa7, 0x8d, 0x37, 0x6e, 0xfa, 0x92, 0x68, 0x30, 0xba, 0x00,
	0xb2, 0xdd, 0xd1, 0x1f, 0xb6, 0xe9, 0x45, 0x41, 0x7a, 0xcc, 0x80, 0x1f, 0x2f, 0xb5, 0xb4, 0x30,
	0x25, 0x65, 0xd4, 0x83, 0xfa, 0x7b, 0x10, 0x31, 0xe9, 0x0a, 0xc4, 0x52, 0x3a, 0x7e, 0x52, 0xec,
	0x5b, 0x23, 0x0c, 0x11, 0x0c, 0x51, 0x52, 0x86, 0x1d, 0xd2, 0xa5, 0x4c, 0x88, 0x59, 0x7c, 0xad,
	0xbf, 0x50, 0x30, 0xb9, 0xcb, 0x40, 0xeb, 0xb5, 0x4a, 0xaf, 0x07, 0x84, 0x2d, 0x59, 0x71, 0x88,
	0x7d, 0x7d, 0x99, 0x89, 0xce, 0xeb, 0x10, 0xeb, 0xbe, 0xb5, 0x37, 0x46, 0x0f, 0xb3, 0xf3, 0xce,
	0x04, 0x24, 0x87, 0xcf, 0x64, 0x72, 0x84, 0xaf, 0x21, 0x8b, 0x33, 0x4e, 0xe5, 0xa4, 0xd6, 0x62,
	0x21, 0x6f, 0xeb, 0xef, 0x5b, 0xfb, 0xda, 0x19, 0xb1, 0x11, 0x5f, 0xc0, 0xc5, 0x52, 0x8e, 0xc9,
	0x76, 0x15, 0x98, 0xdb, 0x88, 0x1d, 0x8a, 0xa9, 0xa8, 0xbd, 0xf8, 0x8d, 0x62, 0xce, 0xef, 0x83,
	0x3e, 0xdb, 0x73, 0x99, 0xd6, 0x4d, 0xb2, 0x87, 0x5f, 0x11, 0x47, 0x24, 0x63, 0xd5, 0xed, 0xda,
	0xeb, 0x85, 0xb5, 0x73, 0xa2, 0x3f, 0x1c, 0x4b, 0xfc, 0x14, 0xd8, 0x5e, 0xe3, 0xc8, 0xe2, 0x21,
	0xa3, 0x55, 0xba, 0x79, 0xa2, 0x6c, 0x01, 0x01, 0x7d, 0x48, 0x25, 0xe0, 0x1e, 0x12, 0xba, 0x09,
	0x98, 0x6f, 0x7c, 0x3a, 0xae, 0x98, 0x85, 0xab, 0xad, 0x5e, 0x09, 0x90, 0x26, 0xeb, 0xb1, 0xc9,
	0x40, 0x6b, 0x42, 0xe3, 0xd7, 0x43, 0xe4, 0x54, 0x8c, 0x0a, 0x34, 0xaa, 0x1c, 0xef, 0xb3, 0xb4,
	0x5e, 0x2f, 0xef, 0x0d, 0xc7, 0x74, 0xb8, 0x74, 0xd2, 0xc1, 0x04, 0xf8, 0xad, 0xb5, 0xc1, 0xed,
	0x20, 0x04, 0xd0, 0xf7, 0x47, 0xb5, 0x4b, 0xd3, 0xbf, 0x80, 0x7d, 0xdb, 0x6f, 0x30, 0x90, 0xcd,
	0x5f, 0x7f, 0xda, 0x27, 0xf3, 0x92, 0x9b, 0xc6, 0x54, 0xa0, 0xbe, 0x01, 0x55, 0x80, 0xee, 0x76,
	0x84, 0xbf, 0x6d, 0xcb, 0x74, 0xb9, 0x9f, 0x33, 0x39, 0x1c, 0x0e, 0xa8, 0x4d, 0x9e, 0x75, 0xac,
	0x1d, 0x50, 0xd3, 0x11, 0xe2, 0x6f, 0xd7, 0x36, 0x0f, 0x95, 0x37, 0x64, 0x15, 0x26, 0xda, 0x99,
	0xe5, 0x48, 0x65, 0x59, 0x01, 0x04, 0x8c, 0x3a, 0x20, 0x9a, 0xe2, 0x6d, 0x39, 0x57, 0x1a, 0x56,
	0xa7, 0xed, 0x67, 0x8a, 0x5c, 0x3e, 0xc0, 0x6b, 0xd4, 0xf8, 0xd0, 0xe9, 0x1e, 0xaa, 0x83, 0x03,
	0xf2, 0xe8, 0x5c, 0xf3, 0xec, 0xe8, 0x2d, 0x0c, 0x82, 0x0f, 0x7a, 0xbb, 0x67, 0x94, 0x12, 0x0e,
	0x81, 0x79, 0x98, 0xde, 0xb8, 0x59, 0x49, 0x8c, 0x51, 0x19, 0x75, 0x6f, 0xc4, 0xf8, 0x72, 0xb6,
	0xe0, 0xce, 0xaa, 0xcc, 0xb6, 0xd7, 0xd9, 0x38, 0xe7, 0x53, 0xf4, 0x4e, 0xe7, 0x06, 0x5c, 0x68,
	0x7f, 0xf5, 0x46, 0x37, 0x4e, 0x90, 0xc3, 0x9f, 0xa9, 0x39, 0x0e, 0x6d, 0x31, 0x80, 0x24, 0x12,
	0x4e, 0xce, 0xde, 0x04, 0xa5, 0xb7, 0x3c, 0x8c, 0x0a, 0x30, 0xda, 0xf1, 0x36, 0x37, 0x5a, 0xb6,
	0x2c, 0xa0, 0xed, 0x7a, 0x30, 0xb1, 0x19, 0xda, 0xea, 0x27, 0x47, 0x1b, 0xa7, 0x6b, 0x2d, 0xf5,
	0x39, 0x0c, 0xf9, 0xdf, 0xc3, 0x35, 0x6b, 0xce, 0x66, 0x46, 0xbf, 0x9c, 0x7d, 0x19, 0x52, 0xa9,
	0xba, 0x40, 0x23, 0xea, 0xf1, 0x3c, 0xc4, 0xdb, 0x63, 0x0c, 0xf6, 0x0a, 0x77, 0x24, 0xff, 0xb1,
	0x30, 0xf8, 0x90, 0xf3, 0x2d, 0xfb, 0xc1, 0x93, 0x41, 0x81, 0x30, 0xbe, 0x9a, 0x82, 0x67, 0x54,
	0xc2, 0x8a, 0x3f, 0xb3, 0xc6, 0x03, 0x8e, 0x29, 0x0f, 0x85, 0x33, 0x87, 0xa9, 0x32, 0x38, 0xd9,
	0x2a, 0xc8, 0xcc, 0x58, 0xc3, 0x8e, 0xeb, 0x05, 0x0f, 0x1b, 0xc3, 0xa9, 0x9e, 0x2b, 0xfe, 0x60,
	0xb5, 0x3d, 0x14, 0x7c, 0x40, 0xa2, 0xa5, 0x50, 0x27, 0xd9, 0xd7, 0xd0, 0x0b, 0x0f, 0xa9, 0x36,
	0xd7, 0x76, 0x8e, 0x9a, 0x04, 0x79, 0x9f, 0x13, 0x95, 0x63, 0xbc, 0x33, 0x8e, 0xba, 0x93, 0x43,
	0xf7, 0xa7, 0xbf, 0x38, 0x4a, 0x65, 0x88, 0x71, 0x3e, 0x5f, 0x42, 0x49, 0x6e, 0xeb, 0x7f, 0x45,
	0x61, 0x0d, 0xdf, 0x65, 0x87, 0x7f, 0x78, 0x1c, 0xe2, 0x35, 0x4f, 0x70, 0xef, 0xe2, 0xb3, 0xe7,
	0x8a, 0x73, 0x1f, 0xd4, 0xd8, 0xa7, 0x45, 0x16, 0x06, 0x87, 0x5f, 0x74, 0x73, 0xdf, 0xb9, 0xd4,
	0xec, 0x98, 0x3a, 0x73, 0x17, 0xb2, 0x8f, 0xf9, 0xe7, 0xde, 0x69, 0xd7, 0xc1, 0x1d, 0xbe, 0x4b,
	0x90, 0xdd, 0x1f, 0x68, 0x84, 0x64, 0x7e, 0x8a, 0xec, 0xdd, 0xfe, 0x5f, 0xbc, 0xb7, 0x33, 0xa9,
	0x4f, 0x6d, 0x1c, 0x67, 0x20, 0xac, 0x60, 0x07, 0x8a, 0xca, 0xde, 0x4b, 0xe7, 0x9c, 0x96, 0x77,
	0x79, 0xb5, 0xdf, 0xfd, 0x1a, 0x5d, 0x87, 0x06, 0x3a, 0x85, 0x65, 0xf7, 0x3c, 0x98, 0xa0, 0x8c,
	0x06, 0xbc, 0xf3, 0x26, 0x68, 0x53, 0x2d, 0xf3, 0x1d, 0x0c, 0x3e, 0x04, 0xa8, 0xd5, 0x7b, 0x22,
	0x8a, 0x5a, 0x1f, 0xa4, 0xb7, 0xa7, 0xaa, 0xf2, 0x2c, 0x0f, 0xe9, 0x69, 0xa8, 0x89, 0xf5, 0xae,
	0x45, 0xe8, 0xd4, 0xae, 0x3b, 0x01, 0xa1, 0x59, 0x0d, 0xdf, 0x5d, 0xb6, 0xb4, 0xd9, 0xd8, 0x3f,
	0x33, 0xf7, 0xe3, 0xeb, 0x9e, 0x8e, 0xdd, 0xcb, 0x9d, 0xc6, 0x34, 0x45, 0x4f, 0x29, 0xf3, 0x94,
	0x11, 0xc7, 0x42, 0x4c, 0xc9, 0xe3, 0xa5, 0xd6, 0xc3, 0x03, 0x8c, 0x77, 0xdc, 0x64, 0xb6, 0x0f,
	0x5c, 0x9a, 0xfa, 0xfa, 0x28, 0xd7, 0xc5, 0xc5, 0x9d, 0xf9, 0x0b, 0xec, 0x22, 0xfe, 0x81, 0x33,
	0xc6, 0xc3, 0x80, 0x8f, 0xa7, 0x25, 0x65, 0x6a, 0x28, 0xf2, 0xe1, 0x04, 0x56, 0x98, 0x14, 0xb2,
	0x32, 0x0e, 0xad, 0x5a, 0xe6, 0x72, 0x1f, 0x83, 0x6c, 0x2a, 0x70, 0x8e, 0x29, 0xf1, 0xc2, 0xef,
	0xb4, 0x42, 0x7e, 0x5b, 0x67, 0xe3, 0xc5, 0x90, 0xd5, 0xa7, 0x94, 0x2c, 0x3f, 0xa8, 0xde, 0x71,
	0xb7, 0x8b, 0xcb, 0x9d, 0xfe, 0xea, 0x20, 0x6a, 0x15, 0x90, 0xf8, 0x3e, 0x81, 0xba, 0x2d, 0x36,
	0xfc, 0xab, 0x91, 0x64, 0x8e, 0x57, 0xf4, 0x64, 0xfe, 0x88, 0x90, 0x3d, 0x31, 0x6e, 0xae, 0xe8,
	0xfa, 0x79, 0x85, 0xf8, 0x63, 0xa5, 0x62, 0x78, 0x36, 0x5a, 0xb6, 0xb7, 0x15, 0xe3, 0xed, 0x11,
	0x8e, 0x7f, 0x75, 0x1d, 0xd6, 0x69, 0x81, 0xd4, 0xf2, 0x11, 0x11, 0x23, 0x7f, 0xbf, 0x0b, 0x79,
	0x38, 0x90, 0x71, 0x9b, 0x35, 0xd3, 0x14, 0x6b, 0x2e, 0xca, 0x23, 0x43, 0xae, 0x10, 0x54, 0x3c,
	0x8f, 0xca, 0x59, 0x65, 0x33, 0xda, 0x39, 0x25, 0xeb, 0x4a, 0x48, 0x6b, 0x01, 0x02, 0x02, 0x04,
};

static uint8_t test2_result [] = {
	0xa1, 0x86, 0x33, 0x48, 0x1a, 0xd6, 0x9a, 0x35, 0x54, 0x34, 0x6c, 0x0b, 0x50, 0x78, 0x71, 0xa9,
	0xd6, 0x78, 0xfe, 0x3d, 0x40, 0xe1, 0x77, 0x78, 0x50, 0x77, 0x62, 0xb1, 0xac, 0x32, 0xad, 0x62,
	0xe9, 0x8b, 0x27, 0x38, 0x37, 0x94, 0x79, 0xe9, 0xa8, 0xd7, 0x72, 0xe6, 0x2c, 0xb3, 0xfa, 0x3f,
	0x15, 0x15, 0x65, 0x15, 0xf8, 0xf1, 0x1c, 0x53, 0xca, 0x51, 0x54, 0xfc, 0x69, 0x27, 0xf7, 0xe2,
	0x07, 0x22, 0x08, 0x57, 0x1b, 0x8a, 0x1e, 0xbc, 0x8e, 0xdc, 0x8a, 0x90, 0x4e, 0x2d, 0xc1, 0x71,
	0xc9, 0x5f, 0x7f, 0x1e, 0x06, 0x4d, 0x84, 0xfc, 0x08, 0x92, 0x71, 0xbf, 0x46, 0x24, 0xe0, 0xb9,
	0x97, 0x02, 0x56, 0x68, 0x5a, 0x6f, 0x14, 0x60, 0x50, 0x86, 0xaf, 0xea, 0x65, 0x89, 0x44, 0x74,
	0x18, 0x57, 0x09, 0xe2, 0xf9, 0x20, 0x73, 0xfd, 0x78, 0x33, 0xea, 0x3d, 0xa3, 0xe4, 0xb4, 0x6a,
	0x2a, 0xae, 0x92, 0xab, 0x9a, 0xb0, 0xf5, 0x38, 0x2f, 0xc1, 0x12, 0x2b, 0x94, 0xbe, 0x02, 0xac,
	0x41, 0x24, 0xdb, 0x35, 0xa9, 0x9d, 0x1f, 0xa2, 0x3d, 0x28, 0xaf, 0x8a, 0xff, 0xa9, 0x32, 0x20,
	0x01, 0xa2, 0x5f, 0x41, 0x15, 0x7f, 0x9c, 0x53, 0x40, 0xf9, 0xd7, 0x59, 0xbe, 0x4e, 0x7d, 0x27,
	0xca, 0x09, 0xa3, 0x97, 0xe0, 0x6b, 0xe8, 0x0e, 0x7b, 0x12, 0x74, 0xf0, 0x09, 0x35, 0x84, 0xd9,
	0x34, 0xa5, 0x7a, 0x84, 0x35, 0x17, 0xbf, 0xae, 0x80, 0xcc, 0x64, 0xa2, 0xe3, 0x52, 0x9b, 0x54,
	0x18, 0xda, 0x96, 0x3a, 0x89, 0x04, 0x3c, 0xaf, 0x2a, 0x6b, 0x8d, 0xd7, 0x3a, 0x1f, 0xd1, 0x5e,
	0xca, 0x4d, 0xe7, 0x5c, 0x5d, 0x13, 0xfc, 0x16, 0x30, 0xb5, 0xd0, 0x93, 0x96, 0xc2, 0xa5, 0x9a,
	0x5b, 0x95, 0x16, 0x76, 0x25, 0x1f, 0x7f, 0xd0, 0x0f, 0x90, 0xec, 0xd7, 0x10, 0x18, 0x9f, 0x10,
	0x08, 0xbb, 0xab, 0x4e, 0xb8, 0x4b, 0xee, 0x63, 0x7e, 0x60, 0xcb, 0xbe, 0x02, 0x7a, 0x30, 0x4c,
	0xa4, 0xbe, 0x84, 0x11, 0xfa, 0x0c, 0x47, 0x84, 0x75, 0x24, 0x6b, 0xf4, 0xa3, 0xf1, 0x81, 0xf9,
	0x21, 0x4a, 0x83, 0x47, 0xc8, 0xea, 0x6d, 0x76, 0xa4, 0x78, 0xe3, 0x62, 0x0e, 0xdb, 0xc5, 0xe4,
	0xed, 0x11, 0x18, 0x3c, 0x5c, 0x56, 0x44, 0x88, 0x1d, 0xe8, 0x4e, 0x1d, 0x2e, 0x3a, 0xdb, 0x7b,
	0xe2, 0x54, 0x11, 0x0d, 0xee, 0x5b, 0x67, 0x07, 0x81, 0x67, 0x43, 0xf8, 0x01, 0x6c, 0x2b, 0x84,
	0x35, 0xbe, 0x7c, 0x1f, 0x34, 0x77, 0x1c, 0x59, 0x81, 0x4d, 0x9b, 0xd0, 0x6b, 0x36, 0x53, 0xc2,
	0x28, 0xb3, 0x50, 0xbf, 0x9d, 0xeb, 0xa5, 0x35, 0x25, 0xa6, 0xd8, 0xa3, 0xd0, 0x61, 0x64, 0x6a,
	0x25, 0xe3, 0xbf, 0x49, 0x7e, 0xf1, 0xab, 0x57, 0x73, 0x1d, 0xc4, 0x61, 0xfe, 0xbc, 0x43, 0xe2,
	0x91, 0x54, 0xb9, 0xd9, 0xc5, 0xe5, 0x2d, 0xc5, 0xd7, 0xd3, 0xa8, 0x57, 0xe0, 0x62, 0x5e, 0x97,
	0x91, 0x29, 0x5f, 0x7a, 0xf9, 0x25, 0x55, 0x41, 0x9f, 0x40, 0x6f, 0x8d, 0xc5, 0x47, 0xff, 0x4f,
	0x43, 0x23, 0x05, 0xa2, 0x5c, 0x29, 0x64, 0x35, 0x7e, 0xce, 0x49, 0x9d, 0x45, 0xfc, 0x7a, 0x35,
	0xe0, 0xe8, 0x49, 0x13, 0x86, 0xe0, 0x27, 0x65, 0xc0, 0xf3, 0xe5, 0xa2, 0x86, 0x0b, 0xb5, 0x44,
	0xf5, 0x57, 0x2a, 0x4a, 0x04, 0xd8, 0x2e, 0xcc, 0xcd, 0x37, 0x52, 0xca, 0x77, 0x8e, 0xca, 0xa2,
	0x90, 0xde, 0x89, 0xe6, 0xa9, 0xce, 0x51, 0x30, 0xc9, 0x87, 0xe3, 0x04, 0x98, 0x76, 0x87, 0x69,
	0x09, 0x34, 0x00, 0xdb, 0x30, 0x59, 0x51, 0xfd, 0x32, 0xbf, 0x4c, 0x7a, 0xb1, 0x4e, 0x02, 0xd3,
	0x89, 0x90, 0xbc, 0xf4, 0xad, 0xd7, 0x0c, 0x14, 0xec, 0xcd, 0x99, 0x52, 0x4c, 0xa1, 0xa1, 0x27,
	0x0d, 0xeb, 0x93, 0xd7, 0x9f, 0x58, 0x13, 0x5c, 0x55, 0x85, 0xfb, 0xff, 0x04, 0x62, 0x3f, 0x27,
	0x74, 0x20, 0x09, 0xe4, 0xdb, 0xe6, 0x6a, 0xe0, 0x4d, 0x17, 0xd3, 0x47, 0x6f, 0x88, 0x3e, 0xe9,
	0x6f, 0x26, 0xe3, 0x29, 0x12, 0x9a, 0x4b, 0x49, 0x59, 0xb6, 0x6e, 0x40, 0xa8, 0xc3, 0x84, 0x27,
	0xf1, 0x82, 0xf4, 0xbf, 0x8e, 0xbe, 0x6a, 0x1b, 0x8c, 0x30, 0xb1, 0x24, 0x85, 0xdd, 0x25, 0x06,
	0x0e, 0x69, 0x3e, 0x72, 0xbd, 0x3f, 0x69, 0x69, 0xba, 0xaf, 0xd3, 0x45, 0x15, 0x65, 0x8d, 0xa8,
	0x0d, 0x4f, 0x08, 0xaf, 0x33, 0x95, 0xf9, 0x50, 0x91, 0x95, 0xb0, 0xe1, 0x45, 0x9b, 0x2c, 0x9e,
	0x1d, 0xf0, 0xa3, 0x6e, 0xc7, 0x2a, 0x21, 0x03, 0x0b, 0xb5, 0x24, 0x89, 0xef, 0x1b, 0x14, 0xfa,
	0xf6, 0x8a, 0x15, 0xef, 0x92, 0xa7, 0x36, 0xe9, 0xc8, 0x99, 0xae, 0x90, 0xfc, 0xd8, 0xda, 0xbf,
	0xaa, 0x6c, 0x2d, 0xeb, 0xf5, 0x4b, 0xe7, 0x0f, 0xa4, 0x98, 0xad, 0x54, 0x45, 0xc8, 0xc9, 0x8d,
	0x6a, 0xa3, 0x42, 0xf5, 0x74, 0x65, 0xf0, 0x55, 0x5f, 0xea, 0x19, 0x8b, 0x03, 0x74, 0x99, 0x8b,
	0x18, 0xd3, 0xe3, 0xbf, 0x34, 0xbb, 0xbb, 0xad, 0xa2, 0xe9, 0x33, 0xa8, 0x8e, 0x07, 0x1a, 0xd1,
	0x7e, 0x23, 0x85, 0x4a, 0x1f, 0x8a, 0x91, 0xb8, 0xbf, 0xca, 0xbc, 0x1d, 0x21, 0x5c, 0x43, 0x42,
	0xda, 0x2b, 0xbf, 0x1e, 0x37, 0x76, 0x39, 0x5c, 0xbe, 0xb1, 0x15, 0x40, 0x68, 0x73, 0xfb, 0xd3,
	0xd5, 0x95, 0xa7, 0x52, 0x90, 0xc1, 0x26, 0xe9, 0x82, 0xcf, 0x2b, 0x62, 0xcc, 0x26, 0xf8, 0x1d,
	0x1e, 0xeb, 0x79, 0xcf, 0x17, 0x61, 0xfd, 0x2e, 0x0d, 0x41, 0xcd, 0xc8, 0x3b, 0x7b, 0xdb, 0x5a,
	0x39, 0xd1, 0x32, 0x2a, 0xd6, 0xe8, 0x85, 0x35, 0xc3, 0x95, 0xcc, 0xf3, 0x0d, 0xd1, 0x99, 0x80,
	0xe0, 0xc6, 0x91, 0x8c, 0x0e, 0xf5, 0x8c, 0x08, 0x3a, 0xcc, 0xf6, 0xd5, 0x47, 0x3d, 0xe1, 0x1a,
	0xe1, 0x39, 0x33, 0x11, 0xee, 0xa8, 0xed, 0x2b, 0x12, 0x76, 0xb6, 0xbb, 0xfc, 0x18, 0xcc, 0xe5,
	0x82, 0x36, 0x99, 0x0c, 0x9c, 0x4c, 0x59, 0x2f, 0x22, 0xab, 0x10, 0x5c, 0x3b, 0xc1, 0x01, 0x03,
	0x75, 0xec, 0x6c, 0x49, 0x3b, 0x91, 0xda, 0x9c, 0x68, 0xe2, 0x83, 0xd7, 0xdf, 0x62, 0xaa, 0x90,
	0xe4, 0x2b, 0x6f, 0xba, 0x73, 0xf2, 0x67, 0xd5, 0x53, 0xe1, 0x77, 0x55, 0xb5, 0xc5, 0x1f, 0x09,
	0xbd, 0x19, 0x3f, 0xe2, 0x8e, 0x49, 0xe7, 0x86, 0x03, 0x4e, 0x87, 0x2f, 0x6d, 0x41, 0xd6, 0x48,
	0x23, 0x80, 0xca, 0x01, 0x6d, 0xb4, 0xb4, 0x3e, 0xba, 0x2b, 0x94, 0xc1, 0x98, 0xd2, 0x0f, 0x9f,
	0xca, 0x72, 0x73, 0x9f, 0x4b, 0x87, 0x15, 0x2c, 0xd0, 0x45, 0x24, 0xfd, 0xa9, 0xcc, 0x1c, 0xbb,
	0xf1, 0x3a, 0x26, 0x7c, 0xf4, 0x63, 0xb8, 0x21, 0x9a, 0xf4, 0x25, 0xba, 0x0d, 0x43, 0x68, 0x33,
	0x91, 0x07, 0x94, 0xe0, 0xb2, 0x14, 0xd5, 0x22, 0x3c, 0xc7, 0x49, 0x96, 0x7a, 0xe5, 0xa8, 0x5f,
	0x41, 0xf8, 0x9e, 0xc6, 0x7b, 0xa2, 0x5b, 0x7d, 0x8e, 0x62, 0x4e, 0x24, 0xe5, 0x5c, 0xe7, 0x07,
	0x15, 0xbb, 0xf5, 0xb8, 0x29, 0x6b, 0xe7, 0x80, 0x6a, 0x25, 0x7a, 0x04, 0xf1, 0xf0, 0x36, 0xc7,
	0x06, 0x2e, 0x1b, 0x14, 0x82, 0xf7, 0xd9, 0x8c, 0x9d, 0x5d, 0xa5, 0x9b, 0xf1, 0xcd, 0xff, 0x2b,
	0x67, 0xea, 0x23, 0xc3, 0x58, 0x10, 0x99, 0xe6, 0x79, 0xfa, 0x19, 0x3c, 0xd2, 0x43, 0x0b, 0x1f,
	0x4c, 0x5b, 0xf5, 0x9b, 0x5e, 0x25, 0x6d, 0x93, 0xe8, 0x7b, 0x71, 0x94, 0xac, 0xc7, 0x23, 0x50,
	0x21, 0xa9, 0x26, 0x9c, 0xa5, 0xd0, 0x2f, 0xd6, 0xfc, 0xe0, 0x50, 0xbe, 0x80, 0x68, 0xbd, 0x78,
	0x07, 0x1c, 0xbe, 0xb5, 0x98, 0xbf, 0x7e, 0x3e, 0x1d, 0x6a, 0x3d, 0xd4, 0xef, 0x80, 0x69, 0x48,
	0xae, 0x80, 0xab, 0x63, 0xba, 0x8e, 0x95, 0x02, 0xda, 0x19, 0x68, 0x6a, 0xda, 0x6d, 0x20, 0x05,
	0x6a, 0x9a, 0x78, 0x32, 0x03, 0xc4, 0x07, 0x18, 0x58, 0xf8, 0x76, 0xc1, 0xf3, 0x74, 0x39, 0xdf,
	0x30, 0x48, 0x11, 0x53, 0x3b, 0xaf, 0xae, 0xe6, 0x8b, 0x77, 0x04, 0xd7, 0xbd, 0xdd, 0x16, 0x0b,
	0xa1, 0x17, 0x53, 0xac, 0xca, 0x94, 0x15, 0xad, 0x4d, 0xe6, 0x76, 0x99, 0x9a, 0x03, 0xe4, 0x47,
	0x4e, 0x9c, 0x94, 0xc8, 0xc4, 0x84, 0x59, 0x25, 0x07, 0x3a, 0x7c, 0x90, 0x11, 0x8f, 0x79, 0x07,
	0x77, 0x21, 0xed, 0x5c, 0x23, 0x0a, 0x7a, 0xde, 0x4b, 0xdc, 0xd9, 0x28, 0x9b, 0x65, 0x6e, 0x63,
	0xbc, 0x73, 0x66, 0x8d, 0x3a, 0x81, 0x5f, 0xf9, 0x06, 0x00, 0x96, 0xef, 0x84, 0xec, 0x6d, 0xda,
	0xb0, 0xc8, 0x5d, 0xbb, 0xc4, 0x3f, 0x7a, 0x04, 0x21, 0x3b, 0xa3, 0xc8, 0x8c, 0xc5, 0x00, 0x7d,
	0xb2, 0x94, 0x8b, 0xfd, 0x05, 0xe7, 0xd5, 0x00, 0xa5, 0x17, 0x03, 0x65, 0xbc, 0xc4, 0xb4, 0x5a,
	0x64, 0x29, 0xd7, 0x69, 0x95, 0x25, 0x4e, 0xce, 0x47, 0x5f, 0xf8, 0x64, 0x19, 0x2f, 0x43, 0xf2,
	0x7e, 0x14, 0xca, 0xa9, 0x82, 0xbf, 0xd4, 0x10, 0xc2, 0x41, 0x5f, 0x70, 0x78, 0x17, 0x7b, 0x9b,
	0x31, 0x57, 0x2a, 0x4e, 0xcf, 0x74, 0x5a, 0xea, 0x17, 0xc5, 0xa9, 0xa1, 0xbe, 0x6e, 0xd2, 0xc7,
	0xc7, 0x95, 0xa6, 0x46, 0xf7, 0x51, 0x04, 0xf4, 0xf9, 0xa0, 0x4c, 0xef, 0x4c, 0x65, 0x22, 0xa8,
	0xdd, 0x5d, 0x7c, 0x0a, 0x86, 0xff, 0x6c, 0x13, 0x49, 0x65, 0xcb, 0x12, 0xa3, 0x97, 0x71, 0x0e,
	0xb3, 0x11, 0x4a, 0x86, 0x7e, 0xbb, 0x78, 0x01, 0x26, 0xad, 0x99, 0x36, 0xa0, 0x65, 0x69, 0xfb,
	0x77, 0x86, 0x23, 0x4a, 0x4e, 0x15, 0x2e, 0x76, 0x43, 0xd9, 0x98, 0x1f, 0x0d, 0x23, 0x35, 0x4b,
	0x68, 0x98, 0x3f, 0x06, 0x5b, 0x63, 0x7e, 0xa5, 0xd6, 0x77, 0x7e, 0x84, 0xdf, 0xd3, 0xef, 0xf4,
	0xc0, 0xcb, 0x70, 0xe4, 0x04, 0x79, 0x57, 0xd4, 0xc4, 0x70, 0xd3, 0x38, 0x78, 0x8b, 0x67, 0xa3,
	0xc5, 0xc4, 0x83, 0xe3, 0xda, 0xe9, 0x21, 0xee, 0xc7, 0x92, 0xd7, 0x62, 0xba, 0x13, 0x90, 0xf1,
	0x34, 0x54, 0x00, 0xec, 0xb2, 0xa1, 0x82, 0x0f, 0xe8, 0xa7, 0x7e, 0x5e, 0x10, 0x47, 0x10, 0x9d,
	0x4e, 0x41, 0x3f, 0xde, 0x9d, 0xdf, 0xd9, 0x1a, 0x14, 0x60, 0x80, 0xd7, 0x89, 0x55, 0xd5, 0x12,
	0x14, 0x5a, 0x47, 0x54, 0x39, 0xf9, 0x25, 0x2c, 0x75, 0x71, 0x37, 0x85, 0xcf, 0xdf, 0xd6, 0x4c,
	0x45, 0x2b, 0x77, 0xea, 0xb5, 0xa0, 0xb4, 0x11, 0x0e, 0xad, 0xed, 0xc2, 0x2d, 0x80, 0xe6, 0x71,
	0xd2, 0x14, 0x72, 0x3f, 0x01, 0x10, 0xef, 0xb1, 0x6a, 0xc4, 0x0d, 0x67, 0x5e, 0xc5, 0x4f, 0x86,
	0xbd, 0x30, 0x14, 0x85, 0x4e, 0xac, 0x5e, 0x2c, 0x81, 0x55, 0xa4, 0x15, 0x71, 0xb4, 0x09, 0x1b,
	0x31, 0x5c, 0xfc, 0xe1, 0x06, 0x80, 0x62, 0xa5, 0x60, 0xdd, 0x7c, 0x6f, 0x35, 0x5c, 0x1a, 0x67,
};

#define TEST2_ENCKEY_LEN  16
#define TEST2_IV_LEN      16
#define TEST2_HASHKEY_LEN 64
#define TEST2_PAYLOAD_LEN 1424
#define TEST2_DIGEST_SIZE 32


static char test3_name[] = "HMAC-SHA512-AES128 decrypt test";

static uint8_t test3_enc_key[] = {
 0x0c, 0x06, 0xc0, 0x74, 0x74, 0x1b, 0x6d, 0xb5,
 0xbf, 0xe6, 0x99, 0x7a, 0x81, 0xdf, 0x35, 0xd6 };

static uint8_t test3_iv[] = {

 0x1b, 0x8d, 0x62, 0x3e, 0x37, 0x7f, 0xba, 0xd6,
 0x80, 0x0e, 0xf5, 0xc0, 0x2c, 0xc9, 0x19, 0x76 };


static uint8_t test3_hash_key[] = {

 0xb2, 0xdd, 0x23, 0x8e, 0x27, 0xd6, 0xad, 0x6e, 0x5d, 0xbb, 0x21, 0x9e, 0x8f, 0x55, 0xf9, 0xd4,
 0x2b, 0x1e, 0x91, 0xc1, 0x9e, 0x60, 0xa4, 0xd9, 0xc6, 0xe6, 0xba, 0xe0, 0xa4, 0x3b, 0xc4, 0xf8,
 0x67, 0x11, 0xcd, 0x1a, 0xeb, 0x92, 0x04, 0x3c, 0xc4, 0x40, 0xb1, 0xe8, 0xf5, 0x69, 0x7b, 0x70,
 0xd6, 0x1a, 0x1f, 0x2e, 0x9f, 0x98, 0x4b, 0xd9, 0x52, 0x4c, 0x83, 0x13, 0x37, 0x1e, 0x4d, 0xf3 };


static char test3_assoc [] = {

 0xc9, 0x49, 0xce, 0x4c, 0x00, 0x00, 0x00, 0x1f,

};

static char test3_src[] = {
	// hash IV
	0x1b, 0x8d, 0x62, 0x3e, 0x37, 0x7f, 0xba, 0xd6,
	0x80, 0x0e, 0xf5, 0xc0, 0x2c, 0xc9, 0x19, 0x76,

	// beginning of payload
	0x2b, 0xbc, 0x67, 0x7e, 0x7e, 0xab, 0xa4, 0x71, 0x7d, 0xfc, 0xdb, 0x13, 0xd0, 0x3a, 0x2b, 0x5c,
	0x85, 0x5b, 0x80, 0xcd, 0xff, 0xce, 0x55, 0xad, 0xfb, 0x2d, 0x2d, 0xc5, 0x2f, 0x77, 0x50, 0x75,
	0xda, 0x57, 0x3d, 0x47, 0x86, 0x63, 0x8f, 0xf3, 0x7f, 0xe2, 0x0c, 0x5d, 0xbd, 0x02, 0xdf, 0x91,
	0x5c, 0x59, 0x8b, 0x50, 0x24, 0x65, 0x54, 0xca, 0x21, 0xc7, 0x2d, 0xd6, 0x8a, 0xe2, 0xed, 0x9c,
	0x4d, 0x16, 0xcc, 0xb6, 0x17, 0xb4, 0x28, 0xc8, 0xfc, 0xbf, 0xef, 0x5d, 0x53, 0xcf, 0x85, 0xe7,
	0xef, 0x0e, 0xf8, 0xa4, 0x34, 0x07, 0xdf, 0x08, 0x15, 0x3a, 0x1c, 0xf9, 0x60, 0xe0, 0x1f, 0x36,
	0x68, 0x5e, 0x74, 0x81, 0x1a, 0x36, 0xc9, 0x5d, 0x20, 0x15, 0x1d, 0x5b, 0x0b, 0x08, 0xb9, 0x5b,
	0x1d, 0x90, 0x16, 0xb3, 0xee, 0x01, 0x77, 0x63, 0x6b, 0xc7, 0x00, 0x30, 0x85, 0xb2, 0xc3, 0x06,
	0xba, 0xea, 0xbb, 0x46, 0x21, 0x71, 0x6d, 0x7a, 0x1e, 0x1e, 0x4b, 0x18, 0x48, 0x59, 0xa8, 0xea,
	0x9d, 0x80, 0x0d, 0x36, 0x3d, 0x09, 0xe0, 0x5e, 0x2e, 0xbb, 0x34, 0x8b, 0x8f, 0x73, 0xe5, 0xf5,
	0x54, 0xed, 0x8c, 0xe7, 0x2e, 0xd0, 0x5e, 0xcd, 0xef, 0x8b, 0x62, 0xf3, 0x60, 0xec, 0x2e, 0x27,
	0xf8, 0x77, 0x4c, 0x57, 0x18, 0x16, 0xbc, 0x61, 0xbc, 0x42, 0x16, 0x83, 0x3b, 0x6d, 0xb4, 0x8a,
	0xd5, 0xe3, 0x69, 0x25, 0x10, 0x10, 0x32, 0x61, 0x83, 0x58, 0xef, 0x77, 0xf0, 0xdc, 0xec, 0x58,
	0xf4, 0xd9, 0xcb, 0xeb, 0xb1, 0xe6, 0xc2, 0xc4, 0xc9, 0xb9, 0xd2, 0xdc, 0xd3, 0x79, 0xb6, 0x68,
	0x8b, 0x13, 0xbe, 0xd2, 0xaa, 0x6e, 0x20, 0x72, 0x6f, 0x08, 0x3a, 0x12, 0xf8, 0x81, 0xc6, 0x1c,
	0x7e, 0x69, 0x29, 0x49, 0x97, 0xed, 0x1e, 0x4d, 0x40, 0xbe, 0xa6, 0xd3, 0xd4, 0x5d, 0xc1, 0x75,
	0x47, 0x12, 0x9c, 0xf6, 0xbc, 0xeb, 0xca, 0xf9, 0x8b, 0x7a, 0xd8, 0x3c, 0x32, 0xb0, 0x78, 0xaa,
	0x82, 0xd3, 0x75, 0xb5, 0x14, 0xbb, 0x79, 0xe8, 0x0b, 0x03, 0x2e, 0x59, 0xac, 0x7b, 0x91, 0x3b,
	0x18, 0xf0, 0xb8, 0x29, 0xcb, 0xc7, 0x60, 0x73, 0xcf, 0xd5, 0x6d, 0x7f, 0x8e, 0x26, 0xde, 0x65,
	0xa2, 0x20, 0x1a, 0xb8, 0xa5, 0xc9, 0xfd, 0x76, 0x1c, 0x5d, 0xd7, 0xd9, 0xbc, 0xf1, 0xd2, 0x6e,
	0xf3, 0x5f, 0x75, 0x11, 0x35, 0xdb, 0x3b, 0xb9, 0x40, 0xfe, 0x3b, 0xd4, 0xb6, 0x67, 0xc4, 0x6d,
	0xb4, 0xa4, 0x00, 0x12, 0xcd, 0x0f, 0x15, 0xb4, 0xc8, 0xa4, 0xbf, 0x53, 0xd9, 0x95, 0xd8, 0x83,
	0xc0, 0x6a, 0xe6, 0x42, 0x98, 0x5e, 0x8e, 0x27, 0x38, 0xa5, 0xea, 0xe5, 0xfa, 0xb4, 0x8d, 0x7c,
	0xd6, 0xa7, 0x57, 0x91, 0x76, 0xa3, 0x2e, 0x20, 0xa0, 0x2e, 0xd8, 0x39, 0xc3, 0x81, 0xba, 0x81,
	0xc8, 0xcf, 0x21, 0xb7, 0x6a, 0xf2, 0x85, 0x24, 0x67, 0xa8, 0x20, 0x2a, 0x6e, 0x0f, 0x8d, 0xe9,
	0x0e, 0x86, 0xbd, 0x29, 0xb5, 0x1a, 0x24, 0xcf, 0xc8, 0xca, 0xe1, 0x88, 0xb9, 0x1e, 0x8d, 0x3a,
	0x46, 0x36, 0xbc, 0xd9, 0x15, 0x4a, 0xeb, 0xc1, 0xab, 0x96, 0xf6, 0xf0, 0x7d, 0xb8, 0x58, 0x47,
	0x5a, 0x26, 0xdb, 0x97, 0x8f, 0xda, 0x06, 0x94, 0x58, 0xdf, 0xe3, 0xfa, 0xc7, 0xcb, 0x74, 0x4d,
	0x0c, 0xe8, 0x45, 0x66, 0x90, 0xd5, 0xfb, 0x7a, 0x03, 0x28, 0xa1, 0x16, 0x2d, 0x5a, 0x87, 0xfb,
	0xde, 0xb9, 0x9d, 0xaf, 0xc4, 0xc2, 0x1d, 0x93, 0x7b, 0x3e, 0x80, 0x77, 0x1c, 0x03, 0xb6, 0x7b,
	0x1f, 0x26, 0xe6, 0x22, 0x2c, 0x6a, 0x33, 0x7d, 0x2f, 0x4a, 0x71, 0xa5, 0x6f, 0x1a, 0x0d, 0xdc,
	0x5f, 0x30, 0xe6, 0xcc, 0x5d, 0xe2, 0x34, 0xb5, 0xd5, 0x85, 0x01, 0x1c, 0x5a, 0xfb, 0x6a, 0x44,
	0x41, 0xb8, 0x3d, 0xb2, 0x1e, 0xc8, 0x66, 0x50, 0x65, 0x83, 0xc9, 0xe9, 0xaf, 0x57, 0x9c, 0xeb,
	0x2d, 0x17, 0x52, 0xfd, 0x5d, 0x66, 0xd2, 0xea, 0xb7, 0x9d, 0x52, 0x4a, 0xb1, 0xf1, 0x41, 0x64,
	0x8f, 0x99, 0x76, 0x36, 0x86, 0x5d, 0x76, 0x70, 0x59, 0x5a, 0x83, 0xd7, 0x70, 0x60, 0x22, 0x48,
	0x84, 0xdb, 0x7d, 0x4f, 0x57, 0x6f, 0x59, 0x0a, 0xf3, 0xbe, 0xbe, 0xb6, 0xd5, 0x55, 0xbe, 0x83,
	0x16, 0x9f, 0x37, 0xc1, 0x66, 0x11, 0x6e, 0x0d, 0x16, 0x51, 0xb4, 0x9c, 0xe4, 0x4b, 0x95, 0xb4,
	0xbe, 0xd7, 0xf9, 0xee, 0xf2, 0x2e, 0x6d, 0xc4, 0xf4, 0xec, 0x12, 0x6c, 0xc1, 0x9d, 0x54, 0xc1,
	0x01, 0x81, 0x34, 0xbb, 0xfb, 0x02, 0x6c, 0x76, 0x97, 0x9a, 0x53, 0x79, 0x9b, 0x17, 0xe2, 0x0a,
	0x3e, 0x69, 0x24, 0x72, 0x89, 0xe9, 0xd0, 0x91, 0xdf, 0x58, 0x45, 0x9d, 0xd7, 0x6c, 0x76, 0x35,
	0xa4, 0x98, 0x4b, 0xe1, 0x41, 0xd4, 0x45, 0x08, 0x19, 0x48, 0xbb, 0x1a, 0xea, 0x5b, 0xf5, 0x65,
	0x8d, 0xeb, 0x21, 0x0e, 0x43, 0x57, 0xd1, 0xdb, 0xe4, 0xc9, 0x3d, 0xc5, 0xbc, 0xee, 0xd0, 0x3e,
	0x37, 0xa9, 0x34, 0xc7, 0xa8, 0x85, 0x42, 0xd0, 0x98, 0x58, 0xe0, 0x72, 0xb1, 0xc8, 0x97, 0xa5,
	0x13, 0x9e, 0x4e, 0x85, 0x88, 0x40, 0x1a, 0x64, 0x97, 0xff, 0x18, 0xf0, 0x7e, 0x19, 0x55, 0x42,
	0xe0, 0x58, 0x98, 0xef, 0xbc, 0xa2, 0x10, 0xee, 0xba, 0x5e, 0xad, 0x13, 0x80, 0x18, 0xbe, 0xd9,
	0x7a, 0x0d, 0x7b, 0x49, 0xea, 0x1d, 0x83, 0x12, 0x24, 0xa3, 0x3a, 0x83, 0x18, 0x14, 0xb4, 0xec,
	0x79, 0x81, 0xfe, 0x92, 0x1d, 0x00, 0xdb, 0x67, 0xb1, 0x54, 0x58, 0x08, 0xda, 0x4b, 0x25, 0x2e,
	0xb2, 0x41, 0x29, 0x1d, 0xc7, 0xab, 0x82, 0x3f, 0xb6, 0x6a, 0x06, 0x82, 0x0b, 0xcc, 0xe8, 0x48,
	0x25, 0x6c, 0xdf, 0x1b, 0x22, 0xe5, 0x7c, 0xbe, 0xed, 0xcf, 0x82, 0xd5, 0x21, 0x35, 0x8e, 0x73,
	0x45, 0x07, 0xb9, 0x23, 0xc5, 0xf4, 0x08, 0xfc, 0xfb, 0xf2, 0x2e, 0xea, 0xf5, 0x4b, 0xce, 0xc0,
	0x59, 0xc2, 0x5f, 0x12, 0xb8, 0xe6, 0x96, 0xbb, 0x78, 0x0e, 0xa2, 0x69, 0x52, 0x3b, 0xac, 0xb1,
	0x17, 0x29, 0x5e, 0x35, 0x66, 0xc9, 0x95, 0x9a, 0x37, 0x28, 0x0d, 0x7a, 0xf2, 0x99, 0xfe, 0x7d,
	0x10, 0x1f, 0x26, 0x1e, 0xa1, 0xbf, 0x1e, 0x76, 0xd5, 0xfa, 0xe3, 0x44, 0x7c, 0xc9, 0xfa, 0x4b,
	0x33, 0x8d, 0xd1, 0x5f, 0x99, 0xf5, 0xdb, 0x44, 0x2c, 0x58, 0x72, 0x08, 0x07, 0xca, 0x60, 0xea,
	0x68, 0x42, 0x13, 0x53, 0x07, 0xca, 0x5c, 0xdf, 0x0f, 0xb2, 0x9f, 0x4c, 0xf7, 0xd4, 0x7f, 0x10,
	0x03, 0x2e, 0xbb, 0xda, 0x6b, 0x9b, 0x5e, 0x91, 0xf9, 0x97, 0x86, 0x59, 0xe7, 0xdc, 0x96, 0x3f,
	0xa1, 0x50, 0x50, 0x63, 0x48, 0xea, 0x2d, 0x24, 0xd3, 0x87, 0x5b, 0x94, 0x2e, 0x34, 0xb1, 0xaf,
	0x81, 0x3c, 0x1f, 0x52, 0x0e, 0x7f, 0x86, 0x89, 0xca, 0x04, 0x81, 0xc2, 0x0d, 0xfc, 0x0a, 0x69,
	0xaa, 0x64, 0xd0, 0xda, 0xa0, 0x54, 0x8e, 0xa6, 0xbb, 0xbc, 0x81, 0xc4, 0xda, 0x9b, 0x16, 0xa4,
	0xae, 0x00, 0x07, 0xa1, 0x01, 0xb4, 0x18, 0x54, 0x8d, 0xc8, 0x02, 0xec, 0x8d, 0x64, 0xe7, 0x82,
	0xff, 0x07, 0xc9, 0x85, 0xc9, 0x4e, 0x54, 0x32, 0xd7, 0xac, 0x60, 0xfe, 0xc1, 0x69, 0x19, 0x87,
	0x83, 0x1e, 0xfa, 0x66, 0x0b, 0x6a, 0x27, 0xef, 0x90, 0x62, 0x0c, 0xde, 0xb8, 0xe5, 0x57, 0x36,
	0xdb, 0x15, 0x9a, 0x2e, 0x79, 0x86, 0x15, 0x46, 0xca, 0xca, 0x23, 0xf2, 0xd4, 0xe3, 0xfc, 0x36,
	0xe3, 0x13, 0x11, 0x82, 0x7c, 0xe0, 0xad, 0x1f, 0xaf, 0x48, 0x28, 0x32, 0xdd, 0x4f, 0x13, 0x19,
	0x08, 0x89, 0x93, 0x99, 0xda, 0x95, 0xe6, 0x17, 0x8a, 0x64, 0x42, 0xad, 0xd9, 0x42, 0x2c, 0xad,
	0x92, 0xcf, 0x73, 0x21, 0xd2, 0x34, 0xa6, 0xd5, 0x0f, 0xeb, 0x2c, 0xec, 0xeb, 0xdf, 0xa1, 0xd1,
	0x58, 0xe2, 0x4c, 0xa8, 0xfd, 0x08, 0x7c, 0xef, 0xd5, 0x99, 0xea, 0x3a, 0xa9, 0xb3, 0xb8, 0x9e,
	0xd6, 0xad, 0xb3, 0x8a, 0xef, 0x36, 0xcf, 0x83, 0x61, 0xbb, 0xfc, 0x7c, 0xff, 0x56, 0x56, 0x3b,
	0x0d, 0x48, 0xba, 0x6c, 0x73, 0xae, 0x80, 0x7d, 0xb6, 0x69, 0x7a, 0xcc, 0xad, 0x26, 0x77, 0x02,
	0xfd, 0xd2, 0xcb, 0xdc, 0xc1, 0x3c, 0x16, 0x0d, 0x99, 0x44, 0x7f, 0x48, 0x16, 0x3f, 0x14, 0xcb,
	0x96, 0xf0, 0x53, 0x5f, 0xb7, 0xc1, 0xa8, 0xdd, 0xa5, 0x7e, 0x36, 0x2f, 0xa3, 0x15, 0x46, 0x6c,
	0x2f, 0x4d, 0x98, 0x55, 0xba, 0x45, 0xae, 0xfe, 0x43, 0xc8, 0x61, 0x3a, 0x10, 0x0d, 0x26, 0x7e,
	0x7c, 0xbd, 0x56, 0xa9, 0x4f, 0x08, 0x4e, 0x6e, 0xa2, 0x42, 0x71, 0x66, 0x6b, 0x73, 0xf9, 0xbe,
	0x98, 0x05, 0xda, 0x9c, 0xea, 0xec, 0x93, 0x83, 0xd0, 0x65, 0xe4, 0x42, 0x68, 0x5d, 0x59, 0xca,
	0x14, 0x86, 0x11, 0x87, 0xef, 0x37, 0x15, 0xae, 0x63, 0xf8, 0x5b, 0x35, 0x4d, 0xe7, 0x16, 0x7e,
	0x5f, 0xc5, 0x93, 0x4b, 0x43, 0x35, 0x96, 0x10, 0x6c, 0xc5, 0x27, 0x85, 0x0b, 0x80, 0x90, 0x98,
	0x6d, 0xfc, 0xf2, 0x72, 0x79, 0xfc, 0x44, 0x6b, 0x0f, 0x1e, 0x11, 0xc8, 0x4b, 0xdb, 0xc8, 0x65,
	0xcc, 0xc6, 0x47, 0x10, 0x73, 0x24, 0xe1, 0x4e, 0x46, 0xa5, 0x55, 0x72, 0x57, 0x84, 0xc6, 0x40,
	0x29, 0xbf, 0x9c, 0x86, 0x39, 0x62, 0xfb, 0xde, 0x8d, 0xe8, 0xa5, 0x53, 0x44, 0xb6, 0x50, 0xb2,
	0xeb, 0x5d, 0xdf, 0x2b, 0x2f, 0xb0, 0x92, 0x93, 0x2a, 0xe5, 0x09, 0xe0, 0xbb, 0x43, 0xf6, 0x62,
	0x15, 0x8c, 0xed, 0xd5, 0xe8, 0x38, 0xac, 0x76, 0x95, 0x1f, 0xad, 0xdc, 0xaf, 0x7d, 0x74, 0xef,
	0x3b, 0xa9, 0xb5, 0x3c, 0x4a, 0x29, 0x38, 0xfc, 0x07, 0xa2, 0x81, 0xe1, 0xa6, 0x1e, 0xd3, 0x23,
	0xc6, 0xe9, 0xe9, 0x72, 0x6e, 0xc3, 0xd0, 0x1e, 0xcd, 0x39, 0x64, 0x39, 0xa0, 0x40, 0xcb, 0x3b,
	0xb5, 0xa2, 0xc7, 0x95, 0x5c, 0x2b, 0xa3, 0xe7, 0xc3, 0x99, 0x7c, 0x1a, 0x46, 0x52, 0xc2, 0xfa,
	0x89, 0xe5, 0x40, 0x0d, 0xd6, 0xd9, 0x8a, 0x4e, 0x26, 0x81, 0x67, 0x65, 0xa6, 0x52, 0x60, 0xf6,
	0xbb, 0x65, 0x11, 0x0a, 0x49, 0xa1, 0x70, 0xec, 0x6e, 0x8e, 0x59, 0x2a, 0xdc, 0xbf, 0xe1, 0x26,
	0xc0, 0x2e, 0x7f, 0xfa, 0x06, 0x36, 0x80, 0x60, 0x65, 0x72, 0x6f, 0x47, 0x76, 0x45, 0xb2, 0x5d,
	0x07, 0x67, 0x01, 0xca, 0xfd, 0xa2, 0xcc, 0xb7, 0xa0, 0x32, 0xd5, 0x34, 0xbe, 0x01, 0xaf, 0x18,
	0x2d, 0xd5, 0x16, 0x78, 0x5d, 0x1e, 0xcd, 0x77, 0xe8, 0xe2, 0x0d, 0x75, 0xff, 0xbf, 0x59, 0x1e,
	0xc5, 0x57, 0x55, 0x8f, 0x11, 0x87, 0x70, 0xbf, 0xf2, 0xe3, 0x37, 0x31, 0x48, 0xf1, 0xfa, 0xc8,
	0xdd, 0x33, 0x31, 0x17, 0x77, 0x22, 0x43, 0xa3, 0x81, 0x11, 0x5f, 0x24, 0xa4, 0xac, 0xae, 0xed,
	0x95, 0x15, 0x5d, 0x94, 0x37, 0xcd, 0x39, 0x48, 0xe7, 0x1b, 0xe1, 0xd2, 0xad, 0xec, 0xb3, 0x74,
};

static uint8_t test3_result [] = {
	0x45, 0x00, 0x05, 0x9e, 0x41, 0x1b, 0x00, 0x00, 0x40, 0x11, 0xa7, 0x1b, 0xc0, 0xa8, 0x0a, 0x64,
	0xc0, 0xa8, 0x01, 0x64, 0x84, 0xd6, 0x30, 0x39, 0x05, 0x8a, 0x34, 0x23, 0x5c, 0xf8, 0xc0, 0x2b,
	0x00, 0x06, 0x8f, 0x13, 0x00, 0x00, 0x00, 0x0a, 0x56, 0xbc, 0x1b, 0x52, 0x91, 0x61, 0x54, 0x47,
	0x73, 0x95, 0x67, 0x72, 0x1b, 0x74, 0x85, 0xf4, 0xd0, 0x3d, 0x93, 0x0e, 0xb8, 0x47, 0xff, 0x24,
	0x08, 0x24, 0x79, 0xb0, 0x06, 0x2b, 0xbb, 0x5c, 0xe7, 0xd7, 0xaf, 0x78, 0x38, 0x03, 0xbf, 0xab,
	0x98, 0x27, 0x1e, 0xb4, 0x9b, 0xa3, 0xa8, 0x6c, 0xe0, 0x3b, 0x7a, 0x98, 0x82, 0x79, 0xbc, 0x8a,
	0x9e, 0x36, 0x3b, 0xa4, 0x61, 0xf6, 0x01, 0x49, 0xcd, 0xb0, 0xc1, 0x06, 0xb3, 0x81, 0xb1, 0x4c,
	0xa8, 0xcf, 0x00, 0x43, 0x72, 0xa8, 0xaf, 0x53, 0xe3, 0x29, 0xeb, 0x66, 0xa3, 0xa8, 0xf0, 0x41,
	0xde, 0x2b, 0xe5, 0x3f, 0x22, 0xe6, 0x88, 0xef, 0x96, 0x4a, 0xf5, 0x4a, 0xcb, 0xa7, 0x96, 0x73,
	0x76, 0x96, 0xb6, 0xe9, 0x3e, 0x66, 0x3c, 0x21, 0x8f, 0x27, 0x87, 0x32, 0xcf, 0x78, 0x73, 0xad,
	0xa3, 0x59, 0xed, 0xc5, 0x3f, 0x75, 0xb5, 0xd6, 0xbf, 0xaa, 0x20, 0x8a, 0x51, 0xb6, 0xfd, 0xc8,
	0x4c, 0xb4, 0xb1, 0x8a, 0x1a, 0xed, 0xab, 0xa9, 0x14, 0x33, 0xdc, 0xe4, 0xab, 0x4f, 0x91, 0x4e,
	0xa8, 0x7e, 0x14, 0xe8, 0xf4, 0xc9, 0xbe, 0xb3, 0x73, 0xde, 0x3e, 0xc5, 0x94, 0x3b, 0x8d, 0xe0,
	0xef, 0x3e, 0x6a, 0x09, 0x2b, 0x15, 0xb3, 0x3f, 0x48, 0x8f, 0x23, 0xf3, 0xde, 0xb5, 0x42, 0x87,
	0x33, 0x56, 0x6f, 0x27, 0x1f, 0x2d, 0xdb, 0x92, 0x0b, 0x19, 0x57, 0x9f, 0x54, 0xe4, 0x7f, 0x44,
	0x22, 0xe9, 0x4d, 0x4d, 0xfe, 0x00, 0x8d, 0x47, 0x8f, 0xb0, 0x3a, 0x6e, 0x65, 0x7c, 0xf5, 0x99,
	0xd2, 0x64, 0xc0, 0xf1, 0x91, 0x9b, 0x84, 0x9c, 0xb4, 0xdb, 0x3b, 0x09, 0xc0, 0xba, 0x4d, 0xe2,
	0xa3, 0x9a, 0x30, 0xa1, 0x9b, 0xbd, 0xe8, 0x2a, 0x6d, 0x23, 0x98, 0xd3, 0x9f, 0x8d, 0x6c, 0x72,
	0xf1, 0x2c, 0x63, 0x82, 0xc8, 0xe7, 0x1e, 0x7c, 0xc3, 0x59, 0x85, 0x83, 0x13, 0xd2, 0x65, 0xb6,
	0x6d, 0x95, 0x58, 0x08, 0x52, 0x40, 0x32, 0xc0, 0x63, 0xcb, 0x93, 0x03, 0x58, 0xff, 0x75, 0x4a,
	0x2b, 0xd8, 0xcc, 0xf3, 0xc0, 0xeb, 0x70, 0x83, 0x44, 0xf5, 0x06, 0x58, 0xc8, 0x6b, 0x0e, 0x35,
	0x01, 0x66, 0x3d, 0x53, 0xa7, 0x6f, 0x13, 0x0a, 0x3a, 0xa6, 0x0d, 0x93, 0xa5, 0x82, 0xdd, 0xd1,
	0x5b, 0xa9, 0xc4, 0x1b, 0x94, 0x34, 0x9e, 0xd9, 0x2a, 0xa4, 0x31, 0xf2, 0x0f, 0x3f, 0x27, 0x10,
	0xa6, 0x64, 0x64, 0x4d, 0xd3, 0x77, 0x57, 0x0e, 0x1e, 0x65, 0xa1, 0xc3, 0xe7, 0x7e, 0x94, 0x42,
	0x27, 0x59, 0x5d, 0xbc, 0x8d, 0xfb, 0x95, 0xb7, 0x9f, 0xc6, 0xa9, 0xaf, 0x05, 0xd0, 0xbf, 0xab,
	0x34, 0x23, 0xf8, 0x08, 0x9b, 0x50, 0x16, 0xb9, 0xb5, 0xb7, 0x7c, 0x9c, 0x35, 0x11, 0xdf, 0x5c,
	0x6a, 0x3c, 0x18, 0xf7, 0x38, 0xad, 0xaf, 0xd7, 0x73, 0x58, 0x86, 0x79, 0x29, 0x46, 0x24, 0x5d,
	0x69, 0x1d, 0x65, 0x04, 0x6d, 0x7b, 0xbd, 0x22, 0x32, 0x3a, 0xbe, 0x67, 0x4b, 0x9d, 0xc4, 0xb5,
	0xda, 0xdc, 0xac, 0x12, 0x8a, 0x5b, 0xe9, 0xfd, 0xb4, 0x70, 0x76, 0xdd, 0xb6, 0x9b, 0x3a, 0x1f,
	0xb8, 0xa0, 0x24, 0x25, 0x1b, 0xe1, 0x47, 0x4e, 0x1b, 0x05, 0xb5, 0x66, 0xa3, 0x79, 0x1b, 0x7d,
	0x56, 0xc8, 0x8f, 0xe0, 0x23, 0x78, 0xdd, 0xd7, 0xe8, 0x54, 0xb4, 0x9e, 0xef, 0xef, 0xbe, 0xa7,
	0x8f, 0xe2, 0xcc, 0xaa, 0xc3, 0x13, 0xf8, 0xdf, 0x18, 0xae, 0x45, 0xbb, 0x27, 0x61, 0x38, 0x7d,
	0x29, 0xc7, 0x5d, 0x4c, 0x40, 0x3b, 0x24, 0x28, 0x8f, 0xd8, 0xc7, 0x7e, 0xc7, 0x85, 0x25, 0x56,
	0x67, 0xf1, 0x01, 0x2a, 0x04, 0xf9, 0x09, 0x1c, 0xa7, 0x4f, 0xd8, 0xcf, 0xb0, 0x10, 0x4c, 0xd9,
	0xd8, 0xaa, 0x25, 0x18, 0xe5, 0x49, 0x40, 0x74, 0x22, 0x07, 0xf2, 0xe9, 0x8c, 0x17, 0x40, 0xf3,
	0x08, 0x41, 0x1e, 0x0c, 0x3a, 0x27, 0x28, 0xe2, 0x76, 0x00, 0xb1, 0x26, 0x11, 0xfd, 0xff, 0xe9,
	0xa7, 0x25, 0x01, 0x8c, 0x6e, 0x41, 0x00, 0x90, 0x49, 0xf2, 0x7a, 0xd5, 0x09, 0xba, 0xc9, 0x11,
	0xfb, 0xe7, 0x1d, 0x35, 0x0e, 0x46, 0x17, 0x85, 0x46, 0xc8, 0xab, 0x57, 0xc6, 0xab, 0x40, 0x6d,
	0xd0, 0x41, 0xfa, 0x3e, 0x83, 0xfa, 0xcf, 0xcc, 0xed, 0x49, 0xa1, 0xf6, 0x03, 0x6a, 0x08, 0xfe,
	0x51, 0x25, 0x33, 0x60, 0x6b, 0x4b, 0xe5, 0xb2, 0x13, 0x90, 0x09, 0xd9, 0x3b, 0x4a, 0x47, 0x0b,
	0x8b, 0x41, 0x4a, 0x0e, 0x3b, 0x19, 0xda, 0x28, 0x62, 0x7c, 0x1f, 0x65, 0xe6, 0x27, 0x63, 0x38,
	0x4c, 0x96, 0x98, 0xb8, 0xe1, 0x7d, 0x6a, 0xf5, 0x0d, 0x73, 0xce, 0x49, 0xbd, 0x15, 0x54, 0x49,
	0x56, 0x9e, 0x57, 0x92, 0xb7, 0x32, 0xba, 0x19, 0xae, 0xd9, 0x7e, 0x94, 0x00, 0xe1, 0xcc, 0x4d,
	0x78, 0x64, 0x05, 0x59, 0xe1, 0x6f, 0x4e, 0xef, 0xe2, 0x1d, 0x38, 0xa0, 0x32, 0x8c, 0xe9, 0x89,
	0x2b, 0x40, 0x1b, 0xe2, 0x72, 0xd5, 0xfc, 0x20, 0xaf, 0x7a, 0xb5, 0xaf, 0x5c, 0x81, 0xfc, 0xd4,
	0xe6, 0x01, 0x2d, 0xc7, 0x70, 0x7c, 0xb6, 0x53, 0x99, 0xee, 0xf3, 0xcb, 0x7b, 0xdc, 0x54, 0xa6,
	0x1c, 0x6f, 0x88, 0x8f, 0x45, 0x84, 0xaf, 0xf4, 0xff, 0x64, 0xa3, 0x5b, 0xe6, 0xa0, 0x2f, 0xcc,
	0xa1, 0x5c, 0x93, 0x12, 0xd8, 0x4a, 0x65, 0x71, 0x38, 0x58, 0x3d, 0xb3, 0x34, 0x91, 0x59, 0x50,
	0x01, 0xe2, 0xdf, 0x46, 0x66, 0x8f, 0x3a, 0x65, 0xf3, 0xdd, 0xc0, 0xd9, 0x7d, 0xef, 0xa5, 0x1f,
	0x4c, 0x39, 0x31, 0x24, 0x83, 0x96, 0x96, 0xbb, 0xee, 0xd3, 0x6f, 0x22, 0x64, 0xc8, 0x72, 0x65,
	0xaa, 0x52, 0xab, 0x11, 0xe1, 0xe5, 0x76, 0xd4, 0xc3, 0x37, 0xae, 0x40, 0x26, 0x53, 0x5f, 0x72,
	0x8c, 0x90, 0x97, 0x0f, 0x26, 0x2d, 0xcb, 0x14, 0x00, 0x3a, 0x36, 0x64, 0x02, 0xa9, 0xca, 0xad,
	0xfb, 0x75, 0xbe, 0xdc, 0x5b, 0x34, 0xb0, 0x1e, 0x6b, 0x5e, 0x5e, 0x92, 0xb2, 0xbe, 0x04, 0x3e,
	0x4e, 0x9b, 0x4e, 0x75, 0xc8, 0x19, 0x89, 0xc8, 0x53, 0xc0, 0x2d, 0x55, 0x69, 0xf7, 0x02, 0x64,
	0x6c, 0xc0, 0x40, 0xc7, 0xf5, 0xf0, 0xe5, 0x60, 0x4f, 0x44, 0xf2, 0x01, 0x02, 0xf7, 0x3f, 0x50,
	0x92, 0x8d, 0xc5, 0x5b, 0xa6, 0x4f, 0x23, 0xf9, 0x0f, 0x50, 0x4f, 0x78, 0x47, 0x51, 0xdc, 0xb4,
	0x12, 0x1c, 0x7b, 0x07, 0x0c, 0x61, 0x67, 0x5b, 0xa5, 0x5a, 0x5c, 0xa7, 0x51, 0x9c, 0xf7, 0xe3,
	0x29, 0xbd, 0x3e, 0xd0, 0x0c, 0x62, 0xc9, 0x1b, 0xb2, 0x18, 0x93, 0xfa, 0x6a, 0x6f, 0xae, 0x7c,
	0x8b, 0x29, 0x83, 0x97, 0x8a, 0xea, 0xf3, 0x2f, 0x44, 0x4f, 0xd6, 0x95, 0xeb, 0xce, 0x79, 0x15,
	0x8b, 0xb7, 0xe5, 0x97, 0x19, 0xae, 0xb2, 0xcc, 0xc7, 0x45, 0xc6, 0x31, 0xb4, 0x74, 0xad, 0x3f,
	0x9d, 0x30, 0xd6, 0x28, 0x1a, 0xc9, 0x57, 0x5f, 0x19, 0x2e, 0xf4, 0x04, 0xfc, 0x6d, 0x19, 0x87,
	0x25, 0xfe, 0x1e, 0x3e, 0xad, 0xd0, 0x0a, 0x74, 0x15, 0xd0, 0xa5, 0xc9, 0x44, 0x52, 0x08, 0xe2,
	0x82, 0xde, 0x0a, 0x9c, 0xa8, 0x61, 0xfb, 0xc1, 0x8f, 0xf0, 0xc5, 0x8b, 0x5d, 0xdf, 0x12, 0x82,
	0xdd, 0x30, 0xc1, 0x8a, 0x00, 0xcb, 0xfe, 0x15, 0x9c, 0xa3, 0xde, 0xe0, 0xf5, 0xe6, 0xc2, 0x77,
	0xc5, 0xcc, 0x14, 0x6d, 0x2e, 0x0f, 0x2e, 0xbd, 0xff, 0xf3, 0x49, 0x5d, 0xd2, 0x5b, 0xdf, 0xb0,
	0x8c, 0xa0, 0x3a, 0x8c, 0x6c, 0x39, 0xa2, 0x08, 0xdc, 0x80, 0xe8, 0xd2, 0x67, 0xab, 0x49, 0x2c,
	0x77, 0x5d, 0x99, 0xa5, 0x6d, 0xc7, 0x63, 0x6c, 0xba, 0xac, 0xc9, 0x8d, 0x07, 0xa9, 0x3d, 0x93,
	0x49, 0x77, 0x20, 0xb5, 0xb0, 0xc2, 0xbd, 0x8d, 0x42, 0xa6, 0x5f, 0xa9, 0x51, 0xa8, 0xd5, 0xc8,
	0x06, 0x6e, 0x6e, 0x73, 0x35, 0xd1, 0xdf, 0xf0, 0x7d, 0xa9, 0x7d, 0x84, 0x52, 0xba, 0x18, 0x9b,
	0x31, 0x38, 0x51, 0xe2, 0xfa, 0x0e, 0x6f, 0x3c, 0xb4, 0xce, 0xe6, 0x05, 0x76, 0xbb, 0xce, 0x7c,
	0x2a, 0x3c, 0xef, 0x5f, 0x0d, 0xcf, 0x4f, 0x8a, 0x78, 0xcc, 0x0e, 0xca, 0x86, 0x26, 0x65, 0xb8,
	0x5e, 0xb6, 0x9a, 0x58, 0xc5, 0x09, 0x95, 0x79, 0xd7, 0x7b, 0x7f, 0x4d, 0x36, 0x4d, 0xca, 0x60,
	0x89, 0xb9, 0xc0, 0x96, 0x88, 0x0f, 0x20, 0x00, 0xdc, 0x2e, 0xca, 0x62, 0x55, 0x30, 0x1a, 0xb3,
	0xe6, 0xb4, 0x0c, 0xab, 0xbd, 0xa1, 0x25, 0x94, 0x1c, 0xa4, 0xe2, 0x52, 0xf1, 0xac, 0xb3, 0x7a,
	0x65, 0x73, 0x10, 0xee, 0x82, 0x30, 0xee, 0x5e, 0x5e, 0xb9, 0xc1, 0xb3, 0xe9, 0xdb, 0x67, 0xcf,
	0x90, 0x73, 0x7b, 0x4d, 0x14, 0xa0, 0xe2, 0x30, 0x44, 0xc4, 0x82, 0x35, 0x70, 0x35, 0xaf, 0xd5,
	0xa8, 0xbf, 0xc3, 0x2b, 0xef, 0xb2, 0x89, 0x4d, 0x6b, 0x4a, 0x01, 0x54, 0x26, 0x68, 0x23, 0xb6,
	0xdb, 0x9e, 0x03, 0xef, 0x3e, 0xe5, 0x1f, 0x82, 0xa9, 0xa1, 0xb7, 0x19, 0xd7, 0x66, 0xef, 0x7f,
	0x25, 0xb2, 0xaa, 0x14, 0x64, 0x34, 0x62, 0xcf, 0x7e, 0x63, 0x23, 0xa4, 0xcb, 0x47, 0x5a, 0xa6,
	0xe5, 0x5e, 0x95, 0x24, 0x43, 0xb4, 0xa6, 0xed, 0x55, 0x5e, 0x06, 0x2c, 0xc4, 0xf5, 0xac, 0xea,
	0xa8, 0x56, 0xfe, 0x0c, 0x8a, 0x60, 0xdc, 0x09, 0xc3, 0xff, 0xad, 0x8e, 0x46, 0x08, 0x34, 0x2c,
	0x66, 0xc9, 0x50, 0xa9, 0x7d, 0xf6, 0x96, 0xd3, 0x54, 0x9d, 0xff, 0x19, 0x92, 0xab, 0x03, 0x3a,
	0x02, 0x01, 0x47, 0x8c, 0x62, 0x23, 0x95, 0x25, 0x22, 0x43, 0xb4, 0x69, 0x4b, 0xe8, 0x95, 0xb1,
	0xb2, 0xe5, 0x5a, 0x2f, 0xdb, 0xf1, 0x02, 0x30, 0x8e, 0x02, 0x49, 0x20, 0xad, 0x4c, 0x5b, 0xaf,
	0x4d, 0xa2, 0x3c, 0xaf, 0xc5, 0xd1, 0xd5, 0xe7, 0x14, 0x89, 0x50, 0x5f, 0x71, 0xe5, 0x10, 0x23,
	0xca, 0x6b, 0x53, 0xa6, 0x5c, 0x55, 0xd6, 0xea, 0x57, 0x1f, 0x0a, 0x05, 0x6b, 0x65, 0xb4, 0xb8,
	0x07, 0xf0, 0x68, 0xcc, 0xc2, 0x3d, 0xb4, 0xd6, 0xc6, 0x04, 0x36, 0x37, 0xea, 0x46, 0x5b, 0xb4,
	0xb1, 0xae, 0x5a, 0x0d, 0x03, 0x30, 0xf7, 0x5b, 0x4f, 0x02, 0x60, 0xba, 0x67, 0x14, 0x73, 0x6f,
	0x05, 0xdb, 0x3b, 0xc7, 0x18, 0xef, 0x9d, 0xde, 0xf4, 0xd3, 0x15, 0xde, 0x1a, 0x70, 0x92, 0xcb,
	0x1e, 0xed, 0xd9, 0x22, 0x1d, 0xd0, 0x7d, 0x6d, 0xd2, 0xdd, 0x27, 0x3a, 0xf1, 0x9a, 0x00, 0x04,
	0xdd, 0x33, 0x31, 0x17, 0x77, 0x22, 0x43, 0xa3, 0x81, 0x11, 0x5f, 0x24, 0xa4, 0xac, 0xae, 0xed,
	0x95, 0x15, 0x5d, 0x94, 0x37, 0xcd, 0x39, 0x48, 0xe7, 0x1b, 0xe1, 0xd2, 0xad, 0xec, 0xb3, 0x74,
};


#define TEST3_ENCKEY_LEN  16
#define TEST3_IV_LEN      16
#define TEST3_HASHKEY_LEN 64
#define TEST3_PAYLOAD_LEN 1440
#define TEST3_DIGEST_SIZE 32

#define SPU2_TEST_VECTORS_MAX 4

static struct spu_test_vector_t spu2_test_vectors[SPU2_TEST_VECTORS_MAX] = {

	{
		.name = test0_name,
		.inbound = 0,
		.enc_key = test0_enc_key,
		.enc_key_len = TEST0_ENCKEY_LEN,
		.iv = test0_iv,
		.iv_len = TEST0_IV_LEN,
		.hash_key = NULL,
		.hash_key_len = 0,
		.assoc = NULL,
		.src = test0_src,
		.src_size = TEST0_PAYLOAD_LEN,
		.result = test0_result,
		.digest_size = TEST0_DIGEST_SIZE,
		.calg = CIPHER_ALG_AES,
		.cmode = CIPHER_MODE_CBC,
		.ctype = CIPHER_TYPE_NONE,
		.halg = HASH_ALG_NONE,
		.hmode = HASH_MODE_HMAC,
		.htype = HASH_TYPE_NONE,
	},
	{
		.name = test1_name,
		.inbound = 0,
		.enc_key = test1_enc_key,
		.enc_key_len = TEST1_ENCKEY_LEN,
		.iv = test1_iv,
		.iv_len = TEST1_IV_LEN,
		.hash_key = test1_hash_key,
		.hash_key_len = TEST1_HASHKEY_LEN,
		.assoc = test1_assoc,
		.src = test1_src,
		.src_size = TEST1_PAYLOAD_LEN,
		.result = test1_result,
		.digest_size = TEST1_DIGEST_SIZE,
		.calg = CIPHER_ALG_AES,
		.cmode = CIPHER_MODE_CBC,
		.ctype = CIPHER_TYPE_NONE,
		.halg = HASH_ALG_SHA1,
		.hmode = HASH_MODE_HMAC,
		.htype = HASH_TYPE_NONE,
	},
	{
		.name = test2_name,
		.inbound = 0,
		.enc_key = test2_enc_key,
		.enc_key_len = TEST2_ENCKEY_LEN,
		.iv = test2_iv,
		.iv_len = TEST2_IV_LEN,
		.hash_key = test2_hash_key,
		.hash_key_len = TEST2_HASHKEY_LEN,
		.assoc = test2_assoc,
		.src = test2_src,
		.src_size = TEST2_PAYLOAD_LEN,
		.result = test2_result,
		.digest_size = TEST2_DIGEST_SIZE,
		.calg = CIPHER_ALG_AES,
		.cmode = CIPHER_MODE_CBC,
		.ctype = CIPHER_TYPE_NONE,
		.halg = HASH_ALG_SHA512,
		.hmode = HASH_MODE_HMAC,
		.htype = HASH_TYPE_NONE,
	},
	{
		.name = test3_name,
		.inbound = 1,
		.enc_key = test3_enc_key,
		.enc_key_len = TEST3_ENCKEY_LEN,
		.iv = test3_iv,
		.iv_len = TEST3_IV_LEN,
		.hash_key = test3_hash_key,
		.hash_key_len = TEST3_HASHKEY_LEN,
		.assoc = test3_assoc,
		.src = test3_src,
		.src_size = TEST3_PAYLOAD_LEN + TEST3_DIGEST_SIZE,
		.result = test3_result,
		.digest_size = TEST3_DIGEST_SIZE,
		.calg = CIPHER_ALG_AES,
		.cmode = CIPHER_MODE_CBC,
		.ctype = CIPHER_TYPE_NONE,
		.halg = HASH_ALG_SHA512,
		.hmode = HASH_MODE_HMAC,
		.htype = HASH_TYPE_NONE,
	},
};


#define SPU2_TEST_BATCHSIZE 500
#define SPU2_MAX_CHANNEL 4
static struct bcmspu_message test_msg[SPU2_MAX_CHANNEL][SPU2_TEST_BATCHSIZE];
static struct bcmspu_test_info test_info[SPU2_MAX_CHANNEL][SPU2_TEST_BATCHSIZE];
static uint8_t *test_buff_src[SPU2_MAX_CHANNEL][SPU2_TEST_BATCHSIZE];
static uint8_t *test_buff_dst[SPU2_MAX_CHANNEL][SPU2_TEST_BATCHSIZE];
static uint8_t *same_src_buffer = NULL;
static dma_addr_t same_src_buffer_dma;

static atomic_t num_request[SPU2_MAX_CHANNEL];
static atomic_t num_response[SPU2_MAX_CHANNEL];
static uint64_t sample_size = 0;
static uint64_t start_time[SPU2_MAX_CHANNEL];
static uint64_t end_time[SPU2_MAX_CHANNEL];
static atomic64_t test_completed;
static atomic64_t test_requested;
static uint64_t first_packet_timestamp = U64_MAX;
static uint64_t last_packet_timestamp = 0;
static atomic64_t total_bytes;
static struct timeval start_t, end_t;
static struct tm broken;
static atomic_t print_summary;
static atomic_t abort_test;
static int vec_id_sel;

extern int spu_test_vector_id;
extern int spu_test_preinit;
extern int spu_test_dedicated_pool;
extern int spu_test_verbose;
extern unsigned long spu_test_in_transit_limit;
extern int spu_test_src_frag;
extern int spu_test_check_output;
extern int spu_test_same_src_buffer;


static int spu2_prep_request(uint8_t chan);

static inline int spu2_select_next_test_chan(void)
{
	struct spu_hw *spu = &iproc_priv.spu;
	uint8_t chan;
	get_random_bytes(&chan, 1);
	return (chan % spu->spu_get_max_channel());
}

static void spu2_test_callback(struct bcmspu_message *msg)
{
	int k, i, err;
	int err_cnt = 0;
	int resp_hdr_len, payload_len, payload_offset, vec_idx;
	uint8_t *digest, *payload, chan;
	struct spu_hw *spu = &iproc_priv.spu;
	uint32_t digest_size, enckey_len, hashkey_len, msg_idx, completed, requested;
	uint64_t snapshot;
	char *result;
	u64 mbps;
	u32 in_transit;
	struct device *dev = &iproc_priv.pdev->dev;

	if (atomic_read(&abort_test))
		return;

	dma_unmap_sg(dev, msg->src, sg_nents(msg->src), DMA_TO_DEVICE);
	dma_unmap_sg(dev, msg->dst, sg_nents(msg->dst), DMA_FROM_DEVICE);

	chan = msg->test_info->chan;
	completed = atomic_inc_return(&num_response[chan]);
	requested = atomic_read(&num_request[chan]);
	msg_idx = completed - 1;

	/* if the test sample size is greater than SPU2_TEST_BATCHSIZE, compare
	   generated output on a per response basis */
	if (sample_size > SPU2_TEST_BATCHSIZE) {

		snapshot = atomic64_inc_return(&test_completed);

		if (0 == (snapshot % 10000000)) {
			do_gettimeofday(&end_t);
			time_to_tm(end_t.tv_sec, 0, &broken);
			printk("... %10lld of %lld processed at %d:%d:%d:%ld\n",
				snapshot, sample_size,
				broken.tm_hour, broken.tm_min, broken.tm_sec, end_t.tv_usec);
		}

		msg_idx = msg_idx % SPU2_TEST_BATCHSIZE;
		vec_idx = test_msg[chan][msg_idx].test_info->vec_id;
		enckey_len = spu2_test_vectors[vec_idx].enc_key_len;
		hashkey_len = spu2_test_vectors[vec_idx].hash_key_len;
		digest_size = spu2_test_vectors[vec_idx].digest_size;
		result = spu2_test_vectors[vec_idx].result;

		resp_hdr_len = spu->spu_response_hdr_len(hashkey_len, enckey_len, false);

		payload_len = spu->spu_payload_length(test_buff_dst[chan][msg_idx]);
		if ((payload_len == ((msg->test_info->pattern << 24) |
							 (msg->test_info->pattern << 16) |
							 (msg->test_info->pattern << 8)  |
							 msg->test_info->pattern)) ||
			(payload_len != (spu2_test_vectors[vec_idx].src_size -
							(spu2_test_vectors[vec_idx].inbound ?
							 spu2_test_vectors[vec_idx].digest_size : 0))))
		{
			atomic_set(&abort_test, 1);
			printk("\n!!! #%lld Payload Length Error (%x != %x):"
				   " test_msg[%d][%d] - vector #%d - pattern %x !!!\n",
				snapshot, payload_len,
				(spu2_test_vectors[vec_idx].src_size -
					spu2_test_vectors[vec_idx].inbound ?
					spu2_test_vectors[vec_idx].digest_size : 0),
				chan, msg_idx, vec_idx, msg->test_info->pattern);
			payload_offset = spu2_test_vectors[vec_idx].iv_len +
					(spu2_test_vectors[vec_idx].assoc ? 8 : 0);
			payload_len = (spu2_test_vectors[vec_idx].src_size -
					spu2_test_vectors[vec_idx].inbound ?
					spu2_test_vectors[vec_idx].digest_size : 0);
			goto fail;
		}

		{
			struct SPU2_FMD *fmd = (struct SPU2_FMD*)test_buff_dst[chan][msg_idx];
			u64 ctrl2 = le64_to_cpu(fmd->ctrl2);
			payload_offset = (ctrl2 & SPU2_PL_OFFSET) >> SPU2_PL_OFFSET_SHIFT;
			if (payload_offset !=
				(spu2_test_vectors[vec_idx].assoc ?
				spu2_test_vectors[vec_idx].iv_len + 8 : 0))
			{
				atomic_set(&abort_test, 1);
				printk("\n!!! #%lld Payload Offset Error (%x != %x):"
					   " test_msg[%d][%d] - vector #%d - pattern %x !!!\n",
					snapshot, payload_offset,
					(spu2_test_vectors[vec_idx].assoc ?
						spu2_test_vectors[vec_idx].iv_len + 8 : 0),
					chan, msg_idx, vec_idx, msg->test_info->pattern);
				goto fail;
			}

		}

		digest = &test_buff_dst[chan][msg_idx][resp_hdr_len + payload_offset + payload_len];
		err = spu->spu_status_process(&digest[digest_size]);
		if (err) {
			atomic_set(&abort_test, 1);
			printk("!!! #%lld Status Error: test_msg[%d][%d] - vector #%d - pattern %x !!!\n",
				snapshot, chan, msg_idx, vec_idx, msg->test_info->pattern);
			for (k = 0; k < 128; k++) {
				if (k%8 == 0)
					printk(KERN_CONT "\n");
				printk(KERN_CONT "0x%x ", digest[k]);
			}
			printk("\n");
		}

		payload = &test_buff_dst[chan][msg_idx][resp_hdr_len + payload_offset];

		atomic64_add(payload_len + digest_size, &total_bytes);

		if (spu_test_check_output &&
			memcmp(payload, result, payload_len + digest_size))
		{
			phys_addr_t phys_addr = virt_to_phys(test_buff_dst[chan][msg_idx]);
			printk("\n!!! #%lld Mismatch Detected(%d+%d+%d+%d):"
				   " test_msg[%d][%d] - vector #%d - pattern %x !!!\n",
				snapshot, resp_hdr_len, payload_offset, payload_len,
				digest_size, chan, msg_idx, vec_idx, msg->test_info->pattern);
			printk("%px : %pa\n", (void *)test_buff_dst[chan][msg_idx], &phys_addr);

			atomic_set(&abort_test, 1);
			err_cnt = 0;
			if (spu_test_verbose) {
				for (k=0; k < resp_hdr_len + payload_offset; k++)
				{
					if (k % L1_CACHE_BYTES == 0)
						printk(KERN_CONT "\ncl #%2d: ", k / L1_CACHE_BYTES);
					if ((resp_hdr_len + payload_offset + k) % 8 == 0) {
						printk(KERN_CONT "\n");
					}
					printk(KERN_CONT "%2x ", test_buff_dst[chan][msg_idx][k]);
				}
			}

			for (k=0; k < payload_len+digest_size; k++)
			{
				if (spu_test_verbose)
					if ((resp_hdr_len + payload_offset + k) % L1_CACHE_BYTES == 0)
						printk(KERN_CONT "\ncl #%2d: ",
							(resp_hdr_len + payload_offset + k) / L1_CACHE_BYTES);
				if (payload[k] != result[k])
				{
					if (spu_test_verbose) {
						if ((resp_hdr_len + payload_offset + k) % 8 == 0) {
							printk(KERN_CONT "\n");
						}
						printk(KERN_CONT "(%2d)%2x!=%2x ",
							(resp_hdr_len + payload_offset + k) % L1_CACHE_BYTES,
							payload[k], result[k]);
					}
					err_cnt++;
				}
			}
			if (spu_test_verbose) printk(KERN_CONT "\n");
		}

fail:
		in_transit = spu->spu_ops_in_transit(chan);
		if (atomic_read(&abort_test)) {
			printk("!!!! Test ABORTED - Failure detected"
				   " - chan %d has %u ops still in transit\n",
				chan, in_transit);
		}

		if (spu_test_dedicated_pool) {
			if (!spu_test_same_src_buffer)
				dma_pool_free(iproc_priv.test_src_pool,
					test_buff_src[chan][msg_idx],
					test_msg[chan][msg_idx].test_info->src_dma);
			dma_pool_free(iproc_priv.test_dst_pool,
				test_buff_dst[chan][msg_idx],
				test_msg[chan][msg_idx].test_info->dst_dma);
		} else {
			if (!spu_test_same_src_buffer)
				kfree(test_buff_src[chan][msg_idx]);
			kfree(test_buff_dst[chan][msg_idx]);
		}

		kfree(test_msg[chan][msg_idx].src);
		kfree(test_msg[chan][msg_idx].dst);

		if (!atomic_read(&abort_test) &&
			(in_transit <= spu_test_in_transit_limit) &&
			(atomic64_inc_return(&test_requested) - 1) < sample_size) {
			uint32_t next_idx = spu2_prep_request(chan);
			if (next_idx >= 0) {
				if (spu->spu_send_data(chan, &test_msg[chan][next_idx])) {
					atomic_set(&abort_test, 1);
					printk("spu_send_data failed!\n");
				}
			} else {
				atomic_set(&abort_test, 1);
				printk("spu2_prep_request failed - next_idx is < 0!!!\n");
			}
		}
	}


	if (completed == requested)
	{
		end_time[chan] = ktime_get_ns();

		if (sample_size <= SPU2_TEST_BATCHSIZE)
		{
			for (i=0; i < requested; i++)
			{
				vec_idx = test_msg[chan][i].test_info->vec_id;
				enckey_len = spu2_test_vectors[vec_idx].enc_key_len;
				hashkey_len = spu2_test_vectors[vec_idx].hash_key_len;
				digest_size = spu2_test_vectors[vec_idx].digest_size;
				result = spu2_test_vectors[vec_idx].result;

				resp_hdr_len = spu->spu_response_hdr_len(hashkey_len, enckey_len, false);

				payload_len = spu->spu_payload_length(test_buff_dst[chan][i]);

				{
					struct SPU2_FMD *fmd = (struct SPU2_FMD*)test_buff_dst[chan][i];
					u64 ctrl2 = le64_to_cpu(fmd->ctrl2);
					payload_offset = (ctrl2 & SPU2_PL_OFFSET) >> SPU2_PL_OFFSET_SHIFT;
				}

				digest = &test_buff_dst[chan][i][resp_hdr_len + payload_offset + payload_len];
				err = spu->spu_status_process(&digest[digest_size]);
				if (err)
					printk("result %d payload_len = %d offset %d err %d\n", i,
					payload_len, payload_offset, err);

				payload = &test_buff_dst[chan][i][resp_hdr_len + payload_offset];

				for (k=0; k < payload_len+digest_size; k++)
				{
					if (payload[k] != result[k])
					{
						printk("test_vector %d fail payload idx %d\n", i, k);
						break;
					}
				}

				atomic64_add(payload_len + digest_size, &total_bytes);

				if (spu_test_dedicated_pool) {
					if (!spu_test_same_src_buffer)
						dma_pool_free(iproc_priv.test_src_pool,
							test_buff_src[chan][i],
							test_msg[chan][i].test_info->src_dma);
					dma_pool_free(iproc_priv.test_dst_pool,
						test_buff_dst[chan][i],
						test_msg[chan][i].test_info->dst_dma);
				} else {
					if (!spu_test_same_src_buffer)
						kfree(test_buff_src[chan][i]);
					kfree(test_buff_dst[chan][i]);
				}
				kfree(test_msg[chan][i].src);
				kfree(test_msg[chan][i].dst);
			}
			if (atomic64_add_return(atomic64_read(&num_response[chan]), &test_completed) == sample_size) {
				do_gettimeofday(&end_t);
				ssleep(1);
				printk("\n");
				for (i=0; i < spu->spu_get_max_channel(); i++)
				{
					printk("%10d packets processed from channel %d in %llu (%llu - %llu) ns\n",
						atomic_read(&num_response[i]), i,
						end_time[i] - start_time[i],
						end_time[i], start_time[i]);
					if ((start_time[i] != 0) &&
						(first_packet_timestamp > start_time[i]))
						first_packet_timestamp = start_time[i];
					if ((end_time[i] != 0) &&
						(last_packet_timestamp < end_time[i]))
						last_packet_timestamp = end_time[i];
				}
				mbps = (u64) atomic64_read(&total_bytes) * 1000 * 8;
				mbps = mbps / (last_packet_timestamp - first_packet_timestamp);
				printk("\n Throughput = (%lld Bytes x 8 bits/Bytes) / %llu ns = %d.%d Gbps\n\n",
					(u64)atomic64_read(&total_bytes),
					last_packet_timestamp - first_packet_timestamp,
					(u32) mbps/1000, (u32) mbps%1000);
				time_to_tm(end_t.tv_sec, 0, &broken);
				printk("Test ended at %d:%d:%d:%ld\n",
						broken.tm_hour, broken.tm_min,
				        broken.tm_sec, end_t.tv_usec);
			}
		} else {
			if (atomic64_read(&test_completed) == sample_size) {
				if (atomic_inc_return(&print_summary) == 1) {
					do_gettimeofday(&end_t);
					ssleep(1);
					printk("\n");
					for (i=0; i < spu->spu_get_max_channel(); i++)
					{
						printk("(%d) %10d packets processed from channel %d in %llu (%llu - %llu) ns\n",
								chan, atomic_read(&num_response[i]), i,
								end_time[i] - start_time[i],
								end_time[i], start_time[i]);
						if ((start_time[i] != 0) &&
							(first_packet_timestamp > start_time[i]))
							first_packet_timestamp = start_time[i];
						if ((end_time[i] != 0) &&
							(last_packet_timestamp < end_time[i]))
							last_packet_timestamp = end_time[i];
					}
					mbps = (u64) atomic64_read(&total_bytes) * 1000 * 8;
					mbps = mbps / (last_packet_timestamp - first_packet_timestamp);
					printk("\n Throughput = (%lld Bytes x 8 bits/Bytes) / %llu ns = %d.%d Gbps\n\n",
						(u64)atomic64_read(&total_bytes),
						last_packet_timestamp - first_packet_timestamp,
						(u32) mbps/1000, (u32) mbps%1000);
					time_to_tm(end_t.tv_sec, 0, &broken);
					printk("\nTest ended at %d:%d:%d:%ld\n",
						broken.tm_hour, broken.tm_min,
						broken.tm_sec, end_t.tv_usec);
				}
			}
		}
	}
}


static int spu2_prep_request(uint8_t chan)
{
	struct spu_hw *spu = &iproc_priv.spu;
	struct device *dev = &iproc_priv.pdev->dev;
	uint8_t test_buf[200];
	struct spu_request_opts req_opts;
	struct spu_cipher_parms cipher_parms;
	struct spu_hash_parms hash_parms;
	struct spu_aead_parms aead_parms;
	char *assoc, *src_data;
	unsigned int chunksize = 0, i, test_src_size;
	uint32_t spu_hdr_len = 0;
	uint32_t db_size = 0;
	int tx_frag_num, rx_frag_num;
	struct scatterlist *sg; /* used to build sgs in spu message */
	struct bcmspu_message *mssg;  /* message */
	uint32_t idx = (atomic_inc_return(&num_request[chan]) - 1) % SPU2_TEST_BATCHSIZE;

	memset(test_buf, 0, sizeof(test_buf));
	memset(&req_opts, 0, sizeof(req_opts));
	memset(&hash_parms, 0, sizeof(hash_parms));
	memset(&aead_parms, 0, sizeof(aead_parms));

	if (vec_id_sel < 0) {
		get_random_bytes(&vec_id_sel, 1);
		vec_id_sel = vec_id_sel % (sizeof(spu2_test_vectors) / sizeof(struct spu_test_vector_t));
	}

	req_opts.auth_first = 0;
	req_opts.is_aead = true;
	req_opts.is_esp = 0;
	req_opts.is_inbound = spu2_test_vectors[vec_id_sel].inbound;

	cipher_parms.alg = spu2_test_vectors[vec_id_sel].calg;
	cipher_parms.mode = spu2_test_vectors[vec_id_sel].cmode;
	cipher_parms.type = spu2_test_vectors[vec_id_sel].ctype;

	cipher_parms.key_buf = spu2_test_vectors[vec_id_sel].enc_key;
	cipher_parms.key_len = spu2_test_vectors[vec_id_sel].enc_key_len;
	cipher_parms.iv_buf = spu2_test_vectors[vec_id_sel].iv;
	cipher_parms.iv_len = spu2_test_vectors[vec_id_sel].iv_len;

	hash_parms.alg = spu2_test_vectors[vec_id_sel].halg;
	hash_parms.mode = spu2_test_vectors[vec_id_sel].hmode;
	hash_parms.type = spu2_test_vectors[vec_id_sel].htype;

	hash_parms.key_buf = spu2_test_vectors[vec_id_sel].hash_key;
	hash_parms.key_len = spu2_test_vectors[vec_id_sel].hash_key_len;
	hash_parms.digestsize = spu2_test_vectors[vec_id_sel].digest_size;

	aead_parms.iv_len = spu2_test_vectors[vec_id_sel].iv_len;
	aead_parms.assoc_size = 8;
	aead_parms.aad_pad_len = 0;
	aead_parms.data_pad_len = 0;

	assoc = spu2_test_vectors[vec_id_sel].assoc;

	src_data = spu2_test_vectors[vec_id_sel].src;
	chunksize = spu2_test_vectors[vec_id_sel].src_size;

	if (HASH_ALG_NONE != hash_parms.alg) {
		spu_hdr_len = spu->spu_create_request(test_buf +
							BCM_HDR_LEN, &req_opts,
							&cipher_parms, &hash_parms,
							&aead_parms, chunksize);
		/* Determine total length of padding. Put all padding in one buffer. */
		db_size = spu_real_db_size(aead_parms.assoc_size, aead_parms.iv_len, 0,
						chunksize, aead_parms.aad_pad_len,
						aead_parms.data_pad_len, 0);
	} else {
		spu_hdr_len = spu->spu_cipher_req_init (test_buf + BCM_HDR_LEN,
							&cipher_parms);
		spu->spu_cipher_req_finish (test_buf + BCM_HDR_LEN,
						spu_hdr_len, false, &cipher_parms, chunksize);
	}

	/* build message */
	mssg = &test_msg[chan][idx];    /* message */
	memset (mssg, 0, sizeof(*mssg));
	mssg->rx_callback = spu2_test_callback;
	mssg->test_info = &test_info[chan][idx];
	mssg->test_info->vec_id = vec_id_sel;
	mssg->test_info->chan = chan;

	get_random_bytes(&mssg->test_info->pattern, 1);
	if (mssg->test_info->pattern == 0)
		mssg->test_info->pattern = 0x01;

	rx_frag_num = 1;

	mssg->dst = kcalloc(rx_frag_num, sizeof(struct scatterlist),
				GFP_ATOMIC);
	if (!mssg->dst) {
		printk("NO MEMORY!");
		return -ENOMEM;
	}

	sg = mssg->dst;
	sg_init_table(sg, rx_frag_num);
	if (spu_test_dedicated_pool){
		test_buff_dst[chan][idx] =
			dma_pool_alloc(iproc_priv.test_dst_pool, GFP_ATOMIC,
						   &mssg->test_info->dst_dma);
	} else {
		test_buff_dst[chan][idx] = (uint8_t *)kzalloc (2000, GFP_ATOMIC);
	}
	if (!test_buff_dst[chan][idx]) {
		printk("NO MEMORY!");
		return -ENOMEM;
	}

	if (spu_test_preinit) {
		memset (test_buff_dst[chan][idx], mssg->test_info->pattern, 2000);
	}

	sg_set_buf(sg, test_buff_dst[chan][idx], 2000);

	tx_frag_num = 1 + spu_test_src_frag;

	mssg->src = kcalloc(tx_frag_num, sizeof(struct scatterlist),
				GFP_ATOMIC);
	if (!mssg->src){
		printk("NO MEMORY!");
		return -ENOMEM;
	}

	sg = mssg->src;
	sg_init_table(sg, tx_frag_num);

	if (spu_test_same_src_buffer) {
		if (!same_src_buffer) {
			if (spu_test_dedicated_pool)
				same_src_buffer = dma_pool_alloc(iproc_priv.test_src_pool,
												 GFP_ATOMIC, &same_src_buffer_dma);
			else
				same_src_buffer = (uint8_t *)kzalloc (2000, GFP_ATOMIC);;
			if (!same_src_buffer) {
				printk("NO MEMORY!");
				return -ENOMEM;
			}
			memcpy(same_src_buffer, test_buf, spu_hdr_len + BCM_HDR_LEN);
			if (HASH_ALG_NONE != hash_parms.alg) {
				memcpy(&same_src_buffer[spu_hdr_len + BCM_HDR_LEN],
					   assoc, aead_parms.assoc_size);
				memcpy(&same_src_buffer[spu_hdr_len + BCM_HDR_LEN + aead_parms.assoc_size],
					   src_data, chunksize+aead_parms.iv_len);
			} else {
				memcpy(&same_src_buffer[spu_hdr_len + BCM_HDR_LEN],
					   src_data, chunksize);
			}
		}
		test_buff_src[chan][idx] = same_src_buffer;
	} else {
		if (spu_test_dedicated_pool) {
			test_buff_src[chan][idx] =
				dma_pool_alloc(iproc_priv.test_src_pool, GFP_ATOMIC,
							   &mssg->test_info->src_dma);
		} else {
			test_buff_src[chan][idx] = (uint8_t *)kzalloc (2000, GFP_ATOMIC);
		}
		if (!test_buff_src[chan][idx]) {
			printk("NO MEMORY!");
			return -ENOMEM;
		}
		memcpy(test_buff_src[chan][idx], test_buf, spu_hdr_len + BCM_HDR_LEN );
		if (HASH_ALG_NONE != hash_parms.alg) {
			memcpy(&test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN],
				   assoc, aead_parms.assoc_size);
			memcpy(&test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN + aead_parms.assoc_size],
				   src_data, chunksize+aead_parms.iv_len);
		} else {
			memcpy(&test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN],
				   src_data, chunksize);
		}
	}

	spu->spu_dump_msg_hdr (test_buf + BCM_HDR_LEN, spu_hdr_len);

	sg_set_buf(sg++, test_buff_src[chan][idx], BCM_HDR_LEN + spu_hdr_len);
	if (HASH_ALG_NONE != hash_parms.alg) {
		if (spu_test_src_frag == 1) {
			sg_set_buf(sg, &test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN],
					   aead_parms.assoc_size + chunksize + aead_parms.iv_len);
		} else {
			test_src_size = aead_parms.assoc_size + chunksize + aead_parms.iv_len;
			for (i = 0; i < spu_test_src_frag-1; i++) {
				sg_set_buf(sg++, &test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN + (i * L1_CACHE_BYTES)],
					       L1_CACHE_BYTES);
				test_src_size -= L1_CACHE_BYTES;
			}
			sg_set_buf(sg, &test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN + (i * L1_CACHE_BYTES)],
				       test_src_size);
		}
	} else {
		if (spu_test_src_frag == 1) {
			sg_set_buf(sg, &test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN], chunksize);
		} else {
			test_src_size = chunksize;
			for (i = 0; i < spu_test_src_frag-1; i++) {
				sg_set_buf(sg++, &test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN + (i * L1_CACHE_BYTES)],
					       L1_CACHE_BYTES);
				test_src_size -= L1_CACHE_BYTES;
			}
			sg_set_buf(sg, &test_buff_src[chan][idx][spu_hdr_len + BCM_HDR_LEN + (i * L1_CACHE_BYTES)],
				       test_src_size);
		}
	}

	dma_map_sg(dev, mssg->src, sg_nents(mssg->src), DMA_TO_DEVICE);
	dma_map_sg(dev, mssg->dst, sg_nents(mssg->dst), DMA_FROM_DEVICE);
	return idx;
}

int spu2_test_get_vectors(struct spu_test_vector_t **test_vectors_ptr)
{
	*test_vectors_ptr = spu2_test_vectors;
	return SPU2_TEST_VECTORS_MAX;
}

void spu2_test_raw_perf(long long test_size)
{
	struct spu_hw *spu = &iproc_priv.spu;
	uint8_t chan;
	long long i;

	if (spu_test_vector_id < 0 ||
		spu_test_vector_id >= sizeof(spu2_test_vectors) / sizeof(struct spu_test_vector_t)) {
		if (spu_test_same_src_buffer) {
			get_random_bytes(&vec_id_sel, 1);
			vec_id_sel = vec_id_sel % (sizeof(spu2_test_vectors) / sizeof(struct spu_test_vector_t));
			printk("Since test will be performed using the same source buffer,\n"
				   "Test vector #%d (%s) will be used instead of a randomly chosen one...\n",
					vec_id_sel, spu2_test_vectors[vec_id_sel].name);
		} else {
			vec_id_sel = -1;
			printk("Random set of test vectors will be used...\n");
		}
	} else {
		vec_id_sel = spu_test_vector_id;
		printk("Test vector #%d (%s) will be used...\n",
				vec_id_sel, spu2_test_vectors[vec_id_sel].name);
	}

	if (spu_test_dedicated_pool) {
		if (iproc_priv.test_src_pool == NULL) {
			printk("Created src buffer pool for testing");
			iproc_priv.test_src_pool =
				dma_pool_create("spu2_test_src_pool", &iproc_priv.pdev->dev, 2048, 64, 0);
		}
		if (iproc_priv.test_dst_pool == NULL) {
			printk("Created dst buffer pool for testing");
			iproc_priv.test_dst_pool =
				dma_pool_create("spu2_test_dst_pool", &iproc_priv.pdev->dev, 2048, 64, 0);
		}
		printk("Test buffers will be created from memory pools dedicated for this test\n");
	} else {
		printk("Test buffers will be created from kernel shared memory pool\n");
	}

	atomic_set(&abort_test, 0);
	atomic64_set(&total_bytes, 0);
	first_packet_timestamp = U64_MAX;
	last_packet_timestamp = 0;
	atomic64_set(&test_completed, 0);
	atomic64_set(&test_requested, 0);
	atomic_set(&print_summary, 0);

	if (same_src_buffer) {
		if (spu_test_same_src_buffer) {
			if (spu_test_dedicated_pool)
				dma_pool_free(iproc_priv.test_src_pool,
							  same_src_buffer, same_src_buffer_dma);
			else
				kfree(same_src_buffer);
			same_src_buffer = NULL;
		}
	}

	for (i=0; i < spu->spu_get_max_channel(); i++)
	{
		atomic_set(&num_request[i], 0);
		atomic_set(&num_response[i], 0);
		start_time[i] = 0;
		end_time[i] = 0;
	}

	for (i=0; (i < test_size) && (i < SPU2_TEST_BATCHSIZE); i++)
	{
		chan = spu2_select_next_test_chan();
		atomic64_inc(&test_requested);
		if (spu2_prep_request(chan) < 0) {
			printk("spu2_prep_request failed - next_idx is < 0!!!\n");
			return;
		}
	}

	sample_size = test_size;

	for (i=0; i < spu->spu_get_max_channel(); i++)
	{
		uint32_t requested = atomic_read(&num_request[i]);
		if (requested) {
			test_msg[i][0].type = BRCM_MESSAGE_BATCH_PREP_ONLY;
			test_msg[i][0].batch_count = requested;
			if (spu->spu_send_data(i, test_msg[i])) {
				printk("spu_send_data failed!\n");
				return;
			}
			start_time[i] = ktime_get_ns();
		}
	}

	do_gettimeofday(&start_t);
	time_to_tm(start_t.tv_sec, 0, &broken);
	printk("Test started at %d:%d:%d:%ld\n", broken.tm_hour, broken.tm_min,
		   broken.tm_sec, start_t.tv_usec);

	for (i=0; i < spu->spu_get_max_channel(); i++)
	{
		if (test_msg[i][0].batch_count) {
			test_msg[i][0].type = BRCM_MESSAGE_BATCH_TOGGLE_ONLY;
			start_time[i] = ktime_get_ns();
			spu->spu_send_data(i, test_msg[i]);
		}
	}
	return;
}

#endif
