<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<link rel="stylesheet" type="text/css" href="/light_effect/light_effect.css" />
<head>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/calendar/jquery-ui.js"></script>
<script type="text/javascript" src="/js/httpApi.js"></script>
</head>
<script >
$(function(){
	var getUrlParameter = function getUrlParameter(param){
		var url_parm = window.location.search.substring(1);
		var parm_array = url_parm.split("&");
		var key_value;

		for(var i = 0; i < parm_array.length; i += 1){
			key_value = parm_array[i].split("=");
			if (key_value[0] == param) {
				return typeof key_value[1] == "undefined" ? "" : decodeURIComponent(key_value[1]);
			}
		}
		return "";
	};

	var theme = getUrlParameter("current_theme").toLocaleLowerCase();
	if(theme != ""){
		$('link[href*="/light_effect/light_effect_' + theme + '.css"]').remove();
		$('link').last().after('<link rel="stylesheet" type="text/css" href="/light_effect/light_effect_' + theme + '.css">');
	}
});
var $light_effect_bg = $("#light_effect_bg");
var $hue_bar = $("#hue_bar");
var $hue_slider = $("#hue_slider");
var hue_click = false;
var hsl = {h:0, s:100, l:50};
var scheme_page_idx = 1;
var scheme_page_max_count = 4;
var scheme_pages = 1;
var scheme_item_post = {
	"LED_Set" : {},
	"Mode" : 6
}
var ledg_group = ((isSupport("ledg_count") == 0) ? 4 : isSupport("ledg_count"));
for(var i = 1; i <= ledg_group; i += 1){
	var led_group = {};
	led_group[i] = {"R" : 0, "G" : 0, "B" : 128};
	$.extend(true, scheme_item_post.LED_Set, led_group);
}

var gradient_color = {
	"id1": {"color" :[128,0,0,128,15,0,128,30,0,128,45,0],"left":0},
	"id2": {"color" :[128,35,0,128,50,0,128,63,0,128,75,0],"left":26},
	"id3": {"color" :[128,100,0,128,110,0,128,120,0,100,125,0],"left":51},
	"id4": {"color" :[0,128,30,0,128,60,0,128,100,0,60,128],"left":76},
	"id5": {"color" :[0,60,128,0,128,100,0,128,60,0,128,30],"left":106},
	"id6": {"color" :[0,100,128,0,80,128,0,30,128,0,0,128],"left":141},
	"id7": {"color" :[0,100,128,0,50,128,0,0,128,30,0,128],"left":171},
	"id8": {"color" :[0,0,128,20,0,128,40,0,128,60,0,128],"left":191},
	"id9": {"color" :[55,0,128,70,0,128,80,0,128,100,0,128],"left":211},
	"id10":{"color" :[128,0,128,128,0,100,128,0,60,128,0,30],"left":231},
	"id11":{"color" :[128,0,50,128,0,40,128,0,20,128,0,10],"left":251}
};
if(ledg_group > 4){
	$.each(gradient_color, function(key, value) {
		var gradient_group_color = gradient_color[key]["color"];
		var copy_group = gradient_group_color.slice(gradient_group_color.length-3);
		$.merge(gradient_group_color, copy_group);
	});
}

function initial_led_control() {
	var set_scheme_item_post = function(_ledg_rgb) {
		var ledg_rgb_array = _ledg_rgb.split(",");
		if(ledg_rgb_array.length == (ledg_group * 3)) {
			for(var i = 0; i < ledg_rgb_array.length; i += 3) {
				var group_idx = (Math.floor(i / 3)) + 1;
				scheme_item_post["LED_Set"][group_idx]["R"] = multiply_rgb(parseInt(ledg_rgb_array[i]));
				scheme_item_post["LED_Set"][group_idx]["G"] = multiply_rgb(parseInt(ledg_rgb_array[i+1]));
				scheme_item_post["LED_Set"][group_idx]["B"] = multiply_rgb(parseInt(ledg_rgb_array[i+2]));
			}
		}
	};

	var productid = httpApi.nvramGet(["productid"], true).productid;
	if(productid == "TUF-AX5400")
		$(".scheme_bg:not(#static, #breathing, #wave, #rainbow)").remove();

	$light_effect_bg = $("#light_effect_bg");
	$hue_bar = $("#hue_bar");
	$hue_slider = $("#hue_slider");
	if($(".light_effect_setting_bg .setting_enable_bg .schedule").css("display") != "none")
		$(".light_effect_setting_bg .setting_enable_bg .switch").css("right", "20%");

	if(!isMobile()) {
		$hue_bar.mousedown(function(e) {
			if($(".setting_hue").css("opacity") == "1") {
				if(e.target.id == "hue_bar") {
					hue_click = true;
					set_hue_value(e);
				}
				else {
					hue_click = true;
					$hue_slider.addClass("active");
				}
				lightl_effect_animate.clear($light_effect_bg);
			}
		});
		$(document).mousemove(function(e) {
			if(hue_click) {
				set_hue_value(e);
			}
		});
		$(document).mouseup(function(e) {
			if(hue_click) {
				set_light_effect();
			}
		});
	}
	else {
		$(".setting_scheme").removeClass("support_hover");
		$(".light_effect_setting_bg").addClass("no_highlights");
		$hue_bar[0].addEventListener("touchstart", function (e) {
			if($(".setting_hue").css("opacity") == "1") {
				if(e.target.id == "hue_bar") {
					hue_click = true;
					set_hue_value(e);
				}
				else {
					hue_click = true;
					$hue_slider.addClass("active");
				}
				lightl_effect_animate.clear($light_effect_bg);
			}
		});
		document.addEventListener("touchmove", function (e) {
			if(hue_click) {
				set_hue_value(e);
			}
		});
		document.addEventListener("touchend", function (e) {
			if(hue_click) {
				set_light_effect();
			}
		});
	}

	$(".setting_enable_bg .switch").unbind("click");
	$(".setting_enable_bg .switch").click(function(e){
		e = e || event;
		e.stopPropagation();
		var AllLED = httpApi.nvramGet(["AllLED"]).AllLED;
		if(AllLED == "1"){
			$(".setting_enable_bg .switch").toggleClass("off on").promise().done(function(){
				var switch_status = $(".setting_enable_bg .switch").hasClass("on");
				lightl_effect_animate.clear($light_effect_bg);
				if(switch_status){
					$(".switch_off").show();
					scheme_item_post.Mode = $(".scheme_bg.active").attr("Mode");
					set_scheme_mode(scheme_item_post.Mode, scheme_item_post["LED_Set"]);
				}
				else{
					$(".switch_off").hide();
					scheme_item_post.Mode = "0";
					$light_effect_bg.removeClass().addClass("light_effect_bg");
					$light_effect_bg.css("background", "initial");
				}

				var postData = {"ledg_scheme": scheme_item_post.Mode};
				httpApi.set_ledg(postData);
			});
		}
	});
	$(".setting_scheme .scheme_bg").unbind("click");
	$(".setting_scheme .scheme_bg").click(function(e){
		e = e || event;
		e.stopPropagation();
		var id = e.currentTarget.id;
		if(id == "")
			return;
		lightl_effect_animate.clear($light_effect_bg);
		$light_effect_bg.removeClass().addClass("light_effect_bg");
		var mode = e.currentTarget.getAttribute("mode");
		$(".setting_scheme .scheme_bg").removeClass("active");
		$(".setting_scheme #" + id + "").addClass("active");
		var ledg_rgb = httpApi.nvramGet(["ledg_rgb" + mode + ""], true)["ledg_rgb" + mode + ""];
		if(mode == "6"){
			if(productid == "TUF-AX5400"){
				ledg_rgb = "128,70,0,128,70,0,128,70,0,128,70,0";
				if(ledg_group == 5)
					ledg_rgb = "128,70,0,128,70,0,128,70,0,128,70,0,128,70,0";
			}
			else{
				var CoBrand = httpApi.nvramGet(["CoBrand"]).CoBrand;
				if(CoBrand == "2"){
					ledg_rgb = "128,50,35,128,50,35,128,50,35,128,50,35";
					if(ledg_group == 5)
						ledg_rgb = "128,50,35,128,50,35,128,50,35,128,50,35,128,50,35";
				}
				else{
					ledg_rgb = "0,0,128,0,0,128,0,0,128,0,0,128";
					if(ledg_group == 5)
						ledg_rgb = "0,0,128,0,0,128,0,0,128,0,0,128,0,0,128";
				}
			}
		}

		set_scheme_item_post(ledg_rgb);
		set_scheme_mode(mode, scheme_item_post["LED_Set"]);
		var postData = {"ledg_scheme": scheme_item_post.Mode};
		if(scheme_item_post.Mode == "1" || scheme_item_post.Mode == "2" || scheme_item_post.Mode == "3" || scheme_item_post.Mode == "7") {
			var ledg_rgb_post = [];
			Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
				ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["R"] / 2));
				ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["G"] / 2));
				ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["B"] / 2));
			});
			postData["ledg_rgb"] = ledg_rgb_post.join(',');
		}
		httpApi.set_ledg(postData);
	});
	$(".scheme_list_bg .boundary").unbind("click");
	$(".scheme_list_bg .boundary").click(function(e){
		e = e || event;
		e.stopPropagation();
		var id = e.currentTarget.id.replace("boundary_", "");
		if(id == "left")
			scheme_page_idx = Math.max(1, (scheme_page_idx - 1));
		else if(id == "right")
			scheme_page_idx = Math.min(scheme_pages, (scheme_page_idx + 1));
		control_scheme_list(scheme_page_idx);
	});

	var ledg_scheme = httpApi.nvramGet(["ledg_scheme"], true).ledg_scheme;
	var AllLED = httpApi.nvramGet(["AllLED"], true).AllLED;
	if(AllLED == "0")
		$(".all_led_off").show();

	var ledg_scheme_old = httpApi.nvramGet(["ledg_scheme_old"], true).ledg_scheme_old;
	var ledg_rgb = httpApi.nvramGet(["ledg_rgb" + ledg_scheme + ""], true)["ledg_rgb" + ledg_scheme + ""];
	if(ledg_scheme == "1" ||ledg_scheme == "2" || ledg_scheme == "3" || ledg_scheme == "7" || (ledg_scheme == "0" && ledg_scheme_old != "")) {
		var ledg_rgb_idx = ledg_scheme;
		if(ledg_rgb_idx == "0")
			ledg_rgb_idx = ledg_scheme_old;
		var ledg_rgb = httpApi.nvramGet(["ledg_rgb" + ledg_rgb_idx + ""], true)["ledg_rgb" + ledg_rgb_idx + ""];
		set_scheme_item_post(ledg_rgb);
		scheme_item_post.Mode = ledg_rgb_idx;
	}
	else {
		scheme_item_post.Mode = ledg_scheme;
	}

	$(".scheme_list_bg .setting_scheme .scheme_bg[mode=" + scheme_item_post.Mode + "]").addClass("active");
	if(ledg_scheme == "0") {
		$(".setting_enable_bg .switch").addClass("off");
		lightl_effect_animate.clear($light_effect_bg);
		$(".switch_off").hide();
		$light_effect_bg.removeClass().addClass("light_effect_bg");
		$light_effect_bg.css("background", "initial");
	}
	else {
		$(".setting_enable_bg .switch").addClass("on");
		var count = 0;
		var interval_check = setInterval(function() {
			if(get_offset($hue_bar).width != 0) {
				set_scheme_mode(scheme_item_post.Mode, scheme_item_post["LED_Set"]);
				clearInterval(interval_check);
			}
			else {
				count++;
				if(count == 500)
					clearInterval(interval_check);
			}
		}, 50);
	}

	$(".scheme_list_bg .setting_scheme .scheme_bg").each(function(idx) {
		if($(this).hasClass("active"))
			scheme_page_idx = Math.ceil((idx + 1) / scheme_page_max_count);
	});
	scheme_pages = Math.ceil(($(".scheme_list_bg .setting_scheme .scheme_bg").length / scheme_page_max_count));
	control_scheme_list(scheme_page_idx);
}
function set_scheme_mode(_type, _LED_Set_Obj){
	Object.keys(_LED_Set_Obj).forEach(function(group_idx) {
		scheme_item_post["LED_Set"][group_idx]["R"] = _LED_Set_Obj[group_idx]["R"];
		scheme_item_post["LED_Set"][group_idx]["G"] = _LED_Set_Obj[group_idx]["G"];
		scheme_item_post["LED_Set"][group_idx]["B"] = _LED_Set_Obj[group_idx]["B"];
	});

	var group_rgb = scheme_item_post["LED_Set"];
	var hue_slider_rgb = [group_rgb[4]["R"],group_rgb[4]["G"],group_rgb[4]["B"]];
	switch(_type) {
		case "2" :
			rgbToLeft(hue_slider_rgb);
			$light_effect_bg.css("background", "rgb("+ group_rgb[4]["R"] + ", " + group_rgb[4]["G"] + ", " + group_rgb[4]["B"] + ")");
			$(".setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "2";//static
			break;
		case "3" :
			rgbToLeft(hue_slider_rgb);
			$light_effect_bg.css("background", "rgb("+ group_rgb[4]["R"] + ", " + group_rgb[4]["G"] + ", " + group_rgb[4]["B"] + ")");
			lightl_effect_animate.breathing($light_effect_bg, hue_slider_rgb);
			$(".setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "3";//breathing
			break;
		case "6" :
			$light_effect_bg.css("background", "rgb("+ group_rgb[4]["R"] + ", " + group_rgb[4]["G"] + ", " + group_rgb[4]["B"] + ")");
			lightl_effect_animate.wave($light_effect_bg, hue_slider_rgb);
			$(".setting_hue").fadeTo(0, 0);
			scheme_item_post.Mode = "6";//wave
			break;
		case "7" :
			rgbToLeft(hue_slider_rgb);
			$light_effect_bg.css("background", "rgb("+ group_rgb[4]["R"] + ", " + group_rgb[4]["G"] + ", " + group_rgb[4]["B"] + ")");
			lightl_effect_animate.marquee($light_effect_bg, hue_slider_rgb);
			$(".setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "7";//marquee
			break;
		case "1" :
			var gradient_current_rgb = [];
			var gradient_display_rgb = [];
			Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
				gradient_current_rgb.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["R"] / 2));
				gradient_current_rgb.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["G"] / 2));
				gradient_current_rgb.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["B"] / 2));
				gradient_display_rgb.push(scheme_item_post["LED_Set"][group_idx]["R"] + ", " + scheme_item_post["LED_Set"][group_idx]["G"] + ", " + scheme_item_post["LED_Set"][group_idx]["B"]);
			});
			var left = 0;
			$.each(gradient_color, function(key, value) {
				var gradient_group_color = gradient_color[key]["color"];
				if(JSON.stringify(gradient_group_color) == JSON.stringify(gradient_current_rgb)) {
					left = gradient_color[key]["left"];
					return false;
				}
			});
			$hue_slider.css("left", left);
			hsl.h = Math.round(parseInt($hue_slider.css("left")) / get_offset($hue_bar).width * 360);
			$hue_slider.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
			$light_effect_bg.css("background",
				"linear-gradient(to right, rgb("+gradient_display_rgb[0]+") 50%, rgb("+gradient_display_rgb[1]+") 60%, rgb("+gradient_display_rgb[2]+") 70%, rgb("+gradient_display_rgb[3]+") 80%)");
			$(".setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "1";//gradient
			break;
		case "4" :
			$light_effect_bg.addClass("evolution");
			var CoBrand = httpApi.nvramGet(["CoBrand"]).CoBrand;
			if(CoBrand == "2")
				$light_effect_bg.addClass("CoBrand_2");
			$(".setting_hue").fadeTo(0, 0);
			scheme_item_post.Mode = "4";//evolution
			break;
		case "5" :
			$light_effect_bg.addClass("rainbow");
			$(".setting_hue").fadeTo(0, 0);
			scheme_item_post.Mode = "5";//rainbow
			break;
	}
}
function isMobile() {
	if( navigator.userAgent.match(/iPhone/i) ||
		navigator.userAgent.match(/iPod/i)    ||
		navigator.userAgent.match(/iPad/i)    ||
		(navigator.userAgent.match(/Android/i) && (navigator.userAgent.match(/Mobile/i) || navigator.userAgent.match(/Tablet/i))) ||
		(navigator.userAgent.match(/Opera/i) && (navigator.userAgent.match(/Mobi/i) || navigator.userAgent.match(/Mini/i))) ||
		navigator.userAgent.match(/IEMobile/i)  ||
		navigator.userAgent.match(/BlackBerry/i) ||
		navigator.userAgent.match(/asusrouter/i)
	)
		return true;
	else
		return false;
}
var color_converter = {
	"RGBtoHSL" : function(rgbArr) {
		var R = rgbArr[0] / 255;
		var G = rgbArr[1] / 255;
		var B = rgbArr[2] / 255;
		var maxColor = Math.max(R,G,B);
		var minColor = Math.min(R,G,B);
		var L = (maxColor + minColor) / 2;
		var S = 0;
		var H = 0;
		var HSL = [];
		if(maxColor != minColor) {
			if(L < 0.5)
				S = (maxColor - minColor) / (maxColor + minColor);
			else
				S = (maxColor - minColor) / (2.0 - maxColor - minColor);

			if(R == maxColor)
				H = (G - B) / (maxColor - minColor);
			else if(G == maxColor)
				H = 2.0 + (B - R) / (maxColor - minColor);
			else
				H = 4.0 + (R - G) / (maxColor - minColor);
		}

		L = Math.round(L * 100);
		S = Math.round(S * 100);
		H = Math.round(H * 60);
		if(H < 0)
			H += 360;

		HSL = [H, S, L];
		return HSL;
	},
	"RGBtoHEX" : function(rgbArr) {
		var R = rgbArr[0].toString(16);
		var G = rgbArr[1].toString(16);
		var B = rgbArr[2].toString(16);
		R.length == 1 ? R = "0" + R : R;
		G.length == 1 ? G = "0" + G : G;
		B.length == 1 ? B = "0" + B : B;
		return "#" + R + G + B;
	},
	"HSLtoRGB" : function(hslArr) {
		var H = hslArr[0] / 360;
		var S = hslArr[1] / 100;
		var L = hslArr[2] / 100;
		var RGB = [];
		if(S == 0)
			RGB = [Math.round(L*255),Math.round(L*255),Math.round(L*255)];
		else{
			var q = L >= 0.5 ? (L + S - L * S) : (L * (1 + S));
			var p = 2 * L - q;
			var tr = RGB[0] = H + 1 / 3;
			var tg = RGB[1] = H;
			var tb = RGB[2] = H - 1 / 3;
			for(var i = 0; i < RGB.length; i++) {
				var tc = RGB[i];
				if(tc < 0)
					tc = tc + 1;
				else if(tc > 1)
					tc = tc - 1;
				switch(true) {
					case (tc < (1 / 6)):
						tc = p + (q - p) * 6 * tc;
						break;
					case ((1 / 6) <= tc && tc < 0.5):
						tc = q;
						break;
					case (0.5 <= tc && tc < (2 / 3)):
						tc = p + (q - p) * (4 - 6 * tc);
						break;
					default:
						tc = p;
						break;
				}
				RGB[i] = Math.round(tc * 255);
			}
		}
		return RGB;
	},
};
function get_offset(element) {
	var y = parseInt(element[0].getBoundingClientRect().top);
	var x = parseInt(element[0].getBoundingClientRect().left);
	var height = parseInt(element[0].offsetHeight);
	var width = parseInt(element[0].offsetWidth);
	return {"x": x, "y": y, "height": height, "width": width};
}
function set_hue_value(e) {
	var x = 0;
	var left = 0;
	if(isMobile())
		x = e.touches[0].pageX - get_offset($hue_bar).x;
	else
		x = e.pageX - get_offset($hue_bar).x;
	left = Math.max(Math.min(x, get_offset($hue_bar).width),0);
	$hue_slider.css("left", left);
	$hue_slider.addClass("active");
	hsl.h = Math.round(parseInt($hue_slider.css("left")) / get_offset($hue_bar).width * 360);
	if(hsl.h == 360)
		hsl.h = 359;//avoid slider same as 255,0,0
	$hue_slider.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
	if(scheme_item_post.Mode == "1") {
		var select_id = "id1";
		$.each(gradient_color, function(key, value) {
			var gradient_left = gradient_color[key]["left"];
			if(left > gradient_left)
				select_id = key;
			else if(left < gradient_color["id2"]["left"]) {
				select_id = "id1";
				return false;
			}
			else
				return false;
		});
		var gradient_current_rgb = gradient_color[select_id].color.join().split(",");
		var gradient_display_rgb = [];
		if(gradient_current_rgb.length == (ledg_group * 3)) {
			for(var i = 0; i < gradient_current_rgb.length; i += 3) {
				var group_idx = (Math.floor(i / 3)) + 1;
				scheme_item_post["LED_Set"][group_idx]["R"] = multiply_rgb(parseInt(gradient_current_rgb[i]));
				scheme_item_post["LED_Set"][group_idx]["G"] = multiply_rgb(parseInt(gradient_current_rgb[i+1]));
				scheme_item_post["LED_Set"][group_idx]["B"] = multiply_rgb(parseInt(gradient_current_rgb[i+2]));
				gradient_display_rgb.push(scheme_item_post["LED_Set"][group_idx]["R"] + ", " + scheme_item_post["LED_Set"][group_idx]["G"] + ", " + scheme_item_post["LED_Set"][group_idx]["B"]);
			}
		}
		$light_effect_bg.css("background",
			"linear-gradient(to right, rgb("+gradient_display_rgb[0]+") 50%, rgb("+gradient_display_rgb[1]+") 60%, rgb("+gradient_display_rgb[2]+") 70%, rgb("+gradient_display_rgb[3]+") 80%)");
	}
	else
		$light_effect_bg.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
}
function set_light_effect() {
	var select_rgb = $(".hue_slider").css("background-color").replace('rgb(', '').replace(')','' ).split(',').map(Number);
	$hue_slider.removeClass("active");
	hue_click = false;
	if($(".scheme_bg.active")[0].id == "breathing") {
		rgbToLeft(select_rgb);
		$light_effect_bg.css("background", "rgb("+ select_rgb[0] + ", " + select_rgb[1] + ", " + select_rgb[2] + ")");
		lightl_effect_animate.breathing($light_effect_bg, select_rgb);
	}
	if($(".scheme_bg.active")[0].id == "marquee") {
		rgbToLeft(select_rgb);
		$light_effect_bg.css("background", "rgb("+ select_rgb[0] + ", " + select_rgb[1] + ", " + select_rgb[2] + ")");
		lightl_effect_animate.marquee($light_effect_bg, select_rgb);
	}
	if($(".scheme_bg.active")[0].id == "wave") {
		rgbToLeft(select_rgb);
		$light_effect_bg.css("background", "rgb("+ select_rgb[0] + ", " + select_rgb[1] + ", " + select_rgb[2] + ")");
		lightl_effect_animate.wave($light_effect_bg, select_rgb);
	}

	var postData = {"ledg_scheme": scheme_item_post.Mode};
	if(scheme_item_post.Mode == "1" || scheme_item_post.Mode == "2" || scheme_item_post.Mode == "3" || scheme_item_post.Mode == "7") {
		if(scheme_item_post.Mode != "1") {
			Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
				scheme_item_post["LED_Set"][group_idx]["R"] = select_rgb[0];
				scheme_item_post["LED_Set"][group_idx]["G"] = select_rgb[1];
				scheme_item_post["LED_Set"][group_idx]["B"] = select_rgb[2];
			});
		}
		var ledg_rgb_post = [];
		Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
			ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["R"] / 2));
			ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["G"] / 2));
			ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["B"] / 2));
		});
		postData["ledg_rgb"] = ledg_rgb_post.join(',');
	}
	httpApi.set_ledg(postData);
}
function rgbToLeft(_rgb) {
	var hsl_array = color_converter.RGBtoHSL(_rgb);
	hsl.h = hsl_array[0];
	hsl.s = 100;
	hsl.l = 50;
	var left = Math.round((parseInt(hsl.h) / 360) * get_offset($hue_bar).width);
	$hue_slider.css("left", left);
	$hue_slider.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
	$light_effect_bg.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
}
var lightl_effect_animate = {
	"interval" : false,
	"breathing" : function(_obj, _rgbArr) {
		var breathing_color = function(_obj, _rgbArr) {
			_obj.animate({
				backgroundColor: "rgba("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ", 1)"
			}, 1000);

			_obj.animate({
				backgroundColor: "rgba("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ", 0.2)"
			}, 1000);

		};
		breathing_color(_obj, _rgbArr);
		lightl_effect_animate.interval = setInterval(function(){
			breathing_color(_obj, _rgbArr);
		},2000);
	},
	"marquee" : function(_obj, _rgbArr) {
		var percent_init = 0;
		var percent_end = 100;
		var marquee_color = function(_obj, _rgbArr) {
			var min = middle = max = 0;
			min = Math.max(0, (percent_init - 30));
			middle = percent_init;
			max = Math.min(100, (percent_init + 30));
			_obj.css("background", "linear-gradient(to right, rgb(0, 0, 0) " + min + "%, rgb("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ") " + middle + "%, rgb(0, 0, 0) " + max + "%)");
		};
		marquee_color(_obj, _rgbArr);
		lightl_effect_animate.interval = setInterval(function(){
			percent_init += 10;
			marquee_color(_obj, _rgbArr);
			if(percent_init >= 100)
				percent_init = 0;
		},200);
	},
	"wave" : function(_obj, _rgbArr) {
		var percent_init = 0;
		var percent_end = 100;
		var wave_color = function(_obj, _rgbArr) {
			_obj.css("background", "linear-gradient(to right, rgb(0, 0, 0) 0%, rgb("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ") " + percent_init + "%, rgb(0, 0, 0) 100%)");
		};
		wave_color(_obj, _rgbArr);
		lightl_effect_animate.interval = setInterval(function(){
			percent_init += 10;
			wave_color(_obj, _rgbArr);
			if(percent_init >= 100)
				percent_init = 0;
		},150);
	},
	"clear" : function(_obj) {
		clearInterval(lightl_effect_animate.interval);
		_obj.stop(true,true);
	}
}
function control_scheme_list(_idx) {
	var start_idx = ((_idx -1 ) * scheme_page_max_count);
	$(".setting_scheme .scheme_bg").hide();
	for(var i = ((_idx -1 ) * scheme_page_max_count); i < ((_idx -1 ) * scheme_page_max_count) + scheme_page_max_count ; i += 1) {
		$(".setting_scheme .scheme_bg").eq(i).show();
	}
	$(".scheme_list_bg .boundary").addClass("arrow");
	if(_idx == 1)
		$(".scheme_list_bg #boundary_left").removeClass("arrow");
	if(_idx == scheme_pages)
		$(".scheme_list_bg #boundary_right").removeClass("arrow");
}
function multiply_rgb(_value) {
	return (Math.ceil(_value * 2) > 255) ? 255 : Math.ceil(_value * 2);
}
function isSupport(_ptn){
	var ui_support = [<% get_ui_support(); %>][0];
	return (ui_support[_ptn]) ? ui_support[_ptn] : 0;
}
$(document).ready(initial_led_control);
</script>
<body style="margin:initial;">
<div class="light_effect_bg" id="light_effect_bg">
	<div class="logo_aura_rgb"></div>
	<div class="light_effect_mask"></div>
</div>
<div class="light_effect_setting_bg">
	<div class="setting_enable_bg">
		<div class="text"><span>Aura RGB <#WLANConfig11b_WirelessCtrl_button1name#></span></div>
		<div class="switch"></div>
		<div class="schedule"></div>
	</div>
	<div class="switch_off">
		<div class="horizontal_line "></div>
		<div class="scheme_list_bg">
			<div id="boundary_left" class="boundary arrow"></div>
			<div class="setting_scheme support_hover">
				<div id="static" class="scheme_bg" mode="2">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_static#></div>
				</div>
				<div id="breathing" class="scheme_bg" mode="3">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_breathing#></div>
				</div>
				<div id="wave" class="scheme_bg" mode="6">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_wave#></div>
				</div>
				<div id="marquee" class="scheme_bg" mode="7">
					<div class="icon"></div>
					<div class="text"><#AURA_Scheme_Marquee#></div>
				</div>
				<div id="gradient" class="scheme_bg" mode="1">
					<div class="icon"></div>
					<div class="text"><#AURA_Scheme_Gradient#></div>
				</div>
				<div id="evolution" class="scheme_bg" mode="4">
					<div class="icon"></div>
					<div class="text"><#AURA_Scheme_Evolution#></div>
				</div>
				<div id="rainbow" class="scheme_bg"mode="5">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_rainbow#></div>
				</div>
				<div class="scheme_bg empty"></div>
			</div>
			<div id="boundary_right" class="boundary arrow"></div>
		</div>
		<div class="horizontal_line"></div>
		<div class="setting_hue">
			<div class="hue_bar" id="hue_bar">
				<div class="hue_slider" id="hue_slider"></div>
			</div>
			<div class="hue_bar_mask"></div>
		</div>
	</div>
	<div class="all_led_off">Please enable the LED function by pressing the middle hardware button on the front cover about 3 seconds.</div><!-- untranslated -->
</div>
</body>
